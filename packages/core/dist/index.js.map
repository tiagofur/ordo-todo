{"version":3,"sources":["../src/index.ts","../src/shared/email.vo.ts","../src/shared/hash-password.vo.ts","../src/shared/person-name.vo.ts","../src/shared/id.vo.ts","../src/shared/entity.ts","../src/shared/required-string.vo.ts","../src/shared/constants/colors.constants.ts","../src/shared/constants/priorities.constants.ts","../src/shared/constants/status.constants.ts","../src/shared/constants/timer.constants.ts","../src/shared/constants/limits.constants.ts","../src/shared/utils/date.utils.ts","../src/shared/utils/time.utils.ts","../src/shared/utils/string.utils.ts","../src/shared/utils/calculation.utils.ts","../src/shared/utils/color.utils.ts","../src/shared/validation/task.validation.ts","../src/shared/validation/project.validation.ts","../src/shared/validation/workspace.validation.ts","../src/shared/validation/tag.validation.ts","../src/shared/validation/user.validation.ts","../src/shared/validation/comment.validation.ts","../src/users/model/user.entity.ts","../src/users/usecase/change-user-name.usecase.ts","../src/users/usecase/register-user.usecase.ts","../src/users/usecase/user-by-email.usecase.ts","../src/users/usecase/user-login.usecase.ts","../src/tasks/model/task.entity.ts","../src/tasks/usecase/create-task.usecase.ts","../src/tasks/usecase/complete-task.usecase.ts","../src/tasks/usecase/soft-delete-task.usecase.ts","../src/tasks/usecase/restore-task.usecase.ts","../src/tasks/usecase/permanent-delete-task.usecase.ts","../src/tasks/usecase/get-deleted-tasks.usecase.ts","../src/workspaces/model/workspace.entity.ts","../src/workspaces/model/workspace-member.entity.ts","../src/workspaces/model/workspace-settings.entity.ts","../src/workspaces/model/workspace-audit-log.entity.ts","../src/workspaces/usecase/create-workspace.usecase.ts","../src/workspaces/usecase/add-member-to-workspace.usecase.ts","../src/workspaces/usecase/remove-member-from-workspace.usecase.ts","../src/workspaces/usecase/soft-delete-workspace.usecase.ts","../src/workspaces/usecase/restore-workspace.usecase.ts","../src/workspaces/usecase/permanent-delete-workspace.usecase.ts","../src/workspaces/usecase/get-deleted-workspaces.usecase.ts","../src/workspaces/usecase/archive-workspace.usecase.ts","../src/workspaces/model/workspace-invitation.entity.ts","../src/workspaces/usecase/invite-member.usecase.ts","../src/workspaces/usecase/accept-invitation.usecase.ts","../src/workspaces/usecase/update-workspace-settings.usecase.ts","../src/workspaces/usecase/get-workspace-settings.usecase.ts","../src/workspaces/usecase/create-audit-log.usecase.ts","../src/workspaces/usecase/get-workspace-audit-logs.usecase.ts","../src/projects/model/project.entity.ts","../src/projects/usecase/create-project.usecase.ts","../src/projects/usecase/update-project.usecase.ts","../src/projects/usecase/archive-project.usecase.ts","../src/projects/usecase/delete-project.usecase.ts","../src/projects/usecase/soft-delete-project.usecase.ts","../src/projects/usecase/restore-project.usecase.ts","../src/projects/usecase/permanent-delete-project.usecase.ts","../src/projects/usecase/get-deleted-projects.usecase.ts","../src/workflows/model/workflow.entity.ts","../src/workflows/usecase/create-workflow.usecase.ts","../src/workflows/usecase/list-workflows.usecase.ts","../src/workflows/usecase/update-workflow.usecase.ts","../src/workflows/usecase/delete-workflow.usecase.ts","../src/tags/model/tag.entity.ts","../src/tags/usecase/create-tag.usecase.ts","../src/tags/usecase/assign-tag-to-task.usecase.ts","../src/tags/usecase/remove-tag-from-task.usecase.ts","../src/tags/usecase/update-tag.usecase.ts","../src/timer/model/time-session.entity.ts","../src/timer/usecase/start-timer.usecase.ts","../src/timer/usecase/stop-timer.usecase.ts","../src/timer/usecase/pause-timer.usecase.ts","../src/timer/usecase/resume-timer.usecase.ts","../src/timer/usecase/switch-task.usecase.ts","../src/analytics/model/daily-metrics.entity.ts","../src/analytics/usecase/get-daily-metrics.usecase.ts","../src/analytics/usecase/update-daily-metrics.usecase.ts","../src/analytics/usecase/calculate-focus-score.usecase.ts","../src/ai/model/ai-profile.entity.ts","../src/ai/model/productivity-report.entity.ts","../src/ai/usecase/learn-from-session.usecase.ts","../src/ai/usecase/get-optimal-schedule.usecase.ts","../src/ai/usecase/predict-task-duration.usecase.ts","../src/ai/usecase/generate-weekly-report.usecase.ts","../src/ai/ai-service.ts","../src/habits/model/habit.entity.ts"],"sourcesContent":["export * from \"./shared\";\nexport * from \"./users\";\nexport * from \"./tasks\";\nexport * from \"./workspaces\";\nexport * from \"./projects\";\nexport * from \"./workflows\";\nexport * from \"./tags\";\nexport * from \"./timer\";\nexport * from \"./analytics\";\nexport * from \"./ai\";\nexport * from \"./habits\";\n","import { ValueObject } from \"./value-object\";\n\nexport class Email implements ValueObject<Email, string> {\n  private readonly _value: string;\n\n  private constructor(value: string) {\n    this._value = value;\n  }\n\n  public static create(email: string): Email {\n    const finalEmail = email?.trim?.().toLowerCase();\n    this.validate(finalEmail);\n    return new Email(finalEmail);\n  }\n\n  private static validate(email: string): void {\n    if (!email || typeof email !== \"string\") {\n      throw new Error(\"O email não pode estar vazio\");\n    }\n\n    if (email.length > 254) {\n      throw new Error(\"O email deve ter no máximo 254 caracteres\");\n    }\n\n    const emailRegex =\n      /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-\\u00A0-\\uFFFF]+@[a-zA-Z0-9\\u00A0-\\uFFFF](?:[a-zA-Z0-9\\u00A0-\\uFFFF-]{0,61}[a-zA-Z0-9\\u00A0-\\uFFFF])?(?:\\.[a-zA-Z0-9\\u00A0-\\uFFFF](?:[a-zA-Z0-9\\u00A0-\\uFFFF-]{0,61}[a-zA-Z0-9\\u00A0-\\uFFFF])?)*$/;\n\n    if (!emailRegex.test(email)) {\n      throw new Error(\"O formato do email é inválido\");\n    }\n\n    const [localPart, domainPart] = email.split(\"@\");\n\n    if (localPart && localPart.includes(\"..\")) {\n      throw new Error(\n        \"O email não pode conter pontos consecutivos na parte local\"\n      );\n    }\n\n    // Verificar se não começa ou termina com ponto na parte local\n    if (localPart && (localPart.startsWith(\".\") || localPart.endsWith(\".\"))) {\n      throw new Error(\n        \"O email não pode começar ou terminar com ponto na parte local\"\n      );\n    }\n  }\n\n  public get value(): string {\n    return this._value;\n  }\n\n  public get localPart(): string {\n    return this._value.split(\"@\")[0]!;\n  }\n\n  public get domain(): string {\n    return this._value.split(\"@\")[1]!;\n  }\n\n  public equals(other: Email): boolean {\n    if (!(other instanceof Email)) {\n      return false;\n    }\n    return this._value === other._value;\n  }\n\n  public toString(): string {\n    return this._value;\n  }\n\n  public toJSON(): string {\n    return this._value;\n  }\n}\n","import { ValueObject } from \"./value-object\";\n\nexport class HashPassword implements ValueObject<HashPassword, string> {\n  private readonly _value: string;\n\n  private constructor(value: string) {\n    this._value = value;\n  }\n\n  public static create(hashPassword: string): HashPassword {\n    this.validate(hashPassword);\n    return new HashPassword(hashPassword.trim());\n  }\n\n  private static validate(hashPassword: string): void {\n    if (!hashPassword || typeof hashPassword !== \"string\") {\n      throw new Error(\"O hash da senha não pode estar vazio\");\n    }\n\n    const trimmedHash = hashPassword.trim();\n\n    if (trimmedHash.length === 0) {\n      throw new Error(\"O hash da senha não pode estar vazio\");\n    }\n\n    // Regex para validar hash bcrypt (formato: $2a$, $2b$, $2x$, $2y$ seguido de cost e hash)\n    const bcryptRegex = /^\\$2[abxy]\\$\\d{2}\\$[A-Za-z0-9.\\/]{53}$/;\n\n    if (!bcryptRegex.test(trimmedHash)) {\n      throw new Error(\"A senha deve estar criptografada\");\n    }\n  }\n\n  public get value(): string {\n    return this._value;\n  }\n\n  public get algorithm(): string {\n    return this._value.split(\"$\")[1]!;\n  }\n\n  public get cost(): number {\n    return parseInt(this._value.split(\"$\")[2]!, 10);\n  }\n\n  public equals(other: HashPassword): boolean {\n    if (!(other instanceof HashPassword)) {\n      return false;\n    }\n    return this._value === other._value;\n  }\n\n  public toString(): string {\n    return this._value;\n  }\n\n  public toJSON(): string {\n    return this._value;\n  }\n}\n","import { ValueObject } from \"./value-object\";\n\nexport class PersonName implements ValueObject<PersonName, string> {\n  private readonly _value: string;\n\n  private constructor(value: string) {\n    this._value = value;\n  }\n\n  public static create(name: string): PersonName {\n    this.validate(name);\n    return new PersonName(name.trim());\n  }\n\n  private static validate(name: string): void {\n    if (!name || typeof name !== \"string\") {\n      throw new Error(\"O nome é obrigatório e deve ser uma string\");\n    }\n\n    const trimmedName = name.trim();\n\n    if (trimmedName.length < 3) {\n      throw new Error(\"O nome deve ter pelo menos 3 caracteres\");\n    }\n\n    if (trimmedName.length > 120) {\n      throw new Error(\"O nome deve ter no máximo 120 caracteres\");\n    }\n\n    const validNameRegex =\n      /^[a-zA-ZÀ-ÿ\\u0100-\\u017F\\u0180-\\u024F\\u1E00-\\u1EFF\\s'-]+$/;\n    if (!validNameRegex.test(trimmedName)) {\n      throw new Error(\n        \"O nome contém caracteres inválidos. Apenas letras, espaços, apóstrofes e hífens são permitidos\"\n      );\n    }\n\n    const nameParts = trimmedName\n      .split(/\\s+/)\n      .filter((part) => part.length > 0);\n    if (nameParts.length < 2) {\n      throw new Error(\"O nome deve conter pelo menos um nome e um sobrenome\");\n    }\n\n    if (/\\s{2,}/.test(trimmedName)) {\n      throw new Error(\"O nome não pode conter espaços múltiplos consecutivos\");\n    }\n\n    // Validar se não começa ou termina com caracteres especiais\n    if (/^[-'\\s]|[-'\\s]$/.test(trimmedName)) {\n      throw new Error(\n        \"O nome não pode começar ou terminar com espaços, hífens ou apóstrofes\"\n      );\n    }\n  }\n\n  public get value(): string {\n    return this._value;\n  }\n\n  public get firstName(): string {\n    const firstName = this._value.split(\" \")[0];\n    return firstName!;\n  }\n\n  public get lastName(): string {\n    const parts = this._value.split(\" \");\n    const lastName = parts[parts.length - 1];\n    return lastName!;\n  }\n\n  public get fullName(): string {\n    return this._value;\n  }\n\n  public get initials(): string {\n    const nameParts = this.value\n      .trim()\n      .split(/\\s+/)\n      .filter((part) => part.length > 0);\n\n    return (this.firstName.charAt(0) + this.lastName.charAt(0)).toUpperCase();\n  }\n\n  public equals(other: PersonName): boolean {\n    if (!(other instanceof PersonName)) {\n      return false;\n    }\n    return this._value.toLowerCase() === other._value.toLowerCase();\n  }\n\n  public toString(): string {\n    return this._value;\n  }\n\n  public toJSON(): string {\n    return this._value;\n  }\n\n  public toFormattedString(): string {\n    return this._value\n      .split(\" \")\n      .map((name) => name.charAt(0).toUpperCase() + name.slice(1).toLowerCase())\n      .join(\" \");\n  }\n}\n","import { ValueObject } from \"./value-object\";\nimport { v4 as uuidv4, validate as isUuid } from \"uuid\";\n\nexport class Id implements ValueObject<Id, string> {\n  private readonly _value: string;\n\n  private constructor(value: string) {\n    this._value = value;\n  }\n\n  public static create(id?: string): Id {\n    const value = id?.trim().toLowerCase() ?? uuidv4();\n    this.validate(value);\n    return new Id(value);\n  }\n\n  private static validate(id: string): void {\n    if (!isUuid(id)) {\n      throw new Error(\"O id fornecido não é um UUID válido.\");\n    }\n  }\n\n  public get value(): string {\n    return this._value;\n  }\n\n  public equals(other: Id): boolean {\n    return other instanceof Id && this._value === other._value;\n  }\n\n  public toString(): string {\n    return this._value;\n  }\n\n  public toJSON(): string {\n    return this._value;\n  }\n}\n","import { Id } from \"./id.vo\";\n\nexport type EntityMode = \"draft\" | \"valid\";\n\nexport interface EntityProps<ID = string | number> {\n  id?: ID;\n}\n\nexport abstract class Entity<PROPS extends EntityProps> {\n  public readonly props: Readonly<PROPS>;\n  public readonly mode: EntityMode = \"valid\";\n  public readonly id: NonNullable<PROPS[\"id\"]>;\n\n  constructor(props: Readonly<PROPS>, mode: EntityMode = \"valid\") {\n    this.props = Object.freeze({\n      ...props,\n      id: props.id ? props.id : Id.create().value,\n    });\n    this.mode = mode;\n    this.id = this.props.id!;\n\n    if (\"props\" in props) {\n      throw new Error(\"Props should not contain 'props' property\");\n    }\n  }\n\n  get data(): Readonly<PROPS> {\n    return this.props;\n  }\n\n  isDraft(): boolean {\n    return this.mode === \"draft\";\n  }\n\n  isValid(): boolean {\n    return this.mode === \"valid\";\n  }\n\n  equals(entity?: unknown): boolean {\n    if (entity == null) return false;\n    if (!(entity instanceof Entity)) return false;\n    if (this === entity) return true;\n    if (this.constructor !== entity.constructor) return false;\n    return this.sameId(entity as Entity<PROPS>);\n  }\n\n  notEquals(entity?: unknown): boolean {\n    return !this.equals(entity);\n  }\n\n  protected sameId(other: Entity<PROPS>): boolean {\n    return this.id === other.id;\n  }\n\n  asDraft(): this {\n    return this.clone(this.props, \"draft\");\n  }\n\n  asValid(): this {\n    return this.clone(this.props, \"valid\");\n  }\n\n  clone(newProps: Partial<PROPS>, newMode: EntityMode = this.mode): this {\n    const Self = this.constructor as new (\n      props: Readonly<PROPS>,\n      mode: EntityMode,\n    ) => this;\n    return new Self(\n      {\n        ...this.props,\n        ...newProps,\n      },\n      newMode,\n    );\n  }\n}\n","import { ValueObject } from \"./value-object\";\n\nexport interface RequiredStringOptions {\n  attributeName?: string;\n  errorMessage?: string;\n  minLength?: number;\n  maxLength?: number;\n}\n\nexport class RequiredString implements ValueObject<RequiredString, string> {\n  private readonly _value: string;\n\n  private constructor(value: string) {\n    this._value = value;\n  }\n\n  public static create(\n    value: string,\n    options?: RequiredStringOptions\n  ): RequiredString {\n    this.validate(value, options);\n    return new RequiredString(value.trim());\n  }\n\n  private static validate(\n    value: string,\n    options?: RequiredStringOptions\n  ): void {\n    const errorMessage =\n      options?.errorMessage ||\n      `${options?.attributeName ?? \"Valor\"} é obrigatório`;\n\n    if (!value || typeof value !== \"string\") {\n      throw new Error(errorMessage);\n    }\n\n    const trimmedValue = value.trim();\n\n    if (trimmedValue.length === 0) {\n      throw new Error(errorMessage);\n    }\n\n    if (options?.minLength && trimmedValue.length < options.minLength) {\n      throw new Error(\n        `${options.attributeName ?? `\"${value}\"`} deve ter pelo menos ${options.minLength} caracteres`\n      );\n    }\n\n    if (options?.maxLength && trimmedValue.length > options.maxLength) {\n      throw new Error(\n        `${options.attributeName ?? `\"${value}\"`} deve ter no máximo ${options.maxLength} caracteres`\n      );\n    }\n  }\n\n  public get value(): string {\n    return this._value;\n  }\n\n  public equals(other: RequiredString): boolean {\n    return other instanceof RequiredString && this._value === other._value;\n  }\n\n  public toString(): string {\n    return this._value;\n  }\n\n  public toJSON(): string {\n    return this._value;\n  }\n}\n","/**\n * Shared color constants for Projects, Tags, and Workspaces\n * These colors are used across all applications (Web, Mobile, Desktop)\n */\n\nexport const PROJECT_COLORS = [\n    \"#EF4444\", // red\n    \"#F59E0B\", // amber\n    \"#10B981\", // emerald\n    \"#3B82F6\", // blue\n    \"#8B5CF6\", // violet\n    \"#EC4899\", // pink\n    \"#6B7280\", // gray\n] as const;\n\nexport const TAG_COLORS = [\n    \"#EF4444\", // red\n    \"#F59E0B\", // amber\n    \"#10B981\", // emerald\n    \"#3B82F6\", // blue\n    \"#8B5CF6\", // violet\n    \"#EC4899\", // pink\n    \"#06B6D4\", // cyan\n    \"#F43F5E\", // rose\n    \"#84CC16\", // lime\n    \"#6366F1\", // indigo\n] as const;\n\nexport const WORKSPACE_COLORS = {\n    PERSONAL: \"#06B6D4\", // cyan\n    WORK: \"#8B5CF6\",     // violet/purple\n    TEAM: \"#EC4899\",     // pink\n} as const;\n\nexport type ProjectColor = typeof PROJECT_COLORS[number];\nexport type TagColor = typeof TAG_COLORS[number];\nexport type WorkspaceColor = typeof WORKSPACE_COLORS[keyof typeof WORKSPACE_COLORS];\n","/**\n * Task priority constants with labels and colors\n * Used across all applications for consistent priority handling\n */\n\nexport const TASK_PRIORITIES = {\n    LOW: {\n        value: \"LOW\" as const,\n        label: \"Low\",\n        color: \"#10B981\", // emerald\n        order: 1,\n    },\n    MEDIUM: {\n        value: \"MEDIUM\" as const,\n        label: \"Medium\",\n        color: \"#F59E0B\", // amber\n        order: 2,\n    },\n    HIGH: {\n        value: \"HIGH\" as const,\n        label: \"High\",\n        color: \"#EF4444\", // red\n        order: 3,\n    },\n} as const;\n\nexport const PRIORITY_VALUES = [\"LOW\", \"MEDIUM\", \"HIGH\"] as const;\n\n/**\n * Task priority type\n * Note: TaskPriority is defined in tasks domain, so we use TaskPriorityValue here\n */\nexport type TaskPriorityValue = typeof PRIORITY_VALUES[number];\n\n/**\n * Get priority configuration by value\n */\nexport function getPriorityConfig(priority: TaskPriorityValue) {\n    return TASK_PRIORITIES[priority];\n}\n\n/**\n * Get priority color\n */\nexport function getPriorityColor(priority: TaskPriorityValue): string {\n    return TASK_PRIORITIES[priority].color;\n}\n\n/**\n * Get priority label\n */\nexport function getPriorityLabel(priority: TaskPriorityValue): string {\n    return TASK_PRIORITIES[priority].label;\n}\n","/**\n * Task and Project status constants\n * Used across all applications for consistent status handling\n */\n\nexport const TASK_STATUS = {\n    TODO: {\n        value: \"TODO\" as const,\n        label: \"To Do\",\n        color: \"#6B7280\", // gray\n        order: 1,\n    },\n    IN_PROGRESS: {\n        value: \"IN_PROGRESS\" as const,\n        label: \"In Progress\",\n        color: \"#3B82F6\", // blue\n        order: 2,\n    },\n    IN_REVIEW: {\n        value: \"IN_REVIEW\" as const,\n        label: \"In Review\",\n        color: \"#F59E0B\", // amber\n        order: 3,\n    },\n    DONE: {\n        value: \"DONE\" as const,\n        label: \"Done\",\n        color: \"#10B981\", // emerald\n        order: 4,\n    },\n    CANCELLED: {\n        value: \"CANCELLED\" as const,\n        label: \"Cancelled\",\n        color: \"#EF4444\", // red\n        order: 5,\n    },\n} as const;\n\nexport const TASK_STATUS_VALUES = [\n    \"TODO\",\n    \"IN_PROGRESS\",\n    \"IN_REVIEW\",\n    \"DONE\",\n    \"CANCELLED\",\n] as const;\n\n/**\n * Task status type\n * Note: TaskStatus is defined in tasks domain, so we use TaskStatusValue here\n */\nexport type TaskStatusValue = typeof TASK_STATUS_VALUES[number];\n\n/**\n * Project status constants\n */\nexport const PROJECT_STATUS = {\n    ACTIVE: {\n        value: \"ACTIVE\" as const,\n        label: \"Active\",\n        color: \"#10B981\", // emerald\n    },\n    ARCHIVED: {\n        value: \"ARCHIVED\" as const,\n        label: \"Archived\",\n        color: \"#6B7280\", // gray\n    },\n    ON_HOLD: {\n        value: \"ON_HOLD\" as const,\n        label: \"On Hold\",\n        color: \"#F59E0B\", // amber\n    },\n} as const;\n\nexport const PROJECT_STATUS_VALUES = [\"ACTIVE\", \"ARCHIVED\", \"ON_HOLD\"] as const;\n\n/**\n * Project status type\n * Note: ProjectStatus might be defined elsewhere, so we use ProjectStatusValue here\n */\nexport type ProjectStatusValue = typeof PROJECT_STATUS_VALUES[number];\n\n/**\n * Get task status configuration by value\n */\nexport function getTaskStatusConfig(status: TaskStatusValue) {\n    return TASK_STATUS[status];\n}\n\n/**\n * Get task status color\n */\nexport function getTaskStatusColor(status: TaskStatusValue): string {\n    return TASK_STATUS[status].color;\n}\n\n/**\n * Get task status label\n */\nexport function getTaskStatusLabel(status: TaskStatusValue): string {\n    return TASK_STATUS[status].label;\n}\n\n/**\n * Check if task is completed\n */\nexport function isTaskCompleted(status: TaskStatusValue): boolean {\n    return status === \"DONE\";\n}\n\n/**\n * Check if task is in progress\n */\nexport function isTaskInProgress(status: TaskStatusValue): boolean {\n    return status === \"IN_PROGRESS\" || status === \"IN_REVIEW\";\n}\n","/**\n * Pomodoro Timer constants\n * Used across all applications for consistent timer behavior\n */\n\nexport const TIMER_MODES = {\n    WORK: {\n        value: \"WORK\" as const,\n        label: \"Work\",\n        color: \"#EF4444\", // red\n        defaultDuration: 25, // minutes\n    },\n    SHORT_BREAK: {\n        value: \"SHORT_BREAK\" as const,\n        label: \"Short Break\",\n        color: \"#10B981\", // light green\n        defaultDuration: 5, // minutes\n    },\n    LONG_BREAK: {\n        value: \"LONG_BREAK\" as const,\n        label: \"Long Break\",\n        color: \"#059669\", // dark green\n        defaultDuration: 15, // minutes\n    },\n    CONTINUOUS: {\n        value: \"CONTINUOUS\" as const,\n        label: \"Continuous\",\n        color: \"#3B82F6\", // blue\n        defaultDuration: 0, // no limit\n    },\n} as const;\n\nexport const TIMER_MODE_VALUES = [\n    \"WORK\",\n    \"SHORT_BREAK\",\n    \"LONG_BREAK\",\n    \"CONTINUOUS\",\n] as const;\n\nexport type TimerMode = typeof TIMER_MODE_VALUES[number];\n\n/**\n * Default Pomodoro settings\n */\nexport const DEFAULT_POMODORO_SETTINGS = {\n    workDuration: 25, // minutes\n    shortBreakDuration: 5, // minutes\n    longBreakDuration: 15, // minutes\n    pomodorosUntilLongBreak: 4, // number of work sessions\n    autoStartBreaks: false,\n    autoStartPomodoros: false,\n    soundEnabled: true,\n    notificationsEnabled: true,\n} as const;\n\n/**\n * Timer limits and constraints\n */\nexport const TIMER_LIMITS = {\n    MIN_DURATION: 1, // minutes\n    MAX_DURATION: 120, // minutes\n    MIN_POMODOROS_UNTIL_LONG_BREAK: 2,\n    MAX_POMODOROS_UNTIL_LONG_BREAK: 10,\n} as const;\n\n/**\n * Get timer mode configuration\n */\nexport function getTimerModeConfig(mode: TimerMode) {\n    return TIMER_MODES[mode];\n}\n\n/**\n * Get timer mode color\n */\nexport function getTimerModeColor(mode: TimerMode): string {\n    return TIMER_MODES[mode].color;\n}\n\n/**\n * Get timer mode label\n */\nexport function getTimerModeLabel(mode: TimerMode): string {\n    return TIMER_MODES[mode].label;\n}\n\n/**\n * Get timer mode default duration\n */\nexport function getTimerModeDefaultDuration(mode: TimerMode): number {\n    return TIMER_MODES[mode].defaultDuration;\n}\n\n/**\n * Check if it's time for a long break\n */\nexport function shouldTakeLongBreak(\n    completedPomodoros: number,\n    pomodorosUntilLongBreak: number = DEFAULT_POMODORO_SETTINGS.pomodorosUntilLongBreak\n): boolean {\n    return completedPomodoros > 0 && completedPomodoros % pomodorosUntilLongBreak === 0;\n}\n","/**\n * Application limits and constraints\n * Used across all applications for validation and UI constraints\n */\n\n/**\n * Task limits\n */\nexport const TASK_LIMITS = {\n    TITLE_MIN_LENGTH: 1,\n    TITLE_MAX_LENGTH: 200,\n    DESCRIPTION_MAX_LENGTH: 5000,\n    MIN_ESTIMATED_MINUTES: 1,\n    MAX_ESTIMATED_MINUTES: 480, // 8 hours\n    MAX_SUBTASKS: 50,\n    MAX_TAGS_PER_TASK: 10,\n    MAX_ATTACHMENTS_PER_TASK: 20,\n} as const;\n\n/**\n * Project limits\n */\nexport const PROJECT_LIMITS = {\n    NAME_MIN_LENGTH: 1,\n    NAME_MAX_LENGTH: 100,\n    DESCRIPTION_MAX_LENGTH: 2000,\n    MAX_PROJECTS_PER_WORKSPACE: 100,\n    MAX_TASKS_PER_PROJECT: 1000,\n} as const;\n\n/**\n * Workspace limits\n */\nexport const WORKSPACE_LIMITS = {\n    NAME_MIN_LENGTH: 1,\n    NAME_MAX_LENGTH: 100,\n    DESCRIPTION_MAX_LENGTH: 500,\n    MAX_MEMBERS: 50,\n    MAX_WORKSPACES_PER_USER: 20,\n    SLUG_MIN_LENGTH: 3,\n    SLUG_MAX_LENGTH: 50,\n} as const;\n\n/**\n * Tag limits\n */\nexport const TAG_LIMITS = {\n    NAME_MIN_LENGTH: 1,\n    NAME_MAX_LENGTH: 30,\n    MAX_TAGS_PER_WORKSPACE: 100,\n} as const;\n\n/**\n * Comment limits\n */\nexport const COMMENT_LIMITS = {\n    CONTENT_MIN_LENGTH: 1,\n    CONTENT_MAX_LENGTH: 2000,\n    MAX_COMMENTS_PER_TASK: 500,\n} as const;\n\n/**\n * File upload limits\n */\nexport const FILE_LIMITS = {\n    MAX_FILE_SIZE: 10 * 1024 * 1024, // 10 MB\n    MAX_IMAGE_SIZE: 5 * 1024 * 1024, // 5 MB\n    MAX_TOTAL_STORAGE_PER_WORKSPACE: 1024 * 1024 * 1024, // 1 GB\n    ALLOWED_IMAGE_TYPES: [\"image/jpeg\", \"image/png\", \"image/gif\", \"image/webp\"],\n    ALLOWED_DOCUMENT_TYPES: [\n        \"application/pdf\",\n        \"application/msword\",\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n        \"application/vnd.ms-excel\",\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n    ],\n} as const;\n\n/**\n * User limits\n */\nexport const USER_LIMITS = {\n    NAME_MIN_LENGTH: 2,\n    NAME_MAX_LENGTH: 100,\n    PASSWORD_MIN_LENGTH: 6,\n    PASSWORD_MAX_LENGTH: 128,\n    BIO_MAX_LENGTH: 500,\n} as const;\n\n/**\n * Pagination limits\n */\nexport const PAGINATION_LIMITS = {\n    DEFAULT_PAGE_SIZE: 20,\n    MAX_PAGE_SIZE: 100,\n    MIN_PAGE_SIZE: 5,\n} as const;\n\n/**\n * Helper function to format file size\n */\nexport function formatFileSize(bytes: number): string {\n    if (bytes === 0) return \"0 Bytes\";\n    const k = 1024;\n    const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + \" \" + sizes[i];\n}\n\n/**\n * Check if file type is allowed\n */\nexport function isAllowedFileType(mimeType: string): boolean {\n    const allowedTypes: readonly string[] = [\n        ...FILE_LIMITS.ALLOWED_IMAGE_TYPES,\n        ...FILE_LIMITS.ALLOWED_DOCUMENT_TYPES,\n    ];\n    return allowedTypes.includes(mimeType);\n}\n\n/**\n * Check if file is an image\n */\nexport function isImageFile(mimeType: string): boolean {\n    return (FILE_LIMITS.ALLOWED_IMAGE_TYPES as readonly string[]).includes(mimeType);\n}\n","/**\n * Date utility functions\n * Used across all applications for consistent date handling\n */\n\n/**\n * Format a date to a readable string\n */\nexport function formatDate(date: Date | string, locale: string = \"en-US\"): string {\n    const d = typeof date === \"string\" ? new Date(date) : date;\n    return d.toLocaleDateString(locale, {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n    });\n}\n\n/**\n * Format a date to a short string (e.g., \"Dec 4, 2025\")\n */\nexport function formatDateShort(date: Date | string, locale: string = \"en-US\"): string {\n    const d = typeof date === \"string\" ? new Date(date) : date;\n    return d.toLocaleDateString(locale, {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n    });\n}\n\n/**\n * Format a date to relative time (e.g., \"2 days ago\", \"in 3 hours\")\n */\nexport function formatRelativeTime(date: Date | string, locale: string = \"en-US\"): string {\n    const d = typeof date === \"string\" ? new Date(date) : date;\n    const now = new Date();\n    const diffMs = d.getTime() - now.getTime();\n    const diffSec = Math.round(diffMs / 1000);\n    const diffMin = Math.round(diffSec / 60);\n    const diffHour = Math.round(diffMin / 60);\n    const diffDay = Math.round(diffHour / 24);\n\n    if (Math.abs(diffSec) < 60) {\n        return diffSec >= 0 ? \"in a few seconds\" : \"a few seconds ago\";\n    } else if (Math.abs(diffMin) < 60) {\n        return diffMin >= 0 ? `in ${diffMin} minute${diffMin !== 1 ? \"s\" : \"\"}` : `${Math.abs(diffMin)} minute${Math.abs(diffMin) !== 1 ? \"s\" : \"\"} ago`;\n    } else if (Math.abs(diffHour) < 24) {\n        return diffHour >= 0 ? `in ${diffHour} hour${diffHour !== 1 ? \"s\" : \"\"}` : `${Math.abs(diffHour)} hour${Math.abs(diffHour) !== 1 ? \"s\" : \"\"} ago`;\n    } else if (Math.abs(diffDay) < 30) {\n        return diffDay >= 0 ? `in ${diffDay} day${diffDay !== 1 ? \"s\" : \"\"}` : `${Math.abs(diffDay)} day${Math.abs(diffDay) !== 1 ? \"s\" : \"\"} ago`;\n    } else {\n        return formatDateShort(d, locale);\n    }\n}\n\n/**\n * Check if a date is today\n */\nexport function isToday(date: Date | string): boolean {\n    const d = typeof date === \"string\" ? new Date(date) : date;\n    const today = new Date();\n    return (\n        d.getDate() === today.getDate() &&\n        d.getMonth() === today.getMonth() &&\n        d.getFullYear() === today.getFullYear()\n    );\n}\n\n/**\n * Check if a date is in the past\n */\nexport function isPast(date: Date | string): boolean {\n    const d = typeof date === \"string\" ? new Date(date) : date;\n    return d.getTime() < new Date().getTime();\n}\n\n/**\n * Check if a date is in the future\n */\nexport function isFuture(date: Date | string): boolean {\n    const d = typeof date === \"string\" ? new Date(date) : date;\n    return d.getTime() > new Date().getTime();\n}\n\n/**\n * Check if a task is overdue\n */\nexport function isOverdue(dueDate: Date | string | null | undefined): boolean {\n    if (!dueDate) return false;\n    const d = typeof dueDate === \"string\" ? new Date(dueDate) : dueDate;\n    return isPast(d) && !isToday(d);\n}\n\n/**\n * Get the difference in days between two dates\n */\nexport function getDaysDiff(date1: Date | string, date2: Date | string): number {\n    const d1 = typeof date1 === \"string\" ? new Date(date1) : date1;\n    const d2 = typeof date2 === \"string\" ? new Date(date2) : date2;\n    const diffMs = d2.getTime() - d1.getTime();\n    return Math.floor(diffMs / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Get the start of day for a date\n */\nexport function startOfDay(date: Date | string): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    d.setHours(0, 0, 0, 0);\n    return d;\n}\n\n/**\n * Get the end of day for a date\n */\nexport function endOfDay(date: Date | string): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    d.setHours(23, 59, 59, 999);\n    return d;\n}\n\n/**\n * Get the start of week for a date\n */\nexport function startOfWeek(date: Date | string): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    const day = d.getDay();\n    const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust when day is Sunday\n    const startDate = new Date(d.setDate(diff));\n    startDate.setHours(0, 0, 0, 0);\n    return startDate;\n}\n\n/**\n * Get the end of week for a date\n */\nexport function endOfWeek(date: Date | string): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    const day = d.getDay();\n    const diff = d.getDate() + (day === 0 ? 0 : 7 - day);\n    const endDate = new Date(d.setDate(diff));\n    endDate.setHours(23, 59, 59, 999);\n    return endDate;\n}\n\n/**\n * Add days to a date\n */\nexport function addDays(date: Date | string, days: number): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    d.setDate(d.getDate() + days);\n    return d;\n}\n\n/**\n * Add hours to a date\n */\nexport function addHours(date: Date | string, hours: number): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    d.setHours(d.getHours() + hours);\n    return d;\n}\n\n/**\n * Add minutes to a date\n */\nexport function addMinutes(date: Date | string, minutes: number): Date {\n    const d = typeof date === \"string\" ? new Date(date) : new Date(date);\n    d.setMinutes(d.getMinutes() + minutes);\n    return d;\n}\n\n// ============ SMART DATES UTILITIES ============\n\n/**\n * Get the start of today\n */\nexport function startOfToday(): Date {\n    return startOfDay(new Date());\n}\n\n/**\n * Check if date1 is before date2\n */\nexport function isBefore(date1: Date | string, date2: Date | string): boolean {\n    const d1 = typeof date1 === \"string\" ? new Date(date1) : date1;\n    const d2 = typeof date2 === \"string\" ? new Date(date2) : date2;\n    return d1.getTime() < d2.getTime();\n}\n\n/**\n * Check if date1 is after date2\n */\nexport function isAfter(date1: Date | string, date2: Date | string): boolean {\n    const d1 = typeof date1 === \"string\" ? new Date(date1) : date1;\n    const d2 = typeof date2 === \"string\" ? new Date(date2) : date2;\n    return d1.getTime() > d2.getTime();\n}\n\n/**\n * Check if a task is available to work on (startDate <= today or no startDate)\n */\nexport function isTaskAvailable(task: { startDate?: Date | string | null }): boolean {\n    if (!task.startDate) return true;\n    const startDate = typeof task.startDate === \"string\" ? new Date(task.startDate) : task.startDate;\n    return startDate <= new Date();\n}\n\n/**\n * Check if a task is scheduled for today\n */\nexport function isScheduledForToday(task: { scheduledDate?: Date | string | null }): boolean {\n    if (!task.scheduledDate) return false;\n    return isToday(task.scheduledDate);\n}\n\n/**\n * Check if a task is due today\n */\nexport function isDueToday(task: { dueDate?: Date | string | null }): boolean {\n    if (!task.dueDate) return false;\n    return isToday(task.dueDate);\n}\n\n/**\n * Task interface for categorization\n */\ninterface TaskForCategorization {\n    dueDate?: Date | string | null;\n    startDate?: Date | string | null;\n    scheduledDate?: Date | string | null;\n    status?: string;\n}\n\n/**\n * Categorize tasks by availability and dates\n */\nexport function categorizeTasksByAvailability<T extends TaskForCategorization>(tasks: T[]): {\n    overdue: T[];\n    dueToday: T[];\n    scheduledToday: T[];\n    available: T[];\n    notYetAvailable: T[];\n} {\n    const today = startOfToday();\n\n    return {\n        overdue: tasks.filter(t =>\n            t.dueDate &&\n            isBefore(t.dueDate, today) &&\n            t.status !== 'COMPLETED'\n        ),\n        dueToday: tasks.filter(t =>\n            t.dueDate &&\n            isToday(t.dueDate)\n        ),\n        scheduledToday: tasks.filter(t =>\n            t.scheduledDate &&\n            isToday(t.scheduledDate)\n        ),\n        available: tasks.filter(t =>\n            isTaskAvailable(t) &&\n            !isScheduledForToday(t) &&\n            t.status !== 'COMPLETED'\n        ),\n        notYetAvailable: tasks.filter(t =>\n            !isTaskAvailable(t)\n        ),\n    };\n}\n\n/**\n * Get tasks that can be worked on today (available and not blocked)\n */\nexport function getWorkableTasks<T extends TaskForCategorization>(tasks: T[]): T[] {\n    return tasks.filter(t =>\n        isTaskAvailable(t) &&\n        t.status !== 'COMPLETED' &&\n        t.status !== 'CANCELLED'\n    );\n}\n\n/**\n * Format scheduled time for display\n */\nexport function formatScheduledDateTime(\n    scheduledDate: Date | string | null | undefined,\n    scheduledTime: string | null | undefined,\n    locale: string = \"en-US\"\n): string | null {\n    if (!scheduledDate) return null;\n\n    const dateStr = formatDateShort(scheduledDate, locale);\n\n    if (scheduledTime) {\n        return `${dateStr} at ${scheduledTime}`;\n    }\n\n    return dateStr;\n}\n","/**\n * Time utility functions\n * Used across all applications for consistent time formatting and calculations\n */\n\n/**\n * Format duration in minutes to human-readable string (e.g., \"2h 30m\")\n */\nexport function formatDuration(minutes: number): string {\n    if (minutes < 60) {\n        return `${minutes}m`;\n    }\n    const hours = Math.floor(minutes / 60);\n    const mins = minutes % 60;\n    return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;\n}\n\n/**\n * Format duration in seconds to human-readable string (e.g., \"1h 23m 45s\")\n */\nexport function formatDurationFromSeconds(seconds: number): string {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = seconds % 60;\n\n    const parts: string[] = [];\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (secs > 0 || parts.length === 0) parts.push(`${secs}s`);\n\n    return parts.join(\" \");\n}\n\n/**\n * Format time for timer display (MM:SS)\n */\nexport function formatTimerDisplay(seconds: number): string {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}`;\n}\n\n/**\n * Format time for extended timer display (HH:MM:SS)\n */\nexport function formatTimerDisplayExtended(seconds: number): string {\n    const hours = Math.floor(seconds / 3600);\n    const mins = Math.floor((seconds % 3600) / 60);\n    const secs = seconds % 60;\n    return `${hours.toString().padStart(2, \"0\")}:${mins.toString().padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}`;\n}\n\n/**\n * Convert minutes to hours (decimal)\n */\nexport function minutesToHours(minutes: number): number {\n    return Math.round((minutes / 60) * 100) / 100;\n}\n\n/**\n * Convert hours to minutes\n */\nexport function hoursToMinutes(hours: number): number {\n    return Math.round(hours * 60);\n}\n\n/**\n * Convert seconds to minutes\n */\nexport function secondsToMinutes(seconds: number): number {\n    return Math.round(seconds / 60);\n}\n\n/**\n * Convert minutes to seconds\n */\nexport function minutesToSeconds(minutes: number): number {\n    return minutes * 60;\n}\n\n/**\n * Parse duration string to minutes (e.g., \"2h 30m\" -> 150)\n */\nexport function parseDuration(duration: string): number {\n    const hourMatch = duration.match(/(\\d+)h/);\n    const minMatch = duration.match(/(\\d+)m/);\n\n    const hours = hourMatch ? parseInt(hourMatch[1]!, 10) : 0;\n    const minutes = minMatch ? parseInt(minMatch[1]!, 10) : 0;\n\n    return hours * 60 + minutes;\n}\n\n/**\n * Calculate total time worked from time entries\n */\nexport function calculateTotalTimeWorked(timeEntries: Array<{ duration: number }>): number {\n    return timeEntries.reduce((total, entry) => total + entry.duration, 0);\n}\n\n/**\n * Calculate average time per task\n */\nexport function calculateAverageTime(totalMinutes: number, taskCount: number): number {\n    if (taskCount === 0) return 0;\n    return Math.round(totalMinutes / taskCount);\n}\n\n/**\n * Format time of day (e.g., \"14:30\" -> \"2:30 PM\")\n */\nexport function formatTimeOfDay(time: string, use24Hour: boolean = false): string {\n    const [hours, minutes] = time.split(\":\").map(Number);\n\n    if (use24Hour) {\n        return `${(hours || 0).toString().padStart(2, \"0\")}:${(minutes || 0).toString().padStart(2, \"0\")}`;\n    }\n\n    const period = (hours || 0) >= 12 ? \"PM\" : \"AM\";\n    const displayHours = (hours || 0) % 12 || 12;\n    return `${displayHours}:${(minutes || 0).toString().padStart(2, \"0\")} ${period}`;\n}\n\n/**\n * Get current time in HH:MM format\n */\nexport function getCurrentTime(): string {\n    const now = new Date();\n    return `${now.getHours().toString().padStart(2, \"0\")}:${now.getMinutes().toString().padStart(2, \"0\")}`;\n}\n\n/**\n * Check if time is within working hours (9 AM - 6 PM by default)\n */\nexport function isWorkingHours(\n    date: Date = new Date(),\n    startHour: number = 9,\n    endHour: number = 18\n): boolean {\n    const hour = date.getHours();\n    return hour >= startHour && hour < endHour;\n}\n","/**\n * String utility functions\n * Used across all applications for consistent string manipulation\n */\n\n/**\n * Generate a URL-friendly slug from a string\n */\nexport function generateSlug(text: string): string {\n    return text\n        .toLowerCase()\n        .trim()\n        .replace(/[^\\w\\s-]/g, \"\") // Remove non-word chars (except spaces and hyphens)\n        .replace(/[\\s_-]+/g, \"-\") // Replace spaces, underscores with single hyphen\n        .replace(/^-+|-+$/g, \"\"); // Remove leading/trailing hyphens\n}\n\n/**\n * Truncate a string to a maximum length with ellipsis\n */\nexport function truncate(text: string, maxLength: number, ellipsis: string = \"...\"): string {\n    if (text.length <= maxLength) return text;\n    return text.slice(0, maxLength - ellipsis.length) + ellipsis;\n}\n\n/**\n * Capitalize the first letter of a string\n */\nexport function capitalize(text: string): string {\n    if (!text) return text;\n    return text.charAt(0).toUpperCase() + text.slice(1).toLowerCase();\n}\n\n/**\n * Capitalize the first letter of each word\n */\nexport function capitalizeWords(text: string): string {\n    return text\n        .split(\" \")\n        .map((word) => capitalize(word))\n        .join(\" \");\n}\n\n/**\n * Convert camelCase or PascalCase to Title Case\n */\nexport function camelToTitle(text: string): string {\n    const result = text.replace(/([A-Z])/g, \" $1\");\n    return result.charAt(0).toUpperCase() + result.slice(1);\n}\n\n/**\n * Convert snake_case to Title Case\n */\nexport function snakeToTitle(text: string): string {\n    return text\n        .split(\"_\")\n        .map((word) => capitalize(word))\n        .join(\" \");\n}\n\n/**\n * Extract initials from a name (e.g., \"John Doe\" -> \"JD\")\n */\nexport function getInitials(name: string, maxLength: number = 2): string {\n    const words = name.trim().split(/\\s+/);\n    const initials = words\n        .map((word) => word.charAt(0).toUpperCase())\n        .join(\"\");\n    return initials.slice(0, maxLength);\n}\n\n/**\n * Generate a random string of specified length\n */\nexport function generateRandomString(length: number): string {\n    const chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n    let result = \"\";\n    for (let i = 0; i < length; i++) {\n        result += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    return result;\n}\n\n/**\n * Check if a string is a valid email\n */\nexport function isValidEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n}\n\n/**\n * Check if a string is a valid URL\n */\nexport function isValidUrl(url: string): boolean {\n    try {\n        new URL(url);\n        return true;\n    } catch {\n        return false;\n    }\n}\n\n/**\n * Sanitize a string for use in HTML (basic XSS prevention)\n */\nexport function sanitizeHtml(text: string): string {\n    const map: Record<string, string> = {\n        \"&\": \"&amp;\",\n        \"<\": \"&lt;\",\n        \">\": \"&gt;\",\n        '\"': \"&quot;\",\n        \"'\": \"&#x27;\",\n        \"/\": \"&#x2F;\",\n    };\n    return text.replace(/[&<>\"'/]/g, (char) => map[char] || char);\n}\n\n/**\n * Remove extra whitespace from a string\n */\nexport function normalizeWhitespace(text: string): string {\n    return text.replace(/\\s+/g, \" \").trim();\n}\n\n/**\n * Count words in a string\n */\nexport function countWords(text: string): number {\n    return text.trim().split(/\\s+/).filter(Boolean).length;\n}\n\n/**\n * Pluralize a word based on count\n */\nexport function pluralize(word: string, count: number, plural?: string): string {\n    if (count === 1) return word;\n    return plural || `${word}s`;\n}\n\n/**\n * Format a number with commas (e.g., 1000 -> \"1,000\")\n */\nexport function formatNumber(num: number): string {\n    return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\n/**\n * Generate a unique ID (simple implementation)\n */\nexport function generateId(): string {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n/**\n * Check if string contains only alphanumeric characters\n */\nexport function isAlphanumeric(text: string): boolean {\n    return /^[a-zA-Z0-9]+$/.test(text);\n}\n\n/**\n * Remove HTML tags from a string\n */\nexport function stripHtmlTags(html: string): string {\n    return html.replace(/<[^>]*>/g, \"\");\n}\n\n/**\n * Highlight search terms in text\n */\nexport function highlightSearchTerms(text: string, searchTerm: string): string {\n    if (!searchTerm) return text;\n    const regex = new RegExp(`(${searchTerm})`, \"gi\");\n    return text.replace(regex, \"<mark>$1</mark>\");\n}\n","/**\n * Calculation utility functions\n * Used across all applications for consistent business logic calculations\n */\n\n/**\n * Calculate progress percentage\n */\nexport function calculateProgress(completed: number, total: number): number {\n    if (total === 0) return 0;\n    return Math.round((completed / total) * 100);\n}\n\n/**\n * Calculate completion rate\n */\nexport function calculateCompletionRate(completed: number, total: number): number {\n    if (total === 0) return 0;\n    return Math.round((completed / total) * 100 * 10) / 10; // One decimal place\n}\n\n/**\n * Calculate productivity score (0-100)\n * Based on completed tasks, time worked, and focus time\n */\nexport function calculateProductivityScore(\n    completedTasks: number,\n    totalTasks: number,\n    focusMinutes: number,\n    targetFocusMinutes: number = 240 // 4 hours default\n): number {\n    if (totalTasks === 0 && focusMinutes === 0) return 0;\n\n    const taskScore = totalTasks > 0 ? (completedTasks / totalTasks) * 50 : 0;\n    const focusScore = Math.min((focusMinutes / targetFocusMinutes) * 50, 50);\n\n    return Math.round(taskScore + focusScore);\n}\n\n/**\n * Calculate focus score based on pomodoros completed\n */\nexport function calculateFocusScore(\n    completedPomodoros: number,\n    targetPomodoros: number = 8\n): number {\n    if (targetPomodoros === 0) return 0;\n    return Math.min(Math.round((completedPomodoros / targetPomodoros) * 100), 100);\n}\n\n/**\n * Calculate average completion time\n */\nexport function calculateAverageCompletionTime(\n    tasks: Array<{ createdAt: Date | string; completedAt?: Date | string | null }>\n): number {\n    const completedTasks = tasks.filter((t) => t.completedAt != null);\n    if (completedTasks.length === 0) return 0;\n\n    const totalTime = completedTasks.reduce((sum, task) => {\n        if (!task.completedAt) return sum; // Extra safety check\n        const created = typeof task.createdAt === \"string\" ? new Date(task.createdAt) : task.createdAt;\n        const completed = typeof task.completedAt === \"string\" ? new Date(task.completedAt) : task.completedAt;\n        return sum + (completed.getTime() - created.getTime());\n    }, 0);\n\n    return Math.round(totalTime / completedTasks.length / (1000 * 60)); // Convert to minutes\n}\n\n/**\n * Calculate velocity (tasks completed per day)\n */\nexport function calculateVelocity(\n    completedTasks: number,\n    days: number\n): number {\n    if (days === 0) return 0;\n    return Math.round((completedTasks / days) * 10) / 10; // One decimal place\n}\n\n/**\n * Calculate estimated completion date based on velocity\n */\nexport function calculateEstimatedCompletion(\n    remainingTasks: number,\n    velocity: number\n): Date | null {\n    if (velocity === 0) return null;\n    const daysNeeded = Math.ceil(remainingTasks / velocity);\n    const completionDate = new Date();\n    completionDate.setDate(completionDate.getDate() + daysNeeded);\n    return completionDate;\n}\n\n/**\n * Calculate burndown rate\n */\nexport function calculateBurndownRate(\n    initialTasks: number,\n    remainingTasks: number,\n    elapsedDays: number\n): number {\n    if (elapsedDays === 0) return 0;\n    const completedTasks = initialTasks - remainingTasks;\n    return Math.round((completedTasks / elapsedDays) * 10) / 10;\n}\n\n/**\n * Calculate project health score (0-100)\n * Based on progress, overdue tasks, and velocity\n */\nexport function calculateProjectHealth(\n    completedTasks: number,\n    totalTasks: number,\n    overdueTasks: number,\n    velocity: number,\n    targetVelocity: number = 2\n): number {\n    if (totalTasks === 0) return 100;\n\n    const progressScore = (completedTasks / totalTasks) * 40;\n    const overdueScore = Math.max(0, 30 - (overdueTasks / totalTasks) * 30);\n    const velocityScore = Math.min((velocity / targetVelocity) * 30, 30);\n\n    return Math.round(progressScore + overdueScore + velocityScore);\n}\n\n/**\n * Calculate time utilization percentage\n */\nexport function calculateTimeUtilization(\n    actualMinutes: number,\n    estimatedMinutes: number\n): number {\n    if (estimatedMinutes === 0) return 0;\n    return Math.round((actualMinutes / estimatedMinutes) * 100);\n}\n\n/**\n * Calculate efficiency score\n */\nexport function calculateEfficiency(\n    completedTasks: number,\n    totalMinutesWorked: number\n): number {\n    if (totalMinutesWorked === 0) return 0;\n    const tasksPerHour = (completedTasks / totalMinutesWorked) * 60;\n    return Math.round(tasksPerHour * 100) / 100;\n}\n\n/**\n * Calculate streak (consecutive days with activity)\n */\nexport function calculateStreak(\n    activityDates: Array<Date | string>\n): number {\n    if (activityDates.length === 0) return 0;\n\n    const sortedDates = activityDates\n        .map((d) => typeof d === \"string\" ? new Date(d) : d)\n        .sort((a, b) => b.getTime() - a.getTime());\n\n    let streak = 1;\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    // Check if the most recent activity was today or yesterday\n    const mostRecent = new Date(sortedDates[0]!);\n    mostRecent.setHours(0, 0, 0, 0);\n    const daysDiff = Math.floor((today.getTime() - mostRecent.getTime()) / (1000 * 60 * 60 * 24));\n\n    if (daysDiff > 1) return 0; // Streak broken\n\n    for (let i = 1; i < sortedDates.length; i++) {\n        const current = new Date(sortedDates[i]!);\n        current.setHours(0, 0, 0, 0);\n        const previous = new Date(sortedDates[i - 1]!);\n        previous.setHours(0, 0, 0, 0);\n\n        const diff = Math.floor((previous.getTime() - current.getTime()) / (1000 * 60 * 60 * 24));\n        if (diff === 1) {\n            streak++;\n        } else {\n            break;\n        }\n    }\n\n    return streak;\n}\n\n/**\n * Calculate percentile rank\n */\nexport function calculatePercentile(value: number, values: number[]): number {\n    if (values.length === 0) return 0;\n    const sorted = [...values].sort((a, b) => a - b);\n    const index = sorted.findIndex((v) => v >= value);\n    if (index === -1) return 100;\n    return Math.round((index / sorted.length) * 100);\n}\n\n/**\n * Calculate weighted average\n */\nexport function calculateWeightedAverage(\n    values: Array<{ value: number; weight: number }>\n): number {\n    if (values.length === 0) return 0;\n    const totalWeight = values.reduce((sum, item) => sum + item.weight, 0);\n    if (totalWeight === 0) return 0;\n    const weightedSum = values.reduce((sum, item) => sum + item.value * item.weight, 0);\n    return Math.round((weightedSum / totalWeight) * 100) / 100;\n}\n","/**\n * Color utility functions\n * Used across all applications for consistent color manipulation\n */\n\n/**\n * Convert hex color to RGB\n */\nexport function hexToRgb(hex: string): { r: number; g: number; b: number } | null {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result\n        ? {\n            r: parseInt(result[1]!, 16),\n            g: parseInt(result[2]!, 16),\n            b: parseInt(result[3]!, 16),\n        }\n        : null;\n}\n\n/**\n * Convert RGB to hex color\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n    const toHex = (x: number) => {\n        const hex = x.toString(16);\n        return hex.length === 1 ? \"0\" + hex : hex;\n    };\n    return \"#\" + toHex(r) + toHex(g) + toHex(b);\n}\n\n/**\n * Get contrast color (black or white) for a given background color\n */\nexport function getContrastColor(hexColor: string): string {\n    const rgb = hexToRgb(hexColor);\n    if (!rgb) return \"#000000\";\n\n    // Calculate relative luminance\n    const luminance = (0.299 * rgb.r + 0.587 * rgb.g + 0.114 * rgb.b) / 255;\n\n    return luminance > 0.5 ? \"#000000\" : \"#FFFFFF\";\n}\n\n/**\n * Lighten a color by a percentage\n */\nexport function lightenColor(hexColor: string, percent: number): string {\n    const rgb = hexToRgb(hexColor);\n    if (!rgb) return hexColor;\n\n    const amount = Math.round(2.55 * percent);\n    const r = Math.min(255, rgb.r + amount);\n    const g = Math.min(255, rgb.g + amount);\n    const b = Math.min(255, rgb.b + amount);\n\n    return rgbToHex(r, g, b);\n}\n\n/**\n * Darken a color by a percentage\n */\nexport function darkenColor(hexColor: string, percent: number): string {\n    const rgb = hexToRgb(hexColor);\n    if (!rgb) return hexColor;\n\n    const amount = Math.round(2.55 * percent);\n    const r = Math.max(0, rgb.r - amount);\n    const g = Math.max(0, rgb.g - amount);\n    const b = Math.max(0, rgb.b - amount);\n\n    return rgbToHex(r, g, b);\n}\n\n/**\n * Add alpha channel to hex color\n */\nexport function addAlpha(hexColor: string, alpha: number): string {\n    const rgb = hexToRgb(hexColor);\n    if (!rgb) return hexColor;\n\n    const a = Math.round(Math.min(Math.max(alpha, 0), 1) * 255);\n    return `${hexColor}${a.toString(16).padStart(2, \"0\")}`;\n}\n\n/**\n * Convert hex color to RGBA string\n */\nexport function hexToRgba(hexColor: string, alpha: number = 1): string {\n    const rgb = hexToRgb(hexColor);\n    if (!rgb) return `rgba(0, 0, 0, ${alpha})`;\n\n    return `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${alpha})`;\n}\n\n/**\n * Generate a random hex color\n */\nexport function randomColor(): string {\n    return \"#\" + Math.floor(Math.random() * 16777215).toString(16).padStart(6, \"0\");\n}\n\n/**\n * Check if a color is light\n */\nexport function isLightColor(hexColor: string): boolean {\n    const rgb = hexToRgb(hexColor);\n    if (!rgb) return false;\n\n    const luminance = (0.299 * rgb.r + 0.587 * rgb.g + 0.114 * rgb.b) / 255;\n    return luminance > 0.5;\n}\n\n/**\n * Check if a color is dark\n */\nexport function isDarkColor(hexColor: string): boolean {\n    return !isLightColor(hexColor);\n}\n\n/**\n * Mix two colors\n */\nexport function mixColors(color1: string, color2: string, weight: number = 0.5): string {\n    const rgb1 = hexToRgb(color1);\n    const rgb2 = hexToRgb(color2);\n\n    if (!rgb1 || !rgb2) return color1;\n\n    const w = Math.max(0, Math.min(1, weight));\n    const r = Math.round(rgb1.r * (1 - w) + rgb2.r * w);\n    const g = Math.round(rgb1.g * (1 - w) + rgb2.g * w);\n    const b = Math.round(rgb1.b * (1 - w) + rgb2.b * w);\n\n    return rgbToHex(r, g, b);\n}\n\n/**\n * Generate a color palette from a base color\n */\nexport function generatePalette(baseColor: string): {\n    lighter: string;\n    light: string;\n    base: string;\n    dark: string;\n    darker: string;\n} {\n    return {\n        lighter: lightenColor(baseColor, 40),\n        light: lightenColor(baseColor, 20),\n        base: baseColor,\n        dark: darkenColor(baseColor, 20),\n        darker: darkenColor(baseColor, 40),\n    };\n}\n\n/**\n * Get color with opacity for backgrounds\n */\nexport function getColorWithOpacity(hexColor: string, opacity: number = 0.1): string {\n    return hexToRgba(hexColor, opacity);\n}\n","/**\n * Task validation schemas\n * Shared across all applications for consistent task validation\n */\n\nimport { z } from \"zod\";\nimport { TASK_LIMITS } from \"../constants/limits.constants\";\nimport { PRIORITY_VALUES } from \"../constants/priorities.constants\";\nimport { TASK_STATUS_VALUES } from \"../constants/status.constants\";\n\n/**\n * Base task schema\n */\nexport const taskBaseSchema = z.object({\n    title: z\n        .string()\n        .min(TASK_LIMITS.TITLE_MIN_LENGTH, \"Title is required\")\n        .max(TASK_LIMITS.TITLE_MAX_LENGTH, `Title must be less than ${TASK_LIMITS.TITLE_MAX_LENGTH} characters`),\n    description: z\n        .string()\n        .max(TASK_LIMITS.DESCRIPTION_MAX_LENGTH, `Description must be less than ${TASK_LIMITS.DESCRIPTION_MAX_LENGTH} characters`)\n        .optional(),\n    priority: z.enum(PRIORITY_VALUES),\n    status: z.enum(TASK_STATUS_VALUES).optional(),\n    dueDate: z.string().optional().nullable(),\n    startDate: z.string().optional().nullable(),\n    scheduledDate: z.string().optional().nullable(),\n    scheduledTime: z.string().regex(/^\\d{2}:\\d{2}$/, \"Time must be in HH:mm format\").optional().nullable(),\n    isTimeBlocked: z.boolean().optional(),\n    estimatedMinutes: z\n        .union([\n            z.number()\n                .int()\n                .min(TASK_LIMITS.MIN_ESTIMATED_MINUTES)\n                .max(TASK_LIMITS.MAX_ESTIMATED_MINUTES),\n            z.nan(),\n        ])\n        .optional()\n        .nullable()\n        .transform((val) => (Number.isNaN(val) ? undefined : val)),\n});\n\n/**\n * Validation for date relationships\n */\nexport const taskDatesSchema = taskBaseSchema.refine(\n    (data) => {\n        if (data.startDate && data.dueDate) {\n            return new Date(data.startDate) <= new Date(data.dueDate);\n        }\n        return true;\n    },\n    { message: \"Start date must be before or equal to due date\", path: [\"startDate\"] }\n).refine(\n    (data) => {\n        if (data.scheduledDate && data.dueDate) {\n            return new Date(data.scheduledDate) <= new Date(data.dueDate);\n        }\n        return true;\n    },\n    { message: \"Scheduled date must be before or equal to due date\", path: [\"scheduledDate\"] }\n);\n\n/**\n * Create task schema\n */\nexport const createTaskSchema = taskBaseSchema.extend({\n    projectId: z.string().min(1, \"Project is required\"),\n    parentTaskId: z.string().optional().nullable(),\n    assigneeId: z.string().optional().nullable(),\n    tagIds: z.array(z.string()).max(TASK_LIMITS.MAX_TAGS_PER_TASK).optional(),\n});\n\n/**\n * Update task schema (all fields optional except what's being updated)\n */\nexport const updateTaskSchema = taskBaseSchema.partial().extend({\n    assigneeId: z.string().optional().nullable(),\n    tagIds: z.array(z.string()).max(TASK_LIMITS.MAX_TAGS_PER_TASK).optional(),\n    completedAt: z.string().datetime().optional().nullable(),\n});\n\n/**\n * Task filter schema\n */\nexport const taskFilterSchema = z.object({\n    projectId: z.string().optional(),\n    status: z.enum(TASK_STATUS_VALUES).optional(),\n    priority: z.enum(PRIORITY_VALUES).optional(),\n    assigneeId: z.string().optional(),\n    tagIds: z.array(z.string()).optional(),\n    search: z.string().optional(),\n    dueDate: z.object({\n        from: z.string().datetime().optional(),\n        to: z.string().datetime().optional(),\n    }).optional(),\n    isOverdue: z.boolean().optional(),\n});\n\n/**\n * Bulk update tasks schema\n */\nexport const bulkUpdateTasksSchema = z.object({\n    taskIds: z.array(z.string()).min(1, \"At least one task is required\"),\n    updates: z.object({\n        status: z.enum(TASK_STATUS_VALUES).optional(),\n        priority: z.enum(PRIORITY_VALUES).optional(),\n        assigneeId: z.string().optional().nullable(),\n        projectId: z.string().optional(),\n    }),\n});\n\n/**\n * Reorder tasks schema\n */\nexport const reorderTasksSchema = z.object({\n    taskId: z.string(),\n    newOrder: z.number().int().min(0),\n    projectId: z.string(),\n});\n\n/**\n * Type exports\n */\nexport type TaskBase = z.infer<typeof taskBaseSchema>;\nexport type CreateTaskDTO = z.infer<typeof createTaskSchema>;\nexport type UpdateTaskDTO = z.infer<typeof updateTaskSchema>;\nexport type TaskFilter = z.infer<typeof taskFilterSchema>;\nexport type BulkUpdateTasks = z.infer<typeof bulkUpdateTasksSchema>;\nexport type ReorderTasks = z.infer<typeof reorderTasksSchema>;\n","/**\n * Project validation schemas\n * Shared across all applications for consistent project validation\n */\n\nimport { z } from \"zod\";\nimport { PROJECT_LIMITS } from \"../constants/limits.constants\";\nimport { PROJECT_COLORS } from \"../constants/colors.constants\";\n\n/**\n * Base project schema\n */\nexport const projectBaseSchema = z.object({\n    name: z\n        .string()\n        .min(PROJECT_LIMITS.NAME_MIN_LENGTH, \"Project name is required\")\n        .max(PROJECT_LIMITS.NAME_MAX_LENGTH, `Project name must be less than ${PROJECT_LIMITS.NAME_MAX_LENGTH} characters`),\n    description: z\n        .string()\n        .max(PROJECT_LIMITS.DESCRIPTION_MAX_LENGTH, `Description must be less than ${PROJECT_LIMITS.DESCRIPTION_MAX_LENGTH} characters`)\n        .optional(),\n    color: z.string().optional(),\n    icon: z.string().optional(),\n});\n\n/**\n * Create project schema\n */\nexport const createProjectSchema = projectBaseSchema.extend({\n    workspaceId: z.string().min(1, \"Workspace is required\"),\n    workflowId: z.string().optional(),\n    startDate: z.string().datetime().optional().nullable(),\n    endDate: z.string().datetime().optional().nullable(),\n});\n\n/**\n * Update project schema\n */\nexport const updateProjectSchema = projectBaseSchema.partial().extend({\n    startDate: z.string().datetime().optional().nullable(),\n    endDate: z.string().datetime().optional().nullable(),\n    isArchived: z.boolean().optional(),\n});\n\n/**\n * Project filter schema\n */\nexport const projectFilterSchema = z.object({\n    workspaceId: z.string().optional(),\n    search: z.string().optional(),\n    isArchived: z.boolean().optional(),\n    color: z.string().optional(),\n});\n\n/**\n * Archive project schema\n */\nexport const archiveProjectSchema = z.object({\n    isArchived: z.boolean(),\n});\n\n/**\n * Duplicate project schema\n */\nexport const duplicateProjectSchema = z.object({\n    name: z.string().min(PROJECT_LIMITS.NAME_MIN_LENGTH),\n    includeTasks: z.boolean().default(false),\n    includeMembers: z.boolean().default(false),\n});\n\n/**\n * Type exports\n */\nexport type ProjectBase = z.infer<typeof projectBaseSchema>;\nexport type CreateProjectDTO = z.infer<typeof createProjectSchema>;\nexport type UpdateProjectDTO = z.infer<typeof updateProjectSchema>;\nexport type ProjectFilter = z.infer<typeof projectFilterSchema>;\nexport type ArchiveProject = z.infer<typeof archiveProjectSchema>;\nexport type DuplicateProject = z.infer<typeof duplicateProjectSchema>;\n","/**\n * Workspace validation schemas\n * Shared across all applications for consistent workspace validation\n */\n\nimport { z } from \"zod\";\nimport { WORKSPACE_LIMITS } from \"../constants/limits.constants\";\n\n/**\n * Workspace type enum\n */\nexport const WORKSPACE_TYPES = [\"PERSONAL\", \"WORK\", \"TEAM\"] as const;\n\n/**\n * Member role enum\n */\nexport const MEMBER_ROLES = [\"OWNER\", \"ADMIN\", \"MEMBER\", \"VIEWER\"] as const;\n\n/**\n * Base workspace schema\n */\nexport const workspaceBaseSchema = z.object({\n  name: z\n    .string()\n    .min(WORKSPACE_LIMITS.NAME_MIN_LENGTH, \"Workspace name is required\")\n    .max(\n      WORKSPACE_LIMITS.NAME_MAX_LENGTH,\n      `Workspace name must be less than ${WORKSPACE_LIMITS.NAME_MAX_LENGTH} characters`,\n    ),\n  slug: z\n    .string()\n    .min(1, \"Slug must be at least 1 character\")\n    .regex(\n      /^[a-z0-9-]+$/,\n      \"Slug must only contain lowercase letters, numbers, and hyphens\",\n    )\n    .optional(),\n  description: z\n    .string()\n    .max(\n      WORKSPACE_LIMITS.DESCRIPTION_MAX_LENGTH,\n      `Description must be less than ${WORKSPACE_LIMITS.DESCRIPTION_MAX_LENGTH} characters`,\n    )\n    .optional(),\n  type: z.enum(WORKSPACE_TYPES),\n  color: z.string().optional(),\n  icon: z.string().optional(),\n});\n\n/**\n * Create workspace schema\n */\nexport const createWorkspaceSchema = workspaceBaseSchema;\n\n/**\n * Update workspace schema\n */\nexport const updateWorkspaceSchema = workspaceBaseSchema.partial();\n\n/**\n * Workspace settings schema\n */\nexport const workspaceSettingsSchema = z.object({\n  defaultTaskPriority: z.enum([\"LOW\", \"MEDIUM\", \"HIGH\"]).optional(),\n  defaultTaskStatus: z\n    .enum([\"TODO\", \"IN_PROGRESS\", \"IN_REVIEW\", \"DONE\", \"CANCELLED\"])\n    .optional(),\n  enableNotifications: z.boolean().optional(),\n  enableEmailDigest: z.boolean().optional(),\n  timezone: z.string().optional(),\n});\n\n/**\n * Invite member schema\n */\nexport const inviteMemberSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  role: z.enum(MEMBER_ROLES),\n  message: z.string().max(500).optional(),\n});\n\n/**\n * Update member role schema\n */\nexport const updateMemberRoleSchema = z.object({\n  role: z.enum(MEMBER_ROLES),\n});\n\n/**\n * Accept invitation schema\n */\nexport const acceptInvitationSchema = z.object({\n  token: z.string().min(1, \"Invitation token is required\"),\n});\n\n/**\n * Transfer ownership schema\n */\nexport const transferOwnershipSchema = z.object({\n  newOwnerId: z.string().min(1, \"New owner is required\"),\n});\n\n/**\n * Workspace filter schema\n */\nexport const workspaceFilterSchema = z.object({\n  type: z.enum(WORKSPACE_TYPES).optional(),\n  search: z.string().optional(),\n});\n\n/**\n * Type exports\n * Note: WorkspaceType is defined in workspaces domain, so we use WorkspaceTypeValue here\n */\nexport type WorkspaceTypeValue = (typeof WORKSPACE_TYPES)[number];\nexport type MemberRoleValue = (typeof MEMBER_ROLES)[number];\nexport type WorkspaceBase = z.infer<typeof workspaceBaseSchema>;\nexport type CreateWorkspaceDTO = z.infer<typeof createWorkspaceSchema>;\nexport type UpdateWorkspaceDTO = z.infer<typeof updateWorkspaceSchema>;\nexport type WorkspaceSettingsDTO = z.infer<typeof workspaceSettingsSchema>;\nexport type InviteMemberDTO = z.infer<typeof inviteMemberSchema>;\nexport type UpdateMemberRole = z.infer<typeof updateMemberRoleSchema>;\nexport type AcceptInvitation = z.infer<typeof acceptInvitationSchema>;\nexport type TransferOwnership = z.infer<typeof transferOwnershipSchema>;\nexport type WorkspaceFilter = z.infer<typeof workspaceFilterSchema>;\n","/**\n * Tag validation schemas\n * Shared across all applications for consistent tag validation\n */\n\nimport { z } from \"zod\";\nimport { TAG_LIMITS } from \"../constants/limits.constants\";\n\n/**\n * Base tag schema\n */\nexport const tagBaseSchema = z.object({\n    name: z\n        .string()\n        .min(TAG_LIMITS.NAME_MIN_LENGTH, \"Tag name is required\")\n        .max(TAG_LIMITS.NAME_MAX_LENGTH, `Tag name must be less than ${TAG_LIMITS.NAME_MAX_LENGTH} characters`),\n    color: z.string().optional(),\n});\n\n/**\n * Create tag schema\n */\nexport const createTagSchema = tagBaseSchema.extend({\n    workspaceId: z.string().min(1, \"Workspace is required\"),\n});\n\n/**\n * Update tag schema\n */\nexport const updateTagSchema = tagBaseSchema.partial();\n\n/**\n * Tag filter schema\n */\nexport const tagFilterSchema = z.object({\n    workspaceId: z.string().optional(),\n    search: z.string().optional(),\n});\n\n/**\n * Assign tags to task schema\n */\nexport const assignTagsSchema = z.object({\n    tagIds: z.array(z.string()).max(TAG_LIMITS.NAME_MAX_LENGTH),\n});\n\n/**\n * Type exports\n */\nexport type TagBase = z.infer<typeof tagBaseSchema>;\nexport type CreateTagDTO = z.infer<typeof createTagSchema>;\nexport type UpdateTagDTO = z.infer<typeof updateTagSchema>;\nexport type TagFilter = z.infer<typeof tagFilterSchema>;\nexport type AssignTags = z.infer<typeof assignTagsSchema>;\n","/**\n * User validation schemas\n * Shared across all applications for consistent user validation\n */\n\nimport { z } from \"zod\";\nimport { USER_LIMITS } from \"../constants/limits.constants\";\n\n/**\n * User registration schema\n */\nexport const registerUserSchema = z.object({\n    name: z\n        .string()\n        .min(USER_LIMITS.NAME_MIN_LENGTH, `Name must be at least ${USER_LIMITS.NAME_MIN_LENGTH} characters`)\n        .max(USER_LIMITS.NAME_MAX_LENGTH, `Name must be less than ${USER_LIMITS.NAME_MAX_LENGTH} characters`),\n    username: z\n        .string()\n        .min(3, \"Username must be at least 3 characters\")\n        .max(20, \"Username must be less than 20 characters\")\n        .regex(/^[a-z0-9_-]+$/, \"Username can only contain lowercase letters, numbers, hyphens, and underscores\"),\n    email: z.string().email(\"Invalid email address\"),\n    password: z\n        .string()\n        .min(USER_LIMITS.PASSWORD_MIN_LENGTH, `Password must be at least ${USER_LIMITS.PASSWORD_MIN_LENGTH} characters`)\n        .max(USER_LIMITS.PASSWORD_MAX_LENGTH, `Password must be less than ${USER_LIMITS.PASSWORD_MAX_LENGTH} characters`),\n});\n\n/**\n * User login schema\n */\nexport const loginUserSchema = z.object({\n    email: z.string().email(\"Invalid email address\"),\n    password: z.string().min(1, \"Password is required\"),\n});\n\n/**\n * Update user profile schema\n */\nexport const updateUserProfileSchema = z.object({\n    name: z\n        .string()\n        .min(USER_LIMITS.NAME_MIN_LENGTH)\n        .max(USER_LIMITS.NAME_MAX_LENGTH)\n        .optional(),\n    bio: z.string().max(USER_LIMITS.BIO_MAX_LENGTH).optional(),\n    avatar: z.string().url().optional().nullable(),\n    timezone: z.string().optional(),\n    language: z.enum([\"en\", \"es\", \"pt-BR\"]).optional(),\n});\n\n/**\n * Change password schema\n */\nexport const changePasswordSchema = z.object({\n    currentPassword: z.string().min(1, \"Current password is required\"),\n    newPassword: z\n        .string()\n        .min(USER_LIMITS.PASSWORD_MIN_LENGTH, `Password must be at least ${USER_LIMITS.PASSWORD_MIN_LENGTH} characters`)\n        .max(USER_LIMITS.PASSWORD_MAX_LENGTH),\n});\n\n/**\n * Reset password request schema\n */\nexport const resetPasswordRequestSchema = z.object({\n    email: z.string().email(\"Invalid email address\"),\n});\n\n/**\n * Reset password schema\n */\nexport const resetPasswordSchema = z.object({\n    token: z.string().min(1, \"Reset token is required\"),\n    newPassword: z\n        .string()\n        .min(USER_LIMITS.PASSWORD_MIN_LENGTH, `Password must be at least ${USER_LIMITS.PASSWORD_MIN_LENGTH} characters`)\n        .max(USER_LIMITS.PASSWORD_MAX_LENGTH),\n});\n\n/**\n * User preferences schema\n */\nexport const userPreferencesSchema = z.object({\n    theme: z.enum([\"light\", \"dark\", \"system\"]).optional(),\n    language: z.enum([\"en\", \"es\", \"pt-BR\"]).optional(),\n    timezone: z.string().optional(),\n    notifications: z.object({\n        email: z.boolean().optional(),\n        push: z.boolean().optional(),\n        desktop: z.boolean().optional(),\n    }).optional(),\n    pomodoro: z.object({\n        workDuration: z.number().int().min(1).max(120).optional(),\n        shortBreakDuration: z.number().int().min(1).max(30).optional(),\n        longBreakDuration: z.number().int().min(1).max(60).optional(),\n        pomodorosUntilLongBreak: z.number().int().min(2).max(10).optional(),\n        autoStartBreaks: z.boolean().optional(),\n        autoStartPomodoros: z.boolean().optional(),\n        soundEnabled: z.boolean().optional(),\n    }).optional(),\n});\n\n/**\n * Type exports\n */\nexport type RegisterUserDTO = z.infer<typeof registerUserSchema>;\nexport type LoginUserDTO = z.infer<typeof loginUserSchema>;\nexport type UpdateUserProfile = z.infer<typeof updateUserProfileSchema>;\nexport type ChangePassword = z.infer<typeof changePasswordSchema>;\nexport type ResetPasswordRequest = z.infer<typeof resetPasswordRequestSchema>;\nexport type ResetPassword = z.infer<typeof resetPasswordSchema>;\n/**\n * Username validation schema\n */\nexport const usernameValidationSchema = z.object({\n    username: z\n        .string()\n        .min(3, \"Username must be at least 3 characters\")\n        .max(20, \"Username must be less than 20 characters\")\n        .regex(/^[a-z0-9_-]+$/, \"Username can only contain lowercase letters, numbers, hyphens, and underscores\"),\n});\n\nexport type UserPreferences = z.infer<typeof userPreferencesSchema>;\nexport type UsernameValidation = z.infer<typeof usernameValidationSchema>;\n","/**\n * Comment validation schemas\n * Shared across all applications for consistent comment validation\n */\n\nimport { z } from \"zod\";\nimport { COMMENT_LIMITS } from \"../constants/limits.constants\";\n\n/**\n * Base comment schema\n */\nexport const commentBaseSchema = z.object({\n    content: z\n        .string()\n        .min(COMMENT_LIMITS.CONTENT_MIN_LENGTH, \"Comment cannot be empty\")\n        .max(COMMENT_LIMITS.CONTENT_MAX_LENGTH, `Comment must be less than ${COMMENT_LIMITS.CONTENT_MAX_LENGTH} characters`),\n});\n\n/**\n * Create comment schema\n */\nexport const createCommentSchema = commentBaseSchema.extend({\n    taskId: z.string().min(1, \"Task is required\"),\n    parentCommentId: z.string().optional().nullable(), // For threaded comments\n    mentions: z.array(z.string()).optional(), // User IDs mentioned in comment\n});\n\n/**\n * Update comment schema\n */\nexport const updateCommentSchema = commentBaseSchema;\n\n/**\n * Comment filter schema\n */\nexport const commentFilterSchema = z.object({\n    taskId: z.string().optional(),\n    userId: z.string().optional(),\n    parentCommentId: z.string().optional().nullable(),\n});\n\n/**\n * Type exports\n */\nexport type CommentBase = z.infer<typeof commentBaseSchema>;\nexport type CreateCommentDTO = z.infer<typeof createCommentSchema>;\nexport type UpdateCommentDTO = z.infer<typeof updateCommentSchema>;\nexport type CommentFilter = z.infer<typeof commentFilterSchema>;\n","import { PersonName } from \"../../shared/person-name.vo\";\nimport { Email, HashPassword, Id } from \"../../shared\";\nimport { Entity, EntityMode, EntityProps } from \"../../shared/entity\";\n\nexport interface UserProps extends EntityProps<string> {\n  name?: string;\n  username: string;\n  email?: string;\n  password?: string;\n  image?: string | null;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\nexport class User extends Entity<UserProps> {\n  public readonly name: string;\n  public readonly username: string;\n  public readonly email: string;\n  public readonly password?: string;\n\n  constructor(props: UserProps, mode: EntityMode = \"valid\") {\n    super(props);\n    this.name =\n      mode === \"draft\"\n        ? (props?.name ?? \"\")\n        : PersonName.create(props?.name ?? \"\").value;\n    this.username = props.username;\n    this.email =\n      mode === \"draft\"\n        ? (props?.email ?? \"\")\n        : Email.create(props?.email ?? \"\").value;\n    this.password = props?.password\n      ? HashPassword.create(props.password).value\n      : undefined;\n  }\n\n  withoutPassword(): User {\n    return this.clone({ password: undefined });\n  }\n\n  static draft(props: UserProps = { username: \"\" }) {\n    return new User(props, \"draft\");\n  }\n\n  get $name(): PersonName {\n    return PersonName.create(this.name);\n  }\n\n  get $email(): Email {\n    return Email.create(this.email);\n  }\n\n  get $password(): HashPassword | undefined {\n    return this.password ? HashPassword.create(this.password) : undefined;\n  }\n}\n","import { User } from \"../model/user.entity\";\nimport { UseCase, LoggedUser } from \"../../shared/use-case\";\nimport UserRepository from \"../provider/user.repository\";\nimport { PersonName } from \"../../shared\";\n\nexport default class ChangeUserName implements UseCase<string, void> {\n  constructor(private readonly repo: UserRepository) {}\n\n  async execute(newName: string, loggedUser?: LoggedUser): Promise<void> {\n    if (!loggedUser) {\n      throw new Error(\"User is required\");\n    }\n\n    const validName = PersonName.create(newName).value;\n\n    const existingUser = await this.repo.findByEmail(loggedUser.email);\n    if (!existingUser) {\n      throw new Error(\"Usuário não encontrado\");\n    }\n\n    await this.repo.updateProps(existingUser, { name: validName });\n  }\n}\n","import { User } from \"../model/user.entity\";\nimport CryptoProvider from \"../provider/crypto.provider\";\nimport { UseCase } from \"../../shared/use-case\";\nimport UserRepository from \"../provider/user.repository\";\n\ntype Input = {\n  name: string;\n  username: string;\n  email: string;\n  password: string;\n};\n\nexport default class RegisterUser implements UseCase<Input, void> {\n  constructor(\n    private readonly repo: UserRepository,\n    private readonly crypto: CryptoProvider\n  ) { }\n\n  async execute(user: Input): Promise<void> {\n    const existingUser = await this.repo.findByEmail(user.email);\n\n    if (existingUser) {\n      throw new Error(\"Usuário já existe\");\n    }\n\n    // Check if username is already taken\n    const existingUsername = await this.repo.findByUsername(user.username);\n    if (existingUsername) {\n      throw new Error(\"Nome de usuário já está em uso\");\n    }\n\n    if (!user.password) {\n      throw new Error(\"Senha é obrigatória\");\n    }\n\n    if (!user.username || user.username.length < 3) {\n      throw new Error(\"Nome de usuário deve ter pelo menos 3 caracteres\");\n    }\n\n    if (user.name?.length < 3) {\n      throw new Error(\"Nome deve ter pelo menos 3 caracteres\");\n    }\n\n    const hashedPassword = await this.crypto.encrypt(user.password!);\n    const newUser = new User({\n      name: user.name,\n      username: user.username,\n      email: user.email,\n      password: hashedPassword,\n    });\n    await this.repo.save(newUser);\n  }\n}\n","import { User } from \"../model/user.entity\";\nimport { UseCase } from \"../../shared/use-case\";\nimport UserRepository from \"../provider/user.repository\";\n\nexport default class UserByEmail implements UseCase<string, User> {\n  constructor(private readonly repo: UserRepository) { }\n\n  async execute(email: string): Promise<User> {\n    const user = await this.repo.findByEmail(email?.toLowerCase?.());\n    if (!user) throw new Error(\"Usuário não encontrado\");\n    return user.withoutPassword();\n  }\n}\n","import { User } from \"../model/user.entity\";\nimport CryptoProvider from \"../provider/crypto.provider\";\nimport { UseCase } from \"../../shared/use-case\";\nimport UserRepository from \"../provider/user.repository\";\n\ntype Input = {\n  email: string;\n  password: string;\n};\n\nexport default class UserLogin implements UseCase<Input, User> {\n  constructor(\n    private readonly repo: UserRepository,\n    private readonly crypto: CryptoProvider\n  ) { }\n\n  async execute(input: Input): Promise<User> {\n    const { email, password } = input;\n\n    const withPassword = true;\n    const user = await this.repo.findByEmail(email, withPassword);\n    if (!user) throw new Error(\"Usuário não encontrado\");\n\n    const samePassword = await this.crypto.compare(password, user.password!);\n    if (!samePassword) throw new Error(\"Senha incorreta\");\n\n    return user.withoutPassword();\n  }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\nimport type { TagProps } from \"../../tags/model/tag.entity\";\n\nexport type TaskStatus = \"TODO\" | \"IN_PROGRESS\" | \"COMPLETED\" | \"CANCELLED\";\nexport type TaskPriority = \"LOW\" | \"MEDIUM\" | \"HIGH\" | \"URGENT\";\n\nexport interface TaskProps extends EntityProps {\n  title: string;\n  description?: string;\n  status: TaskStatus;\n  priority: TaskPriority;\n  dueDate?: Date;\n  startDate?: Date; // When task can be started\n  scheduledDate?: Date; // When task is scheduled to be worked on\n  scheduledTime?: string; // Time of day scheduled (e.g., \"14:30\")\n  scheduledEndTime?: string; // End time of day (e.g., \"15:30\")\n  isTimeBlocked?: boolean; // Whether task is time blocked in calendar\n  completedAt?: Date;\n  projectId: string;\n  ownerId: string;\n  assigneeId?: string | null;\n  parentTaskId?: string;\n  subTasks?: Task[];\n  estimatedTime?: number;\n  tags?: TagProps[];\n  project?: { id: string; name: string; color: string }; // Project information for display\n  assignee?: { id: string; name: string; image?: string }; // Assignee information for display\n  owner?: { id: string; name: string; image?: string }; // Owner information for display\n  isDeleted: boolean;\n  deletedAt?: Date;\n  createdAt?: Date;\n  updatedAt?: Date;\n  recurrence?: RecurrenceProps;\n}\n\nexport interface RecurrenceProps {\n  pattern: \"DAILY\" | \"WEEKLY\" | \"MONTHLY\" | \"YEARLY\" | \"CUSTOM\";\n  interval?: number;\n  daysOfWeek?: number[];\n  dayOfMonth?: number;\n  endDate?: Date;\n}\n\nexport class Task extends Entity<TaskProps> {\n  constructor(props: TaskProps) {\n    super({\n      ...props,\n      status: props.status ?? \"TODO\",\n      priority: props.priority ?? \"MEDIUM\",\n      subTasks: props.subTasks ?? [],\n      isDeleted: props.isDeleted ?? false,\n      createdAt: props.createdAt ?? new Date(),\n      updatedAt: props.updatedAt ?? new Date(),\n    });\n  }\n\n  static create(\n    props: Omit<\n      TaskProps,\n      \"id\" | \"createdAt\" | \"updatedAt\" | \"status\" | \"isDeleted\" | \"deletedAt\"\n    >,\n  ): Task {\n    return new Task({\n      ...props,\n      status: \"TODO\",\n      priority: props.priority ?? \"MEDIUM\",\n      isDeleted: false,\n      deletedAt: undefined,\n    });\n  }\n\n  complete(): Task {\n    return this.clone({\n      status: \"COMPLETED\",\n      updatedAt: new Date(),\n    });\n  }\n\n  updateStatus(status: TaskStatus): Task {\n    return this.clone({\n      status,\n      updatedAt: new Date(),\n    });\n  }\n\n  update(\n    props: Partial<Omit<TaskProps, \"id\" | \"ownerId\" | \"createdAt\">>,\n  ): Task {\n    return this.clone({\n      ...props,\n      updatedAt: new Date(),\n    });\n  }\n\n  softDelete(): Task {\n    return this.clone({\n      isDeleted: true,\n      deletedAt: new Date(),\n      updatedAt: new Date(),\n    });\n  }\n\n  restore(): Task {\n    return this.clone({\n      isDeleted: false,\n      deletedAt: undefined,\n      updatedAt: new Date(),\n    });\n  }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { Task, TaskPriority, RecurrenceProps } from \"../model/task.entity\";\nimport { TaskRepository } from \"../provider/task.repository\";\n\nexport interface CreateTaskInput {\n    title: string;\n    description?: string;\n    priority?: TaskPriority;\n    dueDate?: Date;\n    projectId: string;\n    ownerId: string;\n    assigneeId?: string;\n    parentTaskId?: string;\n    recurrence?: RecurrenceProps;\n}\n\nexport class CreateTaskUseCase implements UseCase<CreateTaskInput, Task> {\n    constructor(private readonly repository: TaskRepository) { }\n\n    async execute(input: CreateTaskInput): Promise<Task> {\n        if (!input.title) {\n            throw new Error(\"Title is required\");\n        }\n\n        const task = Task.create({\n            title: input.title,\n            description: input.description,\n            priority: input.priority ?? \"MEDIUM\",\n            dueDate: input.dueDate,\n            projectId: input.projectId,\n            ownerId: input.ownerId,\n            assigneeId: input.assigneeId,\n            parentTaskId: input.parentTaskId,\n            recurrence: input.recurrence,\n        });\n\n        await this.repository.save(task);\n\n        return task;\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { Task } from \"../model/task.entity\";\nimport { TaskRepository } from \"../provider/task.repository\";\n\nexport interface CompleteTaskInput {\n    taskId: string;\n    ownerId: string;\n}\n\nexport class CompleteTaskUseCase implements UseCase<CompleteTaskInput, Task> {\n    constructor(private readonly repository: TaskRepository) { }\n\n    async execute(input: CompleteTaskInput): Promise<Task> {\n        const task = await this.repository.findById(input.taskId);\n\n        if (!task) {\n            throw new Error(\"Task not found\");\n        }\n\n        if (task.props.ownerId !== input.ownerId) {\n            throw new Error(\"Unauthorized\");\n        }\n\n        const completedTask = task.complete();\n        await this.repository.update(completedTask);\n\n        return completedTask;\n    }\n}\n","import { TaskRepository } from \"../provider/task.repository\";\n\nexport class SoftDeleteTaskUseCase {\n  constructor(private taskRepository: TaskRepository) {}\n\n  async execute(id: string): Promise<void> {\n    const task = await this.taskRepository.findById(id);\n    if (!task) {\n      throw new Error(\"Task not found\");\n    }\n\n    await this.taskRepository.softDelete(id);\n  }\n}\n","import { TaskRepository } from \"../provider/task.repository\";\n\nexport class RestoreTaskUseCase {\n  constructor(private taskRepository: TaskRepository) {}\n\n  async execute(id: string): Promise<void> {\n    const task = await this.taskRepository.findById(id);\n    if (!task) {\n      throw new Error(\"Task not found\");\n    }\n\n    if (!task.props.isDeleted) {\n      throw new Error(\"Task is not deleted\");\n    }\n\n    await this.taskRepository.restore(id);\n  }\n}\n","import { TaskRepository } from \"../provider/task.repository\";\n\nexport class PermanentDeleteTaskUseCase {\n  constructor(private taskRepository: TaskRepository) {}\n\n  async execute(id: string): Promise<void> {\n    const task = await this.taskRepository.findById(id);\n    if (!task) {\n      throw new Error(\"Task not found\");\n    }\n\n    if (!task.props.isDeleted) {\n      throw new Error(\"Task must be soft deleted first\");\n    }\n\n    await this.taskRepository.permanentDelete(id);\n  }\n}\n","import { TaskRepository } from \"../provider/task.repository\";\nimport { Task } from \"../model/task.entity\";\n\nexport class GetDeletedTasksUseCase {\n  constructor(private taskRepository: TaskRepository) {}\n\n  async execute(projectId: string): Promise<Task[]> {\n    const tasks = await this.taskRepository.findDeleted(projectId);\n    return tasks;\n  }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type WorkspaceType = \"PERSONAL\" | \"WORK\" | \"TEAM\";\nexport type WorkspaceTier = \"FREE\" | \"PRO\" | \"ENTERPRISE\";\n\nexport interface WorkspaceProps extends EntityProps {\n    name: string;\n    slug: string;\n    description?: string;\n    type: WorkspaceType;\n    tier: WorkspaceTier;\n    color: string;\n    icon?: string;\n    ownerId?: string;\n\n    // Lifecycle\n    isArchived: boolean;\n    isDeleted: boolean;\n    deletedAt?: Date;\n\n    createdAt?: Date;\n    updatedAt?: Date;\n\n    // Stats (Read-only)\n    stats?: {\n        projectCount: number;\n        taskCount: number;\n        memberCount: number;\n    };\n}\n\nexport class Workspace extends Entity<WorkspaceProps> {\n    constructor(props: WorkspaceProps) {\n        super({\n            ...props,\n            tier: props.tier ?? \"FREE\",\n            isArchived: props.isArchived ?? false,\n            isDeleted: props.isDeleted ?? false,\n            color: props.color ?? \"#2563EB\",\n            createdAt: props.createdAt ?? new Date(),\n            updatedAt: props.updatedAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<WorkspaceProps, \"id\" | \"createdAt\" | \"updatedAt\" | \"isArchived\" | \"isDeleted\" | \"deletedAt\">): Workspace {\n        return new Workspace({\n            ...props,\n            tier: props.tier ?? \"FREE\",\n            isArchived: false,\n            isDeleted: false,\n            color: props.color ?? \"#2563EB\",\n        });\n    }\n\n    update(props: Partial<Omit<WorkspaceProps, \"id\" | \"ownerId\" | \"createdAt\">>): Workspace {\n        return this.clone({\n            ...props,\n            updatedAt: new Date(),\n        });\n    }\n\n    softDelete(): Workspace {\n        return this.clone({\n            isDeleted: true,\n            deletedAt: new Date(),\n            updatedAt: new Date(),\n        });\n    }\n\n    restore(): Workspace {\n        return this.clone({\n            isDeleted: false,\n            deletedAt: undefined,\n            updatedAt: new Date(),\n        });\n    }\n\n    archive(): Workspace {\n        return this.clone({\n            isArchived: true,\n            updatedAt: new Date(),\n        });\n    }\n\n    unarchive(): Workspace {\n        return this.clone({\n            isArchived: false,\n            updatedAt: new Date(),\n        });\n    }\n\n    setStats(stats: { projectCount: number; taskCount: number; memberCount: number }): Workspace {\n        return this.clone({\n            stats,\n        });\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type MemberRole = \"OWNER\" | \"ADMIN\" | \"MEMBER\" | \"VIEWER\";\n\nexport interface WorkspaceMemberProps extends EntityProps {\n    workspaceId: string;\n    userId: string;\n    role: MemberRole;\n    joinedAt: Date;\n}\n\nexport class WorkspaceMember extends Entity<WorkspaceMemberProps> {\n    constructor(props: WorkspaceMemberProps) {\n        super({\n            ...props,\n            joinedAt: props.joinedAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<WorkspaceMemberProps, \"id\" | \"joinedAt\">): WorkspaceMember {\n        return new WorkspaceMember({\n            ...props,\n            joinedAt: new Date(),\n        });\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type ViewType = \"LIST\" | \"KANBAN\" | \"CALENDAR\" | \"TIMELINE\" | \"FOCUS\";\n\nexport interface WorkspaceSettingsProps extends EntityProps {\n    workspaceId: string;\n    defaultView?: ViewType;\n    defaultDueTime?: number; // minutos desde inicio del día (ej. 540 = 9:00 AM)\n    timezone?: string; // ej. \"America/Mexico_City\"\n    locale?: string; // ej. \"es-MX\"\n    createdAt?: Date;\n    updatedAt?: Date;\n}\n\nexport class WorkspaceSettings extends Entity<WorkspaceSettingsProps> {\n    constructor(props: WorkspaceSettingsProps) {\n        super({\n            ...props,\n            defaultView: props.defaultView ?? \"LIST\",\n            createdAt: props.createdAt ?? new Date(),\n            updatedAt: props.updatedAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<WorkspaceSettingsProps, \"id\" | \"createdAt\" | \"updatedAt\">): WorkspaceSettings {\n        return new WorkspaceSettings({\n            ...props,\n            defaultView: props.defaultView ?? \"LIST\",\n        });\n    }\n\n    update(props: Partial<Omit<WorkspaceSettingsProps, \"id\" | \"workspaceId\" | \"createdAt\">>): WorkspaceSettings {\n        return this.clone({\n            ...props,\n            updatedAt: new Date(),\n        });\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type AuditAction =\n    | \"WORKSPACE_CREATED\"\n    | \"WORKSPACE_UPDATED\"\n    | \"WORKSPACE_ARCHIVED\"\n    | \"WORKSPACE_UNARCHIVED\"\n    | \"WORKSPACE_DELETED\"\n    | \"MEMBER_INVITED\"\n    | \"MEMBER_JOINED\"\n    | \"MEMBER_REMOVED\"\n    | \"MEMBER_ROLE_CHANGED\"\n    | \"PROJECT_CREATED\"\n    | \"PROJECT_DELETED\"\n    | \"SETTINGS_UPDATED\";\n\nexport interface WorkspaceAuditLogProps extends EntityProps {\n    workspaceId: string;\n    actorId?: string; // Usuario que realizó la acción (puede ser null para acciones del sistema)\n    action: AuditAction;\n    payload?: Record<string, unknown>; // Detalles del cambio\n    createdAt?: Date;\n}\n\nexport class WorkspaceAuditLog extends Entity<WorkspaceAuditLogProps> {\n    constructor(props: WorkspaceAuditLogProps) {\n        super({\n            ...props,\n            createdAt: props.createdAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<WorkspaceAuditLogProps, \"id\" | \"createdAt\">): WorkspaceAuditLog {\n        return new WorkspaceAuditLog(props);\n    }\n}\n","import { Workspace, WorkspaceProps } from \"../model/workspace.entity\";\nimport { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class CreateWorkspaceUseCase {\n  constructor(\n    private workspaceRepository: WorkspaceRepository,\n    private ownerUsername?: string,\n  ) { }\n\n  async execute(\n    props: Omit<\n      WorkspaceProps,\n      | \"id\"\n      | \"slug\"\n      | \"createdAt\"\n      | \"updatedAt\"\n      | \"isArchived\"\n      | \"isDeleted\"\n      | \"deletedAt\"\n    >,\n    ownerUsername?: string,\n  ): Promise<Workspace> {\n    const username = ownerUsername || this.ownerUsername;\n    const workspaceNameSlug = this.generateSlug(props.name);\n\n    const slug = workspaceNameSlug;\n\n    let finalSlug = slug;\n    let counter = 1;\n\n    // Check for slug uniqueness within the owner's context\n    if (props.ownerId) {\n      while (await this.workspaceRepository.findBySlug(finalSlug, props.ownerId)) {\n        if (username) {\n          finalSlug = `${username}/${workspaceNameSlug}-${counter}`;\n        } else {\n          finalSlug = `${workspaceNameSlug}-${counter}`;\n        }\n        counter++;\n      }\n    }\n\n    const workspace = Workspace.create({\n      ...props,\n      slug: finalSlug,\n    });\n    return this.workspaceRepository.create(workspace);\n  }\n\n  private generateSlug(name: string): string {\n    return name\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_-]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n  }\n}\n","import { WorkspaceMember, MemberRole } from \"../model/workspace-member.entity\";\nimport { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class AddMemberToWorkspaceUseCase {\n    constructor(private workspaceRepository: WorkspaceRepository) { }\n\n    async execute(workspaceId: string, userId: string, role: MemberRole = \"MEMBER\"): Promise<WorkspaceMember> {\n        // Check if workspace exists\n        const workspace = await this.workspaceRepository.findById(workspaceId);\n        if (!workspace) {\n            throw new Error(\"Workspace not found\");\n        }\n\n        // Check if user is already a member\n        const existingMember = await this.workspaceRepository.findMember(workspaceId, userId);\n        if (existingMember) {\n            // If already a member, return existing member (idempotent operation)\n            // This handles the case where the repository already added the owner as member during workspace creation\n            return existingMember;\n        }\n\n        const member = WorkspaceMember.create({\n            workspaceId,\n            userId,\n            role,\n        });\n\n        return this.workspaceRepository.addMember(member);\n    }\n}\n","import { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class RemoveMemberFromWorkspaceUseCase {\n    constructor(private workspaceRepository: WorkspaceRepository) { }\n\n    async execute(workspaceId: string, userId: string): Promise<void> {\n        // Check if workspace exists\n        const workspace = await this.workspaceRepository.findById(workspaceId);\n        if (!workspace) {\n            throw new Error(\"Workspace not found\");\n        }\n\n        // Check if member exists\n        const member = await this.workspaceRepository.findMember(workspaceId, userId);\n        if (!member) {\n            throw new Error(\"User is not a member of this workspace\");\n        }\n\n        // Prevent removing the owner (if applicable logic exists, but for now simple removal)\n        // Ideally we should check if the user is the owner, but ownerId is on Workspace.\n        if (workspace.props.ownerId === userId) {\n            throw new Error(\"Cannot remove the owner from the workspace\");\n        }\n\n        await this.workspaceRepository.removeMember(workspaceId, userId);\n    }\n}\n","import { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class SoftDeleteWorkspaceUseCase {\n  constructor(private workspaceRepository: WorkspaceRepository) {}\n\n  async execute(id: string, userId: string): Promise<void> {\n    const workspace = await this.workspaceRepository.findById(id);\n    if (!workspace) {\n      throw new Error(\"Workspace not found\");\n    }\n\n    if (workspace.props.ownerId !== userId) {\n      throw new Error(\"Unauthorized\");\n    }\n\n    await this.workspaceRepository.softDelete(id);\n  }\n}\n","import { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class RestoreWorkspaceUseCase {\n  constructor(private workspaceRepository: WorkspaceRepository) {}\n\n  async execute(id: string, userId: string): Promise<void> {\n    const workspace = await this.workspaceRepository.findById(id);\n    if (!workspace) {\n      throw new Error(\"Workspace not found\");\n    }\n\n    if (workspace.props.ownerId !== userId) {\n      throw new Error(\"Unauthorized\");\n    }\n\n    await this.workspaceRepository.restore(id);\n  }\n}\n","import { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class PermanentDeleteWorkspaceUseCase {\n    constructor(private workspaceRepository: WorkspaceRepository) { }\n\n    async execute(id: string, userId: string): Promise<void> {\n        const workspace = await this.workspaceRepository.findById(id);\n        if (!workspace) {\n            throw new Error(\"Workspace not found\");\n        }\n\n        if (workspace.props.ownerId !== userId) {\n            throw new Error(\"Unauthorized\");\n        }\n\n        if (!workspace.props.isDeleted) {\n            throw new Error(\"Workspace must be soft deleted first\");\n        }\n\n        await this.workspaceRepository.permanentDelete(id);\n    }\n}\n","import { Workspace } from \"../model/workspace.entity\";\nimport { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class GetDeletedWorkspacesUseCase {\n    constructor(private workspaceRepository: WorkspaceRepository) { }\n\n    async execute(userId: string): Promise<Workspace[]> {\n        return this.workspaceRepository.findDeleted(userId);\n    }\n}\n","import { Workspace } from \"../model/workspace.entity\";\nimport { WorkspaceRepository } from \"../provider/workspace.repository\";\n\nexport class ArchiveWorkspaceUseCase {\n    constructor(private workspaceRepository: WorkspaceRepository) { }\n\n    async execute(id: string, userId: string): Promise<Workspace> {\n        const workspace = await this.workspaceRepository.findById(id);\n        if (!workspace) {\n            throw new Error(\"Workspace not found\");\n        }\n\n        if (workspace.props.ownerId !== userId) {\n            throw new Error(\"Unauthorized\");\n        }\n\n        const archivedWorkspace = workspace.archive();\n        return this.workspaceRepository.update(archivedWorkspace);\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\nimport { MemberRole } from \"./workspace-member.entity\";\n\nexport type InviteStatus = \"PENDING\" | \"ACCEPTED\" | \"EXPIRED\" | \"CANCELLED\";\n\nexport interface WorkspaceInvitationProps extends EntityProps {\n    workspaceId: string;\n    email: string;\n    tokenHash: string;\n    role: MemberRole;\n    status: InviteStatus;\n    invitedById?: string;\n    expiresAt: Date;\n    acceptedAt?: Date;\n    createdAt?: Date;\n    updatedAt?: Date;\n}\n\nexport class WorkspaceInvitation extends Entity<WorkspaceInvitationProps> {\n    constructor(props: WorkspaceInvitationProps) {\n        super({\n            ...props,\n            status: props.status ?? \"PENDING\",\n            role: props.role ?? \"MEMBER\",\n            createdAt: props.createdAt ?? new Date(),\n            updatedAt: props.updatedAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<WorkspaceInvitationProps, \"id\" | \"createdAt\" | \"updatedAt\" | \"status\" | \"acceptedAt\">): WorkspaceInvitation {\n        return new WorkspaceInvitation({\n            ...props,\n            status: \"PENDING\",\n        });\n    }\n\n    accept(): WorkspaceInvitation {\n        return this.clone({\n            status: \"ACCEPTED\",\n            acceptedAt: new Date(),\n            updatedAt: new Date(),\n        });\n    }\n\n    cancel(): WorkspaceInvitation {\n        return this.clone({\n            status: \"CANCELLED\",\n            updatedAt: new Date(),\n        });\n    }\n\n    isExpired(): boolean {\n        return this.props.expiresAt < new Date();\n    }\n}\n","import { WorkspaceInvitation } from \"../model/workspace-invitation.entity\";\nimport { WorkspaceInvitationRepository } from \"../provider/workspace-invitation.repository\";\nimport { WorkspaceRepository } from \"../provider/workspace.repository\";\nimport { MemberRole } from \"../model/workspace-member.entity\";\nimport { HashService } from \"../../shared/services/hash.service\";\nimport { v4 as uuidv4 } from 'uuid';\n\nexport class InviteMemberUseCase {\n    constructor(\n        private workspaceRepository: WorkspaceRepository,\n        private invitationRepository: WorkspaceInvitationRepository,\n        private hashService: HashService\n    ) { }\n\n    async execute(workspaceId: string, email: string, role: MemberRole, invitedById: string): Promise<{ invitation: WorkspaceInvitation, token: string }> {\n        const workspace = await this.workspaceRepository.findById(workspaceId);\n        if (!workspace) {\n            throw new Error(\"Workspace not found\");\n        }\n\n        // Check if inviter is a member (and has permissions - simplified for now)\n        // In a real app, we'd check permissions here.\n\n        // Generate a secure random token\n        const token = uuidv4();\n\n        // Hash the token before storing it in the database\n        // This ensures that even if the database is compromised, tokens cannot be used\n        const tokenHash = await this.hashService.hash(token);\n\n        const expiresAt = new Date();\n        expiresAt.setDate(expiresAt.getDate() + 7); // 7 days expiration\n\n        const invitation = WorkspaceInvitation.create({\n            workspaceId,\n            email,\n            tokenHash,\n            role,\n            invitedById,\n            expiresAt,\n        });\n\n        const savedInvitation = await this.invitationRepository.create(invitation);\n\n        // Here we would trigger an event or call a service to send the email.\n        // For now, we return the plain token so the controller can display it (dev mode) or send it.\n        // IMPORTANT: The plain token should ONLY be sent via email, never stored or logged\n\n        return { invitation: savedInvitation, token };\n    }\n}\n","import { WorkspaceInvitation } from \"../model/workspace-invitation.entity\";\nimport { WorkspaceInvitationRepository } from \"../provider/workspace-invitation.repository\";\nimport { WorkspaceRepository } from \"../provider/workspace.repository\";\nimport { WorkspaceMember } from \"../model/workspace-member.entity\";\nimport { HashService } from \"../../shared/services/hash.service\";\n\nexport class AcceptInvitationUseCase {\n    constructor(\n        private workspaceRepository: WorkspaceRepository,\n        private invitationRepository: WorkspaceInvitationRepository,\n        private hashService: HashService\n    ) { }\n\n    async execute(token: string, userId: string): Promise<void> {\n        // Since we now store hashed tokens with bcrypt, we can't search directly by hash\n        // (bcrypt generates different hashes each time even for the same input)\n        // Instead, we fetch all pending invitations and compare the token against each hash\n\n        const pendingInvitations = await this.invitationRepository.findPendingInvitations();\n\n        if (pendingInvitations.length === 0) {\n            throw new Error(\"Invalid invitation token\");\n        }\n\n        // Find the invitation that matches the provided token\n        let matchedInvitation: WorkspaceInvitation | null = null;\n\n        for (const invitation of pendingInvitations) {\n            const isValid = await this.hashService.compare(token, invitation.props.tokenHash);\n            if (isValid) {\n                matchedInvitation = invitation;\n                break;\n            }\n        }\n\n        if (!matchedInvitation) {\n            throw new Error(\"Invalid invitation token\");\n        }\n\n        if (matchedInvitation.isExpired()) {\n            throw new Error(\"Invitation expired\");\n        }\n\n        const workspaceId = matchedInvitation.props.workspaceId;\n\n        // Check if user is already a member of the workspace\n        const existingMember = await this.workspaceRepository.findMember(workspaceId, userId);\n        if (existingMember) {\n            // User is already a member - just mark the invitation as accepted and return\n            // This makes the operation idempotent and allows accepting invitations multiple times safely\n            const acceptedInvitation = matchedInvitation.accept();\n            await this.invitationRepository.update(acceptedInvitation);\n            return;\n        }\n\n        // Add member to workspace\n        const member = WorkspaceMember.create({\n            workspaceId,\n            userId,\n            role: matchedInvitation.props.role,\n        });\n\n        await this.workspaceRepository.addMember(member);\n\n        // Mark invitation as accepted\n        const acceptedInvitation = matchedInvitation.accept();\n        await this.invitationRepository.update(acceptedInvitation);\n    }\n}\n","import { WorkspaceSettings, ViewType } from \"../model/workspace-settings.entity\";\nimport { WorkspaceSettingsRepository } from \"../provider/workspace-settings.repository\";\n\nexport interface UpdateWorkspaceSettingsInput {\n    workspaceId: string;\n    defaultView?: ViewType;\n    defaultDueTime?: number;\n    timezone?: string;\n    locale?: string;\n}\n\nexport class UpdateWorkspaceSettingsUseCase {\n    constructor(private readonly settingsRepository: WorkspaceSettingsRepository) { }\n\n    async execute(input: UpdateWorkspaceSettingsInput): Promise<WorkspaceSettings> {\n        // Buscar configuración existente\n        const existing = await this.settingsRepository.findByWorkspaceId(input.workspaceId);\n\n        let settings: WorkspaceSettings;\n\n        if (existing) {\n            // Actualizar configuración existente\n            settings = existing.update({\n                defaultView: input.defaultView,\n                defaultDueTime: input.defaultDueTime,\n                timezone: input.timezone,\n                locale: input.locale,\n            });\n        } else {\n            // Crear nueva configuración\n            settings = WorkspaceSettings.create({\n                workspaceId: input.workspaceId,\n                defaultView: input.defaultView,\n                defaultDueTime: input.defaultDueTime,\n                timezone: input.timezone,\n                locale: input.locale,\n            });\n        }\n\n        return this.settingsRepository.upsert(settings);\n    }\n}\n","import { WorkspaceSettings } from \"../model/workspace-settings.entity\";\nimport { WorkspaceSettingsRepository } from \"../provider/workspace-settings.repository\";\n\nexport interface GetWorkspaceSettingsInput {\n    workspaceId: string;\n}\n\nexport class GetWorkspaceSettingsUseCase {\n    constructor(private readonly settingsRepository: WorkspaceSettingsRepository) { }\n\n    async execute(input: GetWorkspaceSettingsInput): Promise<WorkspaceSettings | null> {\n        return this.settingsRepository.findByWorkspaceId(input.workspaceId);\n    }\n}\n","import { WorkspaceAuditLog, AuditAction } from \"../model/workspace-audit-log.entity\";\nimport { WorkspaceAuditLogRepository } from \"../provider/workspace-audit-log.repository\";\n\nexport interface CreateAuditLogInput {\n    workspaceId: string;\n    actorId?: string;\n    action: AuditAction;\n    payload?: Record<string, unknown>;\n}\n\nexport class CreateAuditLogUseCase {\n    constructor(private readonly auditLogRepository: WorkspaceAuditLogRepository) { }\n\n    async execute(input: CreateAuditLogInput): Promise<WorkspaceAuditLog> {\n        const log = WorkspaceAuditLog.create({\n            workspaceId: input.workspaceId,\n            actorId: input.actorId,\n            action: input.action,\n            payload: input.payload,\n        });\n\n        return this.auditLogRepository.create(log);\n    }\n}\n","import { WorkspaceAuditLog } from \"../model/workspace-audit-log.entity\";\nimport { WorkspaceAuditLogRepository } from \"../provider/workspace-audit-log.repository\";\n\nexport interface GetWorkspaceAuditLogsInput {\n    workspaceId: string;\n    limit?: number;\n    offset?: number;\n}\n\nexport interface GetWorkspaceAuditLogsOutput {\n    logs: WorkspaceAuditLog[];\n    total: number;\n}\n\nexport class GetWorkspaceAuditLogsUseCase {\n    constructor(private readonly auditLogRepository: WorkspaceAuditLogRepository) { }\n\n    async execute(input: GetWorkspaceAuditLogsInput): Promise<GetWorkspaceAuditLogsOutput> {\n        const limit = input.limit ?? 50;\n        const offset = input.offset ?? 0;\n\n        const [logs, total] = await Promise.all([\n            this.auditLogRepository.findByWorkspaceId(input.workspaceId, limit, offset),\n            this.auditLogRepository.countByWorkspaceId(input.workspaceId),\n        ]);\n\n        return { logs, total };\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport interface ProjectProps extends EntityProps {\n  name: string;\n  slug: string;\n  description?: string;\n  color: string;\n  icon?: string;\n  workspaceId: string;\n  workflowId: string;\n  position: number;\n  archived: boolean;\n  completed: boolean;\n  completedAt?: Date;\n  isDeleted: boolean;\n  deletedAt?: Date;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\nexport class Project extends Entity<ProjectProps> {\n  constructor(props: ProjectProps) {\n    super({\n      ...props,\n      color: props.color ?? \"#6B7280\",\n      position: props.position ?? 0,\n      archived: props.archived ?? false,\n      completed: props.completed ?? false,\n      isDeleted: props.isDeleted ?? false,\n      createdAt: props.createdAt ?? new Date(),\n      updatedAt: props.updatedAt ?? new Date(),\n    });\n  }\n\n  static create(\n    props: Omit<\n      ProjectProps,\n      | \"id\"\n      | \"createdAt\"\n      | \"updatedAt\"\n      | \"position\"\n      | \"archived\"\n      | \"completed\"\n      | \"completedAt\"\n      | \"isDeleted\"\n      | \"deletedAt\"\n    >,\n  ): Project {\n    return new Project({\n      ...props,\n      position: 0,\n      archived: false,\n      completed: false,\n      isDeleted: false,\n    });\n  }\n\n  update(\n    props: Partial<\n      Omit<ProjectProps, \"id\" | \"workspaceId\" | \"createdAt\" | \"workflowId\">\n    >,\n  ): Project {\n    return this.clone({\n      ...props,\n      updatedAt: new Date(),\n    });\n  }\n\n  archive(): Project {\n    return this.clone({\n      archived: true,\n      updatedAt: new Date(),\n    });\n  }\n\n  unarchive(): Project {\n    return this.clone({\n      archived: false,\n      updatedAt: new Date(),\n    });\n  }\n\n  complete(): Project {\n    return this.clone({\n      completed: true,\n      completedAt: new Date(),\n      updatedAt: new Date(),\n    });\n  }\n\n  uncomplete(): Project {\n    return this.clone({\n      completed: false,\n      completedAt: undefined,\n      updatedAt: new Date(),\n    });\n  }\n\n  softDelete(): Project {\n    return this.clone({\n      isDeleted: true,\n      deletedAt: new Date(),\n      updatedAt: new Date(),\n    });\n  }\n\n  restore(): Project {\n    return this.clone({\n      isDeleted: false,\n      deletedAt: undefined,\n      updatedAt: new Date(),\n    });\n  }\n}\n","import { Project, ProjectProps } from \"../model/project.entity\";\nimport { ProjectRepository } from \"../provider/project.repository\";\n\nexport class CreateProjectUseCase {\n    constructor(private projectRepository: ProjectRepository) { }\n\n    async execute(props: Omit<ProjectProps, \"id\" | \"createdAt\" | \"updatedAt\" | \"position\" | \"archived\" | \"completed\" | \"completedAt\">): Promise<Project> {\n        const project = Project.create(props);\n        return this.projectRepository.create(project);\n    }\n}\n","import { Project, ProjectProps } from \"../model/project.entity\";\nimport { ProjectRepository } from \"../provider/project.repository\";\n\nexport class UpdateProjectUseCase {\n    constructor(private projectRepository: ProjectRepository) { }\n\n    async execute(id: string, props: Partial<Omit<ProjectProps, \"id\" | \"workspaceId\" | \"createdAt\">>): Promise<Project> {\n        const project = await this.projectRepository.findById(id);\n        if (!project) {\n            throw new Error(\"Project not found\");\n        }\n\n        const updatedProject = project.update(props);\n        return this.projectRepository.update(updatedProject);\n    }\n}\n","import { Project } from \"../model/project.entity\";\nimport { ProjectRepository } from \"../provider/project.repository\";\n\nexport class ArchiveProjectUseCase {\n    constructor(private projectRepository: ProjectRepository) { }\n\n    async execute(id: string): Promise<Project> {\n        const project = await this.projectRepository.findById(id);\n        if (!project) {\n            throw new Error(\"Project not found\");\n        }\n\n        // Toggle archive status: if archived, unarchive it; if not archived, archive it\n        const updatedProject = project.props.archived ? project.unarchive() : project.archive();\n        return this.projectRepository.update(updatedProject);\n    }\n}\n","import { ProjectRepository } from \"../provider/project.repository\";\n\nexport class DeleteProjectUseCase {\n    constructor(private projectRepository: ProjectRepository) { }\n\n    async execute(id: string): Promise<void> {\n        const project = await this.projectRepository.findById(id);\n        if (!project) {\n            throw new Error(\"Project not found\");\n        }\n\n        await this.projectRepository.delete(id);\n    }\n}\n","import { ProjectRepository } from \"../provider/project.repository\";\n\nexport class SoftDeleteProjectUseCase {\n  constructor(private projectRepository: ProjectRepository) {}\n\n  async execute(id: string): Promise<void> {\n    const project = await this.projectRepository.findById(id);\n    if (!project) {\n      throw new Error(\"Project not found\");\n    }\n\n    await this.projectRepository.softDelete(id);\n  }\n}\n","import { ProjectRepository } from \"../provider/project.repository\";\n\nexport class RestoreProjectUseCase {\n  constructor(private projectRepository: ProjectRepository) {}\n\n  async execute(id: string): Promise<void> {\n    const project = await this.projectRepository.findById(id);\n    if (!project) {\n      throw new Error(\"Project not found\");\n    }\n\n    if (!project.props.isDeleted) {\n      throw new Error(\"Project is not deleted\");\n    }\n\n    await this.projectRepository.restore(id);\n  }\n}\n","import { ProjectRepository } from \"../provider/project.repository\";\n\nexport class PermanentDeleteProjectUseCase {\n  constructor(private projectRepository: ProjectRepository) {}\n\n  async execute(id: string): Promise<void> {\n    const project = await this.projectRepository.findById(id);\n    if (!project) {\n      throw new Error(\"Project not found\");\n    }\n\n    if (!project.props.isDeleted) {\n      throw new Error(\"Project must be soft deleted first\");\n    }\n\n    await this.projectRepository.permanentDelete(id);\n  }\n}\n","import { ProjectRepository } from \"../provider/project.repository\";\nimport { Project } from \"../model/project.entity\";\n\nexport class GetDeletedProjectsUseCase {\n  constructor(private projectRepository: ProjectRepository) {}\n\n  async execute(workspaceId: string): Promise<Project[]> {\n    const projects = await this.projectRepository.findDeleted(workspaceId);\n    return projects;\n  }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport interface WorkflowProps extends EntityProps {\n    name: string;\n    description?: string;\n    color: string;\n    icon?: string;\n    workspaceId: string;\n    position: number;\n    createdAt?: Date;\n    updatedAt?: Date;\n}\n\nexport class Workflow extends Entity<WorkflowProps> {\n    constructor(props: WorkflowProps) {\n        super({\n            ...props,\n            color: props.color ?? \"#6B7280\",\n            position: props.position ?? 0,\n            createdAt: props.createdAt ?? new Date(),\n            updatedAt: props.updatedAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<WorkflowProps, \"id\" | \"createdAt\" | \"updatedAt\" | \"position\">): Workflow {\n        return new Workflow({\n            ...props,\n            position: 0,\n        });\n    }\n\n    update(props: Partial<Omit<WorkflowProps, \"id\" | \"workspaceId\" | \"createdAt\">>): Workflow {\n        return this.clone({\n            ...props,\n            updatedAt: new Date(),\n        });\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { Workflow } from \"../model/workflow.entity\";\nimport { WorkflowRepository } from \"../provider/workflow.repository\";\n\ninterface CreateWorkflowInput {\n    name: string;\n    description?: string;\n    color?: string;\n    icon?: string;\n    workspaceId: string;\n}\n\nexport class CreateWorkflowUseCase implements UseCase<CreateWorkflowInput, Workflow> {\n    constructor(private readonly workflowRepository: WorkflowRepository) { }\n\n    async execute(input: CreateWorkflowInput): Promise<Workflow> {\n        const workflow = Workflow.create({\n            name: input.name,\n            description: input.description,\n            color: input.color ?? \"#6B7280\",\n            icon: input.icon,\n            workspaceId: input.workspaceId,\n        });\n\n        await this.workflowRepository.save(workflow);\n\n        return workflow;\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { Workflow } from \"../model/workflow.entity\";\nimport { WorkflowRepository } from \"../provider/workflow.repository\";\n\nexport class ListWorkflowsUseCase implements UseCase<string, Workflow[]> {\n    constructor(private readonly workflowRepository: WorkflowRepository) { }\n\n    async execute(workspaceId: string): Promise<Workflow[]> {\n        return this.workflowRepository.findByWorkspaceId(workspaceId);\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { Workflow } from \"../model/workflow.entity\";\nimport { WorkflowRepository } from \"../provider/workflow.repository\";\n\ninterface UpdateWorkflowInput {\n    id: string;\n    name?: string;\n    description?: string;\n    color?: string;\n    icon?: string;\n    position?: number;\n}\n\nexport class UpdateWorkflowUseCase implements UseCase<UpdateWorkflowInput, Workflow> {\n    constructor(private readonly workflowRepository: WorkflowRepository) { }\n\n    async execute(input: UpdateWorkflowInput): Promise<Workflow> {\n        const workflow = await this.workflowRepository.findById(input.id);\n\n        if (!workflow) {\n            throw new Error(\"Workflow not found\");\n        }\n\n        const updatedWorkflow = workflow.update({\n            name: input.name,\n            description: input.description,\n            color: input.color,\n            icon: input.icon,\n            position: input.position,\n        });\n\n        await this.workflowRepository.update(updatedWorkflow);\n\n        return updatedWorkflow;\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { WorkflowRepository } from \"../provider/workflow.repository\";\n\nexport class DeleteWorkflowUseCase implements UseCase<string, void> {\n    constructor(private readonly workflowRepository: WorkflowRepository) { }\n\n    async execute(id: string): Promise<void> {\n        await this.workflowRepository.delete(id);\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport interface TagProps extends EntityProps {\n    name: string;\n    color: string;\n    workspaceId?: string; // Tags are usually per workspace or global? Schema says workspaceId.\n    createdAt?: Date;\n}\n\nexport class Tag extends Entity<TagProps> {\n    constructor(props: TagProps) {\n        super({\n            ...props,\n            color: props.color ?? \"#6B7280\",\n            createdAt: props.createdAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<TagProps, \"id\" | \"createdAt\">): Tag {\n        return new Tag({\n            ...props,\n        });\n    }\n\n    update(props: Partial<Omit<TagProps, \"id\" | \"workspaceId\" | \"createdAt\">>): Tag {\n        return this.clone({\n            ...props\n        });\n    }\n}\n","import { Tag, TagProps } from \"../model/tag.entity\";\nimport { TagRepository } from \"../provider/tag.repository\";\n\nexport class CreateTagUseCase {\n    constructor(private tagRepository: TagRepository) { }\n\n    async execute(props: Omit<TagProps, \"id\" | \"createdAt\">): Promise<Tag> {\n        const tag = Tag.create(props);\n        return this.tagRepository.create(tag);\n    }\n}\n","import { TagRepository } from \"../provider/tag.repository\";\n\nexport class AssignTagToTaskUseCase {\n    constructor(private tagRepository: TagRepository) { }\n\n    async execute(tagId: string, taskId: string): Promise<void> {\n        // Verify tag exists\n        const tag = await this.tagRepository.findById(tagId);\n        if (!tag) {\n            throw new Error(\"Tag not found\");\n        }\n\n        // We could also verify task exists if we had TaskRepository here, \n        // but usually the repo implementation will handle FK constraint errors.\n\n        await this.tagRepository.assignToTask(tagId, taskId);\n    }\n}\n","import { TagRepository } from \"../provider/tag.repository\";\n\nexport class RemoveTagFromTaskUseCase {\n    constructor(private tagRepository: TagRepository) { }\n\n    async execute(tagId: string, taskId: string): Promise<void> {\n        await this.tagRepository.removeFromTask(tagId, taskId);\n    }\n}\n","import { Tag, TagProps } from \"../model/tag.entity\";\nimport { TagRepository } from \"../provider/tag.repository\";\n\nexport class UpdateTagUseCase {\n    constructor(private tagRepository: TagRepository) { }\n\n    async execute(id: string, props: Partial<Omit<TagProps, \"id\" | \"workspaceId\" | \"createdAt\">>): Promise<Tag> {\n        const tag = await this.tagRepository.findById(id);\n        if (!tag) {\n            throw new Error(\"Tag not found\");\n        }\n\n        const updatedTag = tag.update(props);\n        return this.tagRepository.update(updatedTag);\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type SessionType = \"WORK\" | \"SHORT_BREAK\" | \"LONG_BREAK\" | \"CONTINUOUS\";\n\nexport interface PauseRecord {\n    startedAt: Date;\n    endedAt: Date;\n    duration: number; // in seconds\n}\n\n\n\nexport interface TimeSessionProps extends EntityProps {\n    taskId?: string;\n    userId: string;\n    startedAt: Date;\n    endedAt?: Date;\n    duration?: number; // in minutes (excludes pause time)\n    type: SessionType;\n    wasCompleted: boolean;\n    wasInterrupted: boolean;\n    pauseCount?: number;\n    totalPauseTime?: number; // in seconds\n    pauseData?: PauseRecord[];\n    currentPauseStart?: Date;\n    parentSessionId?: string;\n    splitReason?: string;\n    createdAt?: Date;\n}\n\nexport class TimeSession extends Entity<TimeSessionProps> {\n    constructor(props: TimeSessionProps) {\n        super({\n            ...props,\n            type: props.type ?? \"WORK\",\n            wasCompleted: props.wasCompleted ?? false,\n            wasInterrupted: props.wasInterrupted ?? false,\n            pauseCount: props.pauseCount ?? 0,\n            totalPauseTime: props.totalPauseTime ?? 0,\n            pauseData: props.pauseData ?? [],\n            createdAt: props.createdAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<TimeSessionProps, \"id\" | \"createdAt\" | \"wasCompleted\" | \"wasInterrupted\" | \"pauseCount\" | \"totalPauseTime\" | \"pauseData\" | \"currentPauseStart\">): TimeSession {\n        return new TimeSession({\n            ...props,\n            wasCompleted: false,\n            wasInterrupted: false,\n            pauseCount: 0,\n            totalPauseTime: 0,\n            pauseData: [],\n            currentPauseStart: undefined,\n        });\n    }\n\n    pause(pauseStartedAt: Date = new Date()): TimeSession {\n        // If already paused, don't pause again or update start time? \n        // For now assume it's valid call.\n        return this.clone({\n            pauseCount: (this.props.pauseCount ?? 0) + 1,\n            currentPauseStart: pauseStartedAt,\n        });\n    }\n\n    resume(pauseStartedAt: Date, pauseEndedAt: Date = new Date()): TimeSession {\n        // Use stored currentPauseStart if available, otherwise use argument\n        const actualPauseStart = this.props.currentPauseStart ?? pauseStartedAt;\n\n        const pauseDuration = Math.floor((pauseEndedAt.getTime() - actualPauseStart.getTime()) / 1000);\n        const pauseRecord: PauseRecord = {\n            startedAt: actualPauseStart,\n            endedAt: pauseEndedAt,\n            duration: pauseDuration,\n        };\n\n        return this.clone({\n            totalPauseTime: (this.props.totalPauseTime ?? 0) + pauseDuration,\n            pauseData: [...(this.props.pauseData ?? []), pauseRecord],\n            currentPauseStart: undefined,\n        });\n    }\n\n    stop(endedAt: Date = new Date(), wasCompleted: boolean = false, wasInterrupted: boolean = false): TimeSession {\n        // If stopped while paused, we need to handle the pending pause.\n        // Usually stop implies finishing the session.\n        // If paused, the duration should exclude the current pause duration?\n        // Or should we consider the session ended at the start of the pause?\n        // Let's assume we count time up to 'endedAt', excluding 'totalPauseTime'.\n        // If currently paused, we should probably add the current pause to totalPauseTime?\n        // Or just ignore the current pause \"gap\" and say it ended now.\n\n        let extraPauseTime = 0;\n        if (this.props.currentPauseStart) {\n            // If we stop while paused, the time from pauseStart to now is technically pause time, \n            // but since we are stopping, maybe we just consider the work ended at pauseStart?\n            // But 'endedAt' is passed.\n            // Let's stick to simple logic: total duration = (endedAt - startedAt) - totalPauseTime.\n            // If we are paused, we should probably close the pause first?\n            // For simplicity, let's assume the user resumes then stops, or we just calculate active time.\n\n            // If we are paused, the time since pauseStart is NOT work time.\n            // So we should add it to totalPauseTime.\n            extraPauseTime = Math.floor((endedAt.getTime() - this.props.currentPauseStart.getTime()) / 1000);\n        }\n\n        const totalMs = endedAt.getTime() - this.props.startedAt.getTime();\n        const totalSeconds = Math.floor(totalMs / 1000);\n        const activeSeconds = totalSeconds - (this.props.totalPauseTime ?? 0) - extraPauseTime;\n        const durationMinutes = Math.round(activeSeconds / 60);\n\n        return this.clone({\n            endedAt,\n            duration: durationMinutes,\n            wasCompleted,\n            wasInterrupted,\n            currentPauseStart: undefined, // Clear pause state\n            totalPauseTime: (this.props.totalPauseTime ?? 0) + extraPauseTime,\n        });\n    }\n\n    split(endedAt: Date = new Date(), wasCompleted: boolean = true, splitReason: string = \"TASK_SWITCH\"): TimeSession {\n        let extraPauseTime = 0;\n        if (this.props.currentPauseStart) {\n            extraPauseTime = Math.floor((endedAt.getTime() - this.props.currentPauseStart.getTime()) / 1000);\n        }\n\n        const totalMs = endedAt.getTime() - this.props.startedAt.getTime();\n        const totalSeconds = Math.floor(totalMs / 1000);\n        const activeSeconds = totalSeconds - (this.props.totalPauseTime ?? 0) - extraPauseTime;\n        const durationMinutes = Math.round(activeSeconds / 60);\n\n        return this.clone({\n            endedAt,\n            duration: durationMinutes,\n            wasCompleted,\n            wasInterrupted: false,\n            splitReason,\n            currentPauseStart: undefined,\n            totalPauseTime: (this.props.totalPauseTime ?? 0) + extraPauseTime,\n        });\n    }\n}\n","import { TimeSession, SessionType } from \"../model/time-session.entity\";\nimport { TimerRepository } from \"../provider/timer.repository\";\nimport { TaskRepository } from \"../../tasks/provider/task.repository\";\n\nexport class StartTimerUseCase {\n    constructor(\n        private timerRepository: TimerRepository,\n        private taskRepository: TaskRepository\n    ) { }\n\n    async execute(userId: string, taskId?: string, type: SessionType = \"WORK\"): Promise<TimeSession> {\n        // Check if there is already an active session\n        const activeSession = await this.timerRepository.findActiveSession(userId);\n        if (activeSession) {\n            // Automatically stop the previous session as interrupted\n            const stoppedSession = activeSession.stop(new Date(), false, true);\n            await this.timerRepository.update(stoppedSession);\n        }\n\n        const session = TimeSession.create({\n            userId,\n            taskId,\n            startedAt: new Date(),\n            type,\n        });\n\n        const createdSession = await this.timerRepository.create(session);\n\n        // Update task status to IN_PROGRESS if it's a WORK session and taskId is provided\n        if (type === \"WORK\" && taskId) {\n            const task = await this.taskRepository.findById(taskId);\n            if (task && task.props.status === \"TODO\") {\n                const updatedTask = task.updateStatus(\"IN_PROGRESS\");\n                await this.taskRepository.update(updatedTask);\n            }\n        }\n\n        return createdSession;\n    }\n}\n","import { TimeSession } from \"../model/time-session.entity\";\nimport { TimerRepository } from \"../provider/timer.repository\";\n\nexport class StopTimerUseCase {\n    constructor(private timerRepository: TimerRepository) { }\n\n    async execute(userId: string, wasCompleted: boolean = false): Promise<TimeSession> {\n        const activeSession = await this.timerRepository.findActiveSession(userId);\n        if (!activeSession) {\n            throw new Error(\"No active timer session found\");\n        }\n\n        const stoppedSession = activeSession.stop(new Date(), wasCompleted, !wasCompleted);\n        return this.timerRepository.update(stoppedSession);\n    }\n}\n","import { TimeSession } from \"../model/time-session.entity\";\nimport { TimerRepository } from \"../provider/timer.repository\";\n\nexport class PauseTimerUseCase {\n    constructor(private timerRepository: TimerRepository) { }\n\n    async execute(userId: string, pauseStartedAt: Date = new Date()): Promise<TimeSession> {\n        const activeSession = await this.timerRepository.findActiveSession(userId);\n        if (!activeSession) {\n            throw new Error(\"No active timer session found\");\n        }\n\n        const pausedSession = activeSession.pause(pauseStartedAt);\n        return this.timerRepository.update(pausedSession);\n    }\n}\n","import { TimeSession } from \"../model/time-session.entity\";\nimport { TimerRepository } from \"../provider/timer.repository\";\n\nexport class ResumeTimerUseCase {\n    constructor(private timerRepository: TimerRepository) { }\n\n    async execute(userId: string, pauseStartedAt: Date, pauseEndedAt: Date = new Date()): Promise<TimeSession> {\n        const activeSession = await this.timerRepository.findActiveSession(userId);\n        if (!activeSession) {\n            throw new Error(\"No active timer session found\");\n        }\n\n        const resumedSession = activeSession.resume(pauseStartedAt, pauseEndedAt);\n        return this.timerRepository.update(resumedSession);\n    }\n}\n","import { TimeSession, SessionType } from \"../model/time-session.entity\";\nimport { TimerRepository } from \"../provider/timer.repository\";\n\nexport class SwitchTaskUseCase {\n    constructor(private timerRepository: TimerRepository) { }\n\n    async execute(\n        userId: string,\n        newTaskId: string,\n        type: SessionType = \"WORK\",\n        splitReason: string = \"TASK_SWITCH\"\n    ): Promise<{ oldSession: TimeSession; newSession: TimeSession }> {\n        // Get current active session\n        const activeSession = await this.timerRepository.findActiveSession(userId);\n        if (!activeSession) {\n            throw new Error(\"No active timer session found\");\n        }\n\n        // Stop the current session as \"completed\" since the work done is valid\n        const stoppedSession = activeSession.split(new Date(), true, splitReason);\n        await this.timerRepository.update(stoppedSession);\n\n        // Create a new session for the new task\n        const newSession = TimeSession.create({\n            userId,\n            taskId: newTaskId,\n            startedAt: new Date(),\n            type,\n            parentSessionId: stoppedSession.id as string,\n        });\n\n        const createdSession = await this.timerRepository.create(newSession);\n\n        return {\n            oldSession: stoppedSession,\n            newSession: createdSession,\n        };\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport interface DailyMetricsProps extends EntityProps {\n    userId: string;\n    date: Date;\n    tasksCreated: number;\n    tasksCompleted: number;\n    subtasksCompleted: number;\n    minutesWorked: number;\n    pomodorosCompleted: number;\n    shortBreaksCompleted: number;\n    longBreaksCompleted: number;\n    breakMinutes: number;\n    focusScore?: number;\n    createdAt?: Date;\n}\n\nexport class DailyMetrics extends Entity<DailyMetricsProps> {\n    constructor(props: DailyMetricsProps) {\n        super({\n            ...props,\n            tasksCreated: props.tasksCreated ?? 0,\n            tasksCompleted: props.tasksCompleted ?? 0,\n            subtasksCompleted: props.subtasksCompleted ?? 0,\n            minutesWorked: props.minutesWorked ?? 0,\n            pomodorosCompleted: props.pomodorosCompleted ?? 0,\n            shortBreaksCompleted: props.shortBreaksCompleted ?? 0,\n            longBreaksCompleted: props.longBreaksCompleted ?? 0,\n            breakMinutes: props.breakMinutes ?? 0,\n            createdAt: props.createdAt ?? new Date(),\n        });\n    }\n\n    static create(props: Omit<DailyMetricsProps, \"id\" | \"createdAt\" | \"tasksCreated\" | \"tasksCompleted\" | \"subtasksCompleted\" | \"minutesWorked\" | \"pomodorosCompleted\" | \"shortBreaksCompleted\" | \"longBreaksCompleted\" | \"breakMinutes\">): DailyMetrics {\n        return new DailyMetrics({\n            ...props,\n            tasksCreated: 0,\n            tasksCompleted: 0,\n            subtasksCompleted: 0,\n            minutesWorked: 0,\n            pomodorosCompleted: 0,\n            shortBreaksCompleted: 0,\n            longBreaksCompleted: 0,\n            breakMinutes: 0,\n        });\n    }\n\n    incrementTasksCreated(): DailyMetrics {\n        return this.clone({ tasksCreated: this.props.tasksCreated + 1 });\n    }\n\n    incrementTasksCompleted(): DailyMetrics {\n        return this.clone({ tasksCompleted: this.props.tasksCompleted + 1 });\n    }\n\n    decrementTasksCompleted(): DailyMetrics {\n        return this.clone({ tasksCompleted: Math.max(0, this.props.tasksCompleted - 1) });\n    }\n\n    incrementSubtasksCompleted(): DailyMetrics {\n        return this.clone({ subtasksCompleted: this.props.subtasksCompleted + 1 });\n    }\n\n    decrementSubtasksCompleted(): DailyMetrics {\n        return this.clone({ subtasksCompleted: Math.max(0, this.props.subtasksCompleted - 1) });\n    }\n\n    addMinutesWorked(minutes: number): DailyMetrics {\n        return this.clone({ minutesWorked: this.props.minutesWorked + minutes });\n    }\n\n    incrementPomodoros(): DailyMetrics {\n        return this.clone({ pomodorosCompleted: this.props.pomodorosCompleted + 1 });\n    }\n\n    updateFocusScore(score: number): DailyMetrics {\n        return this.clone({ focusScore: Math.max(0, Math.min(1, score)) });\n    }\n\n    incrementShortBreaks(): DailyMetrics {\n        return this.clone({ shortBreaksCompleted: this.props.shortBreaksCompleted + 1 });\n    }\n\n    incrementLongBreaks(): DailyMetrics {\n        return this.clone({ longBreaksCompleted: this.props.longBreaksCompleted + 1 });\n    }\n\n    addBreakMinutes(minutes: number): DailyMetrics {\n        return this.clone({ breakMinutes: this.props.breakMinutes + minutes });\n    }\n}\n","import { DailyMetrics } from \"../model/daily-metrics.entity\";\nimport { AnalyticsRepository } from \"../provider/analytics.repository\";\n\nexport class GetDailyMetricsUseCase {\n    constructor(private analyticsRepository: AnalyticsRepository) { }\n\n    async execute(userId: string, date: Date = new Date()): Promise<DailyMetrics> {\n        // Normalize date to start of day or just use the date part\n        // For simplicity, let's assume the repository handles date matching (ignoring time)\n        // or we pass a specific date object.\n\n        // Let's normalize to YYYY-MM-DD in the logic if needed, but Date object is standard.\n        // We'll rely on the repository to find by \"day\".\n\n        let metrics = await this.analyticsRepository.findByDate(userId, date);\n\n        if (!metrics) {\n            // Return empty metrics for UI to display zeros, but don't persist yet?\n            // Or create new?\n            // Let's return a draft/new instance without ID.\n            metrics = DailyMetrics.create({\n                userId,\n                date,\n            });\n        }\n\n        return metrics;\n    }\n}\n","import { DailyMetrics } from \"../model/daily-metrics.entity\";\nimport { AnalyticsRepository } from \"../provider/analytics.repository\";\n\nexport interface UpdateDailyMetricsInput {\n    userId: string;\n    date: Date;\n    tasksCreated?: number;\n    tasksCompleted?: number;\n    subtasksCompleted?: number;\n    minutesWorked?: number;\n    pomodorosCompleted?: number;\n    shortBreaksCompleted?: number;\n    longBreaksCompleted?: number;\n    breakMinutes?: number;\n    focusScore?: number;\n}\n\nexport class UpdateDailyMetricsUseCase {\n    constructor(private analyticsRepository: AnalyticsRepository) { }\n\n    async execute(input: UpdateDailyMetricsInput): Promise<DailyMetrics> {\n        // Normalize date to start of day (ignore time)\n        const normalizedDate = new Date(input.date);\n        normalizedDate.setHours(0, 0, 0, 0);\n\n        // Find or create daily metrics\n        let metrics = await this.analyticsRepository.findByDate(input.userId, normalizedDate);\n\n        if (!metrics) {\n            metrics = DailyMetrics.create({\n                userId: input.userId,\n                date: normalizedDate,\n            });\n        }\n\n        // Apply increments\n        if (input.tasksCreated) {\n            for (let i = 0; i < input.tasksCreated; i++) {\n                metrics = metrics.incrementTasksCreated();\n            }\n        }\n\n        if (input.tasksCompleted) {\n            for (let i = 0; i < Math.abs(input.tasksCompleted); i++) {\n                if (input.tasksCompleted > 0) {\n                    metrics = metrics.incrementTasksCompleted();\n                } else {\n                    metrics = metrics.decrementTasksCompleted();\n                }\n            }\n        }\n\n        if (input.subtasksCompleted) {\n            for (let i = 0; i < Math.abs(input.subtasksCompleted); i++) {\n                if (input.subtasksCompleted > 0) {\n                    metrics = metrics.incrementSubtasksCompleted();\n                } else {\n                    metrics = metrics.decrementSubtasksCompleted();\n                }\n            }\n        }\n\n        if (input.minutesWorked) {\n            metrics = metrics.addMinutesWorked(input.minutesWorked);\n        }\n\n        if (input.pomodorosCompleted) {\n            for (let i = 0; i < input.pomodorosCompleted; i++) {\n                metrics = metrics.incrementPomodoros();\n            }\n        }\n\n        if (input.shortBreaksCompleted) {\n            for (let i = 0; i < input.shortBreaksCompleted; i++) {\n                metrics = metrics.incrementShortBreaks();\n            }\n        }\n\n        if (input.longBreaksCompleted) {\n            for (let i = 0; i < input.longBreaksCompleted; i++) {\n                metrics = metrics.incrementLongBreaks();\n            }\n        }\n\n        if (input.breakMinutes) {\n            metrics = metrics.addBreakMinutes(input.breakMinutes);\n        }\n\n        if (input.focusScore !== undefined) {\n            metrics = metrics.updateFocusScore(input.focusScore);\n        }\n\n        // Save and return\n        await this.analyticsRepository.save(metrics);\n        return metrics;\n    }\n}\n","export interface FocusScoreInput {\n    totalWorkSeconds: number;\n    totalPauseSeconds: number;\n    pauseCount: number;\n}\n\nexport class CalculateFocusScoreUseCase {\n    execute(input: FocusScoreInput): number {\n        const { totalWorkSeconds, totalPauseSeconds, pauseCount } = input;\n\n        // If no work time, return 0\n        if (totalWorkSeconds <= 0) {\n            return 0;\n        }\n\n        // Base score: ratio of work time to total time\n        const totalTime = totalWorkSeconds + totalPauseSeconds;\n        const workRatio = totalWorkSeconds / totalTime;\n\n        // Penalty for frequent pauses (each pause reduces score slightly)\n        // Each pause reduces by 2% (max 20% penalty)\n        const pausePenalty = Math.min(pauseCount * 0.02, 0.2);\n\n        // Calculate final score (0-1 range)\n        let focusScore = workRatio - pausePenalty;\n\n        // Ensure score is between 0 and 1\n        focusScore = Math.max(0, Math.min(1, focusScore));\n\n        return focusScore;\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport interface AIProfileProps extends EntityProps {\n    userId: string;\n    peakHours: Record<number, number>; // hour (0-23) -> productivity score (0-1)\n    peakDays: Record<number, number>; // day of week (0-6) -> productivity score (0-1)\n    avgTaskDuration: number; // in minutes\n    completionRate: number; // 0-1 (percentage)\n    categoryPreferences: Record<string, number>; // category -> preference score (0-1)\n    updatedAt?: Date;\n}\n\nexport class AIProfile extends Entity<AIProfileProps> {\n    constructor(props: AIProfileProps) {\n        super({\n            ...props,\n            peakHours: props.peakHours ?? {},\n            peakDays: props.peakDays ?? {},\n            avgTaskDuration: props.avgTaskDuration ?? 30,\n            completionRate: props.completionRate ?? 0.7,\n            categoryPreferences: props.categoryPreferences ?? {},\n            updatedAt: props.updatedAt ?? new Date(),\n        });\n    }\n\n    static create(userId: string): AIProfile {\n        return new AIProfile({\n            userId,\n            peakHours: {},\n            peakDays: {},\n            avgTaskDuration: 30,\n            completionRate: 0.7,\n            categoryPreferences: {},\n        });\n    }\n\n    /**\n     * Update productivity score for a specific hour of the day (0-23)\n     * Uses exponential moving average to smooth out variations\n     */\n    updatePeakHour(hour: number, score: number): AIProfile {\n        if (hour < 0 || hour > 23) {\n            throw new Error(\"Hour must be between 0 and 23\");\n        }\n        if (score < 0 || score > 1) {\n            throw new Error(\"Score must be between 0 and 1\");\n        }\n\n        const currentScore = this.props.peakHours[hour] ?? 0.5;\n        // Exponential moving average: 70% old value, 30% new value\n        const newScore = currentScore * 0.7 + score * 0.3;\n\n        return this.clone({\n            peakHours: {\n                ...this.props.peakHours,\n                [hour]: newScore,\n            },\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Update productivity score for a specific day of the week (0=Sunday, 6=Saturday)\n     * Uses exponential moving average to smooth out variations\n     */\n    updatePeakDay(dayOfWeek: number, score: number): AIProfile {\n        if (dayOfWeek < 0 || dayOfWeek > 6) {\n            throw new Error(\"Day of week must be between 0 and 6\");\n        }\n        if (score < 0 || score > 1) {\n            throw new Error(\"Score must be between 0 and 1\");\n        }\n\n        const currentScore = this.props.peakDays[dayOfWeek] ?? 0.5;\n        // Exponential moving average: 70% old value, 30% new value\n        const newScore = currentScore * 0.7 + score * 0.3;\n\n        return this.clone({\n            peakDays: {\n                ...this.props.peakDays,\n                [dayOfWeek]: newScore,\n            },\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Recalculate average task duration based on recent completed tasks\n     * Uses exponential moving average to give more weight to recent data\n     */\n    recalculateAvgDuration(recentDurations: number[]): AIProfile {\n        if (recentDurations.length === 0) {\n            return this;\n        }\n\n        const avgRecent = recentDurations.reduce((sum, d) => sum + d, 0) / recentDurations.length;\n        // Exponential moving average: 60% old value, 40% new value\n        const newAvg = this.props.avgTaskDuration * 0.6 + avgRecent * 0.4;\n\n        return this.clone({\n            avgTaskDuration: Math.round(newAvg),\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Update completion rate based on completed and total tasks\n     * Uses exponential moving average\n     */\n    updateCompletionRate(completed: number, total: number): AIProfile {\n        if (total === 0) {\n            return this;\n        }\n        if (completed > total) {\n            throw new Error(\"Completed tasks cannot exceed total tasks\");\n        }\n\n        const newRate = completed / total;\n        // Exponential moving average: 80% old value, 20% new value\n        const updatedRate = this.props.completionRate * 0.8 + newRate * 0.2;\n\n        return this.clone({\n            completionRate: Math.max(0, Math.min(1, updatedRate)),\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Update preference score for a category\n     * Higher score means user works better/prefers this category\n     */\n    updateCategoryPreference(category: string, score: number): AIProfile {\n        if (score < 0 || score > 1) {\n            throw new Error(\"Score must be between 0 and 1\");\n        }\n\n        const currentScore = this.props.categoryPreferences[category] ?? 0.5;\n        // Exponential moving average: 70% old value, 30% new value\n        const newScore = currentScore * 0.7 + score * 0.3;\n\n        return this.clone({\n            categoryPreferences: {\n                ...this.props.categoryPreferences,\n                [category]: newScore,\n            },\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Get the top N most productive hours\n     */\n    getTopPeakHours(limit: number = 3): number[] {\n        return Object.entries(this.props.peakHours)\n            .sort(([, a], [, b]) => b - a)\n            .slice(0, limit)\n            .map(([hour]) => parseInt(hour));\n    }\n\n    /**\n     * Get the top N most productive days\n     */\n    getTopPeakDays(limit: number = 3): number[] {\n        return Object.entries(this.props.peakDays)\n            .sort(([, a], [, b]) => b - a)\n            .slice(0, limit)\n            .map(([day]) => parseInt(day));\n    }\n\n    /**\n     * Get the top N preferred categories\n     */\n    getTopCategories(limit: number = 5): string[] {\n        return Object.entries(this.props.categoryPreferences)\n            .sort(([, a], [, b]) => b - a)\n            .slice(0, limit)\n            .map(([category]) => category);\n    }\n\n    /**\n     * Check if a specific hour is a peak productivity hour (score > 0.7)\n     */\n    isPeakHour(hour: number): boolean {\n        return (this.props.peakHours[hour] ?? 0) > 0.7;\n    }\n\n    /**\n     * Check if a specific day is a peak productivity day (score > 0.7)\n     */\n    isPeakDay(dayOfWeek: number): boolean {\n        return (this.props.peakDays[dayOfWeek] ?? 0) > 0.7;\n    }\n}\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type ReportScope =\n  | \"TASK_COMPLETION\"\n  | \"PROJECT_SUMMARY\"\n  | \"PERSONAL_ANALYSIS\"\n  | \"WEEKLY_SCHEDULED\"\n  | \"MONTHLY_SCHEDULED\";\n\nexport interface MetricsSnapshot {\n  tasksCreated?: number;\n  tasksCompleted?: number;\n  minutesWorked?: number;\n  pomodorosCompleted?: number;\n  focusScore?: number;\n  sessionsCount?: number;\n}\n\nexport interface ProductivityReportProps extends EntityProps {\n  userId: string;\n  taskId?: string;\n  projectId?: string;\n  scope: ReportScope;\n\n  // AI-generated insights\n  summary: string;\n  strengths: string[];\n  weaknesses: string[];\n  recommendations: string[];\n  patterns: string[];\n  productivityScore: number; // 0-100\n\n  // Historical snapshot\n  metricsSnapshot: MetricsSnapshot;\n\n  // Metadata\n  generatedAt?: Date;\n  aiModel?: string;\n}\n\nexport class ProductivityReport extends Entity<ProductivityReportProps> {\n  constructor(props: ProductivityReportProps) {\n    super({\n      ...props,\n      strengths: props.strengths ?? [],\n      weaknesses: props.weaknesses ?? [],\n      recommendations: props.recommendations ?? [],\n      patterns: props.patterns ?? [],\n      productivityScore: Math.min(100, Math.max(0, props.productivityScore ?? 0)),\n      metricsSnapshot: props.metricsSnapshot ?? {},\n      generatedAt: props.generatedAt ?? new Date(),\n      aiModel: props.aiModel ?? \"gemini-2.0-flash-exp\",\n    });\n\n    // Validate productivityScore range\n    if (props.productivityScore < 0 || props.productivityScore > 100) {\n      throw new Error(\"Productivity score must be between 0 and 100\");\n    }\n\n    // Validate summary is not empty\n    if (!props.summary || props.summary.trim().length === 0) {\n      throw new Error(\"Summary cannot be empty\");\n    }\n  }\n\n  static create(props: Omit<ProductivityReportProps, \"id\" | \"generatedAt\" | \"aiModel\">): ProductivityReport {\n    return new ProductivityReport({\n      ...props,\n      generatedAt: new Date(),\n      aiModel: \"gemini-2.0-flash-exp\",\n    });\n  }\n\n  /**\n   * Get a human-readable label for the scope\n   */\n  getScopeLabel(): string {\n    switch (this.props.scope) {\n      case \"TASK_COMPLETION\":\n        return \"Task Completion Report\";\n      case \"PROJECT_SUMMARY\":\n        return \"Project Summary\";\n      case \"PERSONAL_ANALYSIS\":\n        return \"Personal Analysis\";\n      case \"WEEKLY_SCHEDULED\":\n        return \"Weekly Report\";\n      case \"MONTHLY_SCHEDULED\":\n        return \"Monthly Report\";\n      default:\n        return \"Report\";\n    }\n  }\n\n  /**\n   * Get a color for the productivity score\n   */\n  getScoreColor(): \"green\" | \"yellow\" | \"red\" {\n    if (this.props.productivityScore >= 80) return \"green\";\n    if (this.props.productivityScore >= 60) return \"yellow\";\n    return \"red\";\n  }\n\n  /**\n   * Check if this is a good productivity score\n   */\n  isGoodScore(): boolean {\n    return this.props.productivityScore >= 70;\n  }\n\n  /**\n   * Get a summary of the metrics snapshot\n   */\n  getMetricsSummary(): string {\n    const m = this.props.metricsSnapshot;\n    const parts: string[] = [];\n\n    if (m.tasksCompleted !== undefined) {\n      parts.push(`${m.tasksCompleted} tasks completed`);\n    }\n    if (m.minutesWorked !== undefined) {\n      const hours = Math.floor(m.minutesWorked / 60);\n      const mins = m.minutesWorked % 60;\n      if (hours > 0) {\n        parts.push(`${hours}h ${mins}m worked`);\n      } else {\n        parts.push(`${mins}m worked`);\n      }\n    }\n    if (m.pomodorosCompleted !== undefined && m.pomodorosCompleted > 0) {\n      parts.push(`${m.pomodorosCompleted} pomodoros`);\n    }\n\n    return parts.join(\", \") || \"No metrics available\";\n  }\n\n  /**\n   * Check if this report has actionable recommendations\n   */\n  hasRecommendations(): boolean {\n    return this.props.recommendations.length > 0;\n  }\n\n  /**\n   * Get the top N recommendations\n   */\n  getTopRecommendations(limit: number = 3): string[] {\n    return this.props.recommendations.slice(0, limit);\n  }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { TimeSession } from \"../../timer/model/time-session.entity\";\nimport { AIProfile } from \"../model/ai-profile.entity\";\nimport { AIProfileRepository } from \"../provider/ai-profile.repository\";\n\nexport interface LearnFromSessionInput {\n    session: TimeSession;\n}\n\nexport class LearnFromSessionUseCase implements UseCase<LearnFromSessionInput, AIProfile> {\n    constructor(private readonly aiProfileRepository: AIProfileRepository) {}\n\n    async execute(input: LearnFromSessionInput): Promise<AIProfile> {\n        const { session } = input;\n\n        // Only learn from completed WORK or CONTINUOUS sessions\n        if (!session.props.wasCompleted) {\n            throw new Error(\"Can only learn from completed sessions\");\n        }\n        if (session.props.type !== \"WORK\" && session.props.type !== \"CONTINUOUS\") {\n            throw new Error(\"Can only learn from WORK or CONTINUOUS sessions\");\n        }\n\n        // Get or create AI profile for the user\n        const profile = await this.aiProfileRepository.findOrCreate(session.props.userId);\n\n        // Extract temporal information\n        const startedAt = session.props.startedAt;\n        const hour = startedAt.getHours(); // 0-23\n        const dayOfWeek = startedAt.getDay(); // 0-6 (0=Sunday)\n\n        // Calculate productivity score based on:\n        // 1. Focus score (fewer pauses = higher score)\n        // 2. Completion status (completed = bonus)\n        // 3. Duration (longer focused time = better)\n        const productivityScore = this.calculateProductivityScore(session);\n\n        // Update peak hours and peak days\n        let updatedProfile = profile\n            .updatePeakHour(hour, productivityScore)\n            .updatePeakDay(dayOfWeek, productivityScore);\n\n        // Update average task duration if this was a task-based session\n        if (session.props.taskId && session.props.duration) {\n            // For now, we'll just use the current duration\n            // In a real scenario, we'd query recent task durations\n            updatedProfile = updatedProfile.recalculateAvgDuration([session.props.duration]);\n        }\n\n        // Save the updated profile\n        return await this.aiProfileRepository.update(updatedProfile);\n    }\n\n    /**\n     * Calculate productivity score based on session characteristics\n     * Returns a value between 0 and 1\n     */\n    private calculateProductivityScore(session: TimeSession): number {\n        const duration = session.props.duration ?? 0; // in minutes\n        const pauseCount = session.props.pauseCount ?? 0;\n        const totalPauseTime = session.props.totalPauseTime ?? 0; // in seconds\n        const wasCompleted = session.props.wasCompleted;\n\n        // Base score starts at 0.5\n        let score = 0.5;\n\n        // Bonus for completion (up to +0.2)\n        if (wasCompleted) {\n            score += 0.2;\n        }\n\n        // Duration factor (longer focused work = better, up to +0.2)\n        // Sessions of 25-50 minutes are ideal\n        if (duration >= 25 && duration <= 50) {\n            score += 0.2;\n        } else if (duration >= 10 && duration < 25) {\n            score += 0.1;\n        } else if (duration > 50) {\n            // Very long sessions might indicate less focus\n            score += 0.1;\n        }\n\n        // Pause penalty (fewer pauses = better)\n        // Deduct 0.05 per pause, but cap at -0.3\n        const pausePenalty = Math.min(pauseCount * 0.05, 0.3);\n        score -= pausePenalty;\n\n        // Calculate focus score (work time vs pause time)\n        if (duration > 0) {\n            const totalSessionTime = (duration * 60) + totalPauseTime; // convert to seconds\n            const workTimeRatio = (duration * 60) / totalSessionTime;\n\n            // If work time ratio is high, add bonus (up to +0.2)\n            if (workTimeRatio >= 0.9) {\n                score += 0.2;\n            } else if (workTimeRatio >= 0.8) {\n                score += 0.15;\n            } else if (workTimeRatio >= 0.7) {\n                score += 0.1;\n            } else if (workTimeRatio < 0.5) {\n                // Penalize if more pause time than work time\n                score -= 0.2;\n            }\n        }\n\n        // Ensure score is between 0 and 1\n        return Math.max(0, Math.min(1, score));\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { AIProfile } from \"../model/ai-profile.entity\";\nimport { AIProfileRepository } from \"../provider/ai-profile.repository\";\n\nexport interface GetOptimalScheduleInput {\n    userId: string;\n    topN?: number; // Number of hours to return (default: 5)\n}\n\nexport interface OptimalScheduleOutput {\n    peakHours: Array<{\n        hour: number; // 0-23\n        score: number; // 0-1\n        label: string; // e.g., \"9:00 AM\"\n    }>;\n    peakDays: Array<{\n        day: number; // 0-6 (0=Sunday)\n        score: number; // 0-1\n        label: string; // e.g., \"Monday\"\n    }>;\n    recommendation: string;\n}\n\nconst DAY_NAMES = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n\nexport class GetOptimalScheduleUseCase implements UseCase<GetOptimalScheduleInput, OptimalScheduleOutput> {\n    constructor(private readonly aiProfileRepository: AIProfileRepository) {}\n\n    async execute(input: GetOptimalScheduleInput): Promise<OptimalScheduleOutput> {\n        const { userId, topN = 5 } = input;\n\n        // Get AI profile for the user\n        const profile = await this.aiProfileRepository.findByUserId(userId);\n\n        if (!profile) {\n            // Return default recommendation if no profile exists yet\n            return {\n                peakHours: [],\n                peakDays: [],\n                recommendation: \"Start tracking your work sessions to get personalized productivity insights!\",\n            };\n        }\n\n        // Get top peak hours\n        const topPeakHours = this.getTopPeakHours(profile, topN);\n\n        // Get top peak days\n        const topPeakDays = this.getTopPeakDays(profile, 3); // Always show top 3 days\n\n        // Generate recommendation\n        const recommendation = this.generateRecommendation(profile, topPeakHours, topPeakDays);\n\n        return {\n            peakHours: topPeakHours,\n            peakDays: topPeakDays,\n            recommendation,\n        };\n    }\n\n    private getTopPeakHours(profile: AIProfile, limit: number): Array<{ hour: number; score: number; label: string }> {\n        const peakHours = profile.props.peakHours;\n\n        return Object.entries(peakHours)\n            .map(([hour, score]) => ({\n                hour: parseInt(hour),\n                score,\n                label: this.formatHour(parseInt(hour)),\n            }))\n            .sort((a, b) => b.score - a.score)\n            .slice(0, limit);\n    }\n\n    private getTopPeakDays(profile: AIProfile, limit: number): Array<{ day: number; score: number; label: string }> {\n        const peakDays = profile.props.peakDays;\n\n        return Object.entries(peakDays)\n            .map(([day, score]) => {\n                const dayNum = parseInt(day);\n                return {\n                    day: dayNum,\n                    score,\n                    label: DAY_NAMES[dayNum] || \"Unknown\",\n                };\n            })\n            .sort((a, b) => b.score - a.score)\n            .slice(0, limit);\n    }\n\n    private formatHour(hour: number): string {\n        const period = hour >= 12 ? \"PM\" : \"AM\";\n        const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;\n        return `${displayHour}:00 ${period}`;\n    }\n\n    private generateRecommendation(\n        profile: AIProfile,\n        topHours: Array<{ hour: number; score: number; label: string }>,\n        topDays: Array<{ day: number; score: number; label: string }>\n    ): string {\n        if (topHours.length === 0 && topDays.length === 0) {\n            return \"Keep tracking your work sessions to discover your peak productivity times!\";\n        }\n\n        const parts: string[] = [];\n\n        // Hours recommendation\n        if (topHours.length > 0) {\n            const bestHour = topHours[0];\n            if (bestHour && bestHour.score > 0.7) {\n                const hourList = topHours.slice(0, 3).map((h) => h.label).join(\", \");\n                parts.push(`Your peak productivity hours are ${hourList}.`);\n            } else if (bestHour && bestHour.score > 0.5) {\n                parts.push(`You work well during ${bestHour.label}.`);\n            }\n        }\n\n        // Days recommendation\n        if (topDays.length > 0) {\n            const bestDay = topDays[0];\n            if (bestDay && bestDay.score > 0.7) {\n                const dayList = topDays.slice(0, 2).map((d) => d.label).join(\" and \");\n                parts.push(`You're most productive on ${dayList}.`);\n            }\n        }\n\n        // Task duration insight\n        const avgDuration = profile.props.avgTaskDuration;\n        if (avgDuration > 0) {\n            parts.push(`Your average focused work session is ${avgDuration} minutes.`);\n        }\n\n        // Completion rate insight\n        const completionRate = profile.props.completionRate;\n        if (completionRate >= 0.8) {\n            parts.push(`You have an excellent task completion rate of ${Math.round(completionRate * 100)}%!`);\n        } else if (completionRate < 0.5) {\n            parts.push(`Try breaking tasks into smaller chunks to improve your ${Math.round(completionRate * 100)}% completion rate.`);\n        }\n\n        return parts.join(\" \") || \"Keep working to build your productivity profile!\";\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { AIProfile } from \"../model/ai-profile.entity\";\nimport { AIProfileRepository } from \"../provider/ai-profile.repository\";\n\nexport interface PredictTaskDurationInput {\n    userId: string;\n    taskTitle?: string;\n    taskDescription?: string;\n    category?: string;\n    priority?: \"LOW\" | \"MEDIUM\" | \"HIGH\" | \"URGENT\";\n}\n\nexport interface PredictTaskDurationOutput {\n    estimatedMinutes: number;\n    confidence: \"LOW\" | \"MEDIUM\" | \"HIGH\";\n    reasoning: string;\n}\n\nexport class PredictTaskDurationUseCase implements UseCase<PredictTaskDurationInput, PredictTaskDurationOutput> {\n    constructor(private readonly aiProfileRepository: AIProfileRepository) {}\n\n    async execute(input: PredictTaskDurationInput): Promise<PredictTaskDurationOutput> {\n        const { userId, taskTitle, taskDescription, category, priority } = input;\n\n        // Get AI profile for the user\n        const profile = await this.aiProfileRepository.findByUserId(userId);\n\n        if (!profile) {\n            // Return default estimate if no profile exists\n            return {\n                estimatedMinutes: 30,\n                confidence: \"LOW\",\n                reasoning: \"Using default estimate of 30 minutes. Complete more tasks to get personalized predictions!\",\n            };\n        }\n\n        // Base estimate from user's average\n        let estimatedMinutes = profile.props.avgTaskDuration;\n        let confidence: \"LOW\" | \"MEDIUM\" | \"HIGH\" = \"MEDIUM\";\n        const reasoningParts: string[] = [];\n\n        // Adjust based on category preference\n        if (category && profile.props.categoryPreferences[category]) {\n            const categoryScore = profile.props.categoryPreferences[category];\n\n            if (categoryScore > 0.7) {\n                // User is efficient in this category, reduce estimate by 15%\n                estimatedMinutes *= 0.85;\n                reasoningParts.push(`You're efficient with ${category} tasks (-15%)`);\n                confidence = \"HIGH\";\n            } else if (categoryScore < 0.4) {\n                // User struggles with this category, increase estimate by 20%\n                estimatedMinutes *= 1.2;\n                reasoningParts.push(`${category} tasks typically take you longer (+20%)`);\n                confidence = \"MEDIUM\";\n            }\n        }\n\n        // Adjust based on priority\n        if (priority) {\n            switch (priority) {\n                case \"URGENT\":\n                    // Urgent tasks often take less time due to focus\n                    estimatedMinutes *= 0.9;\n                    reasoningParts.push(\"Urgent priority tends to increase focus (-10%)\");\n                    break;\n                case \"HIGH\":\n                    // High priority tasks might be more complex\n                    estimatedMinutes *= 1.1;\n                    reasoningParts.push(\"High priority suggests complexity (+10%)\");\n                    break;\n                case \"LOW\":\n                    // Low priority tasks might be simpler\n                    estimatedMinutes *= 0.85;\n                    reasoningParts.push(\"Low priority typically means simpler tasks (-15%)\");\n                    break;\n            }\n        }\n\n        // Analyze task title/description for complexity indicators\n        const text = `${taskTitle || \"\"} ${taskDescription || \"\"}`.toLowerCase();\n\n        if (this.containsComplexityKeywords(text, [\"refactor\", \"redesign\", \"architecture\", \"migration\"])) {\n            estimatedMinutes *= 1.5;\n            reasoningParts.push(\"Complex task keywords detected (+50%)\");\n        } else if (this.containsComplexityKeywords(text, [\"fix\", \"bug\", \"issue\", \"debug\"])) {\n            estimatedMinutes *= 1.2;\n            reasoningParts.push(\"Debugging tasks can be unpredictable (+20%)\");\n        } else if (this.containsComplexityKeywords(text, [\"simple\", \"quick\", \"minor\", \"small\"])) {\n            estimatedMinutes *= 0.75;\n            reasoningParts.push(\"Simple task indicators found (-25%)\");\n        }\n\n        // Round to nearest 5 minutes\n        estimatedMinutes = Math.round(estimatedMinutes / 5) * 5;\n\n        // Ensure minimum of 10 minutes\n        estimatedMinutes = Math.max(10, estimatedMinutes);\n\n        // Build reasoning\n        let reasoning = `Based on your average of ${profile.props.avgTaskDuration} minutes`;\n        if (reasoningParts.length > 0) {\n            reasoning += `. ${reasoningParts.join(\". \")}.`;\n        } else {\n            reasoning += \".\";\n        }\n\n        // Adjust confidence based on data availability\n        if (!category && !priority && !taskTitle && !taskDescription) {\n            confidence = \"LOW\";\n        }\n\n        return {\n            estimatedMinutes,\n            confidence,\n            reasoning,\n        };\n    }\n\n    private containsComplexityKeywords(text: string, keywords: string[]): boolean {\n        return keywords.some((keyword) => text.includes(keyword));\n    }\n}\n","import { UseCase } from \"../../shared/use-case\";\nimport { ProductivityReport } from \"../model/productivity-report.entity\";\nimport { ProductivityReportRepository } from \"../provider/productivity-report.repository\";\nimport type { AnalyticsRepository } from \"../../analytics/provider/analytics.repository\";\nimport type { TimerRepository } from \"../../timer/provider/timer.repository\";\nimport type { AIProfileRepository } from \"../provider/ai-profile.repository\";\nimport type { DailyMetrics } from \"../../analytics/model/daily-metrics.entity\";\nimport type { TimeSession } from \"../../timer/model/time-session.entity\";\n\nexport interface GenerateWeeklyReportInput {\n  userId: string;\n  weekStart?: Date; // If not provided, use current week\n}\n\nexport interface GenerateWeeklyReportOutput {\n  report: ProductivityReport;\n  isNew: boolean; // true if report was newly generated, false if existing\n}\n\n/**\n * Data needed from external AI service\n */\nexport interface WeeklyReportData {\n  summary: string;\n  strengths: string[];\n  weaknesses: string[];\n  recommendations: string[];\n  patterns: string[];\n  productivityScore: number;\n}\n\nexport interface WeeklyReportContext {\n  userId: string;\n  scope: string;\n  metricsSnapshot: {\n    tasksCreated: number;\n    tasksCompleted: number;\n    minutesWorked: number;\n    pomodorosCompleted: number;\n    focusScore: number;\n    sessionsCount: number;\n  };\n  sessions: Array<{\n    startedAt: Date;\n    endedAt?: Date;\n    duration?: number;\n    taskId?: string;\n    userId: string;\n    type: string;\n    wasCompleted: boolean;\n  }>;\n  profile?: {\n    userId: string;\n    peakHours: Record<number, number>;\n    peakDays: Record<number, number>;\n    avgTaskDuration: number;\n    completionRate: number;\n    categoryPreferences: Record<string, number>;\n  };\n}\n\nexport class GenerateWeeklyReportUseCase implements UseCase<\n  GenerateWeeklyReportInput,\n  GenerateWeeklyReportOutput\n> {\n  constructor(\n    private readonly reportRepository: ProductivityReportRepository,\n    private readonly analyticsRepository: AnalyticsRepository,\n    private readonly timerRepository: TimerRepository,\n    private readonly aiProfileRepository: AIProfileRepository,\n    private readonly generateReportData: (\n      context: WeeklyReportContext,\n    ) => Promise<WeeklyReportData>,\n  ) {}\n\n  async execute(\n    input: GenerateWeeklyReportInput,\n  ): Promise<GenerateWeeklyReportOutput> {\n    const { userId, weekStart } = input;\n\n    // Calculate week range\n    const startDate = weekStart || this.getWeekStart(new Date());\n    const endDate = new Date(startDate);\n    endDate.setDate(endDate.getDate() + 6);\n\n    // Check if report already exists for this week\n    const existing = await this.reportRepository.findLatestByScope(\n      userId,\n      \"WEEKLY_SCHEDULED\",\n    );\n\n    if (existing && this.isSameWeek(existing.props.generatedAt!, startDate)) {\n      return { report: existing, isNew: false };\n    }\n\n    // Gather data for report generation\n    const [dailyMetrics, sessions, profile] = await Promise.all([\n      this.analyticsRepository.getRange(userId, startDate, endDate),\n      this.timerRepository.findByUserIdAndDateRange(userId, startDate, endDate),\n      this.aiProfileRepository.findByUserId(userId),\n    ]);\n\n    // Calculate metrics snapshot\n    const metricsSnapshot = {\n      tasksCreated: dailyMetrics.reduce(\n        (sum: number, m: DailyMetrics) => sum + m.props.tasksCreated,\n        0,\n      ),\n      tasksCompleted: dailyMetrics.reduce(\n        (sum: number, m: DailyMetrics) => sum + m.props.tasksCompleted,\n        0,\n      ),\n      minutesWorked: dailyMetrics.reduce(\n        (sum: number, m: DailyMetrics) => sum + m.props.minutesWorked,\n        0,\n      ),\n      pomodorosCompleted: dailyMetrics.reduce(\n        (sum: number, m: DailyMetrics) => sum + m.props.pomodorosCompleted,\n        0,\n      ),\n      focusScore:\n        dailyMetrics.length > 0\n          ? dailyMetrics.reduce(\n              (sum: number, m: DailyMetrics) => sum + (m.props.focusScore ?? 0),\n              0,\n            ) / dailyMetrics.length\n          : 0,\n      sessionsCount: sessions.length,\n    };\n\n    // Generate AI insights\n    const reportData = await this.generateReportData({\n      userId,\n      scope: \"WEEKLY_SCHEDULED\",\n      metricsSnapshot,\n      sessions: sessions.map((s: TimeSession) => s.props),\n      profile: profile?.props,\n    });\n\n    // Create and save report\n    const report = ProductivityReport.create({\n      userId,\n      scope: \"WEEKLY_SCHEDULED\",\n      summary: reportData.summary,\n      strengths: reportData.strengths,\n      weaknesses: reportData.weaknesses,\n      recommendations: reportData.recommendations,\n      patterns: reportData.patterns,\n      productivityScore: reportData.productivityScore,\n      metricsSnapshot,\n    });\n\n    const savedReport = await this.reportRepository.save(report);\n\n    return { report: savedReport, isNew: true };\n  }\n\n  /**\n   * Get the start of the week (Monday) for a given date\n   */\n  private getWeekStart(date: Date): Date {\n    const d = new Date(date);\n    const day = d.getDay();\n    const diff = d.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday\n    return new Date(d.setDate(diff));\n  }\n\n  /**\n   * Check if two dates are in the same week\n   */\n  private isSameWeek(date1: Date, date2: Date): boolean {\n    const start1 = this.getWeekStart(date1);\n    const start2 = this.getWeekStart(date2);\n    return start1.getTime() === start2.getTime();\n  }\n}\n","export interface AIChatContext {\n  userId?: string;\n  workspaceId?: string;\n  projectId?: string;\n  taskId?: string;\n  conversationHistory?: Array<{\n    role: \"user\" | \"assistant\";\n    content: string;\n    timestamp: Date;\n  }>;\n}\n\nexport interface AIService {\n  suggestTaskDetails(input: string): Promise<{\n    title: string;\n    description?: string;\n    dueDate?: Date;\n    priority?: \"LOW\" | \"MEDIUM\" | \"HIGH\" | \"URGENT\";\n  }>;\n\n  chat(message: string, context?: AIChatContext): Promise<string>;\n}\n\nexport class MockAIService implements AIService {\n  async suggestTaskDetails(input: string) {\n    // Simulate AI processing\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n\n    const lowerInput = input.toLowerCase();\n    let priority: \"LOW\" | \"MEDIUM\" | \"HIGH\" | \"URGENT\" = \"MEDIUM\";\n\n    if (lowerInput.includes(\"urgente\") || lowerInput.includes(\"asap\")) {\n      priority = \"URGENT\";\n    } else if (lowerInput.includes(\"importante\")) {\n      priority = \"HIGH\";\n    }\n\n    let dueDate = undefined;\n    if (lowerInput.includes(\"mañana\")) {\n      const tomorrow = new Date();\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      dueDate = tomorrow;\n    } else if (lowerInput.includes(\"hoy\")) {\n      dueDate = new Date();\n    }\n\n    return {\n      title: input,\n      description: \"Generated by Ordo AI based on your input.\",\n      priority,\n      dueDate,\n    };\n  }\n\n  async chat(message: string, context?: AIChatContext) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    return `I am Ordo AI. You said: \"${message}\". I am currently in development mode.`;\n  }\n}\n\nexport const aiService = new MockAIService();\n","import { Entity, EntityProps } from \"../../shared/entity\";\n\nexport type HabitFrequency = \"DAILY\" | \"WEEKLY\" | \"SPECIFIC_DAYS\" | \"MONTHLY\";\nexport type TimeOfDay = \"MORNING\" | \"AFTERNOON\" | \"EVENING\" | \"ANYTIME\";\n\nexport interface HabitCompletionProps extends EntityProps {\n    habitId: string;\n    completedAt: Date;\n    completedDate: Date;\n    note?: string;\n    value?: number;\n}\n\nexport interface HabitProps extends EntityProps {\n    name: string;\n    description?: string;\n    icon?: string;\n    color: string;\n    userId: string;\n    workspaceId?: string;\n\n    // Schedule\n    frequency: HabitFrequency;\n    targetDaysOfWeek: number[];\n    targetCount: number;\n    preferredTime?: string;\n    timeOfDay?: TimeOfDay;\n\n    // Gamification\n    currentStreak: number;\n    longestStreak: number;\n    totalCompletions: number;\n\n    // State\n    isActive: boolean;\n    isPaused: boolean;\n    pausedAt?: Date;\n    archivedAt?: Date;\n\n    // Completions\n    completions?: HabitCompletionProps[];\n\n    // Timestamps\n    createdAt?: Date;\n    updatedAt?: Date;\n}\n\nexport class Habit extends Entity<HabitProps> {\n    constructor(props: HabitProps) {\n        super({\n            ...props,\n            frequency: props.frequency ?? \"DAILY\",\n            targetDaysOfWeek: props.targetDaysOfWeek ?? [0, 1, 2, 3, 4, 5, 6],\n            targetCount: props.targetCount ?? 1,\n            color: props.color ?? \"#10B981\",\n            currentStreak: props.currentStreak ?? 0,\n            longestStreak: props.longestStreak ?? 0,\n            totalCompletions: props.totalCompletions ?? 0,\n            isActive: props.isActive ?? true,\n            isPaused: props.isPaused ?? false,\n            completions: props.completions ?? [],\n            createdAt: props.createdAt ?? new Date(),\n            updatedAt: props.updatedAt ?? new Date(),\n        });\n    }\n\n    static create(\n        props: Omit<\n            HabitProps,\n            | \"id\"\n            | \"currentStreak\"\n            | \"longestStreak\"\n            | \"totalCompletions\"\n            | \"createdAt\"\n            | \"updatedAt\"\n            | \"isActive\"\n            | \"isPaused\"\n        >\n    ): Habit {\n        return new Habit({\n            ...props,\n            currentStreak: 0,\n            longestStreak: 0,\n            totalCompletions: 0,\n            isActive: true,\n            isPaused: false,\n        });\n    }\n\n    /**\n     * Check if habit is scheduled for a given day of week (0=Sunday, 6=Saturday)\n     */\n    isScheduledForDay(dayOfWeek: number): boolean {\n        if (this.props.frequency === \"DAILY\") {\n            return true;\n        }\n        if (this.props.frequency === \"SPECIFIC_DAYS\") {\n            return this.props.targetDaysOfWeek.includes(dayOfWeek);\n        }\n        // For WEEKLY and MONTHLY, we need more context\n        return true;\n    }\n\n    /**\n     * Mark habit as completed, updating streak\n     */\n    complete(isConsecutive: boolean = true): Habit {\n        const newTotal = this.props.totalCompletions + 1;\n        const newStreak = isConsecutive ? this.props.currentStreak + 1 : 1;\n        const newLongest = Math.max(this.props.longestStreak, newStreak);\n\n        return this.clone({\n            totalCompletions: newTotal,\n            currentStreak: newStreak,\n            longestStreak: newLongest,\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Reset streak (when habit is missed)\n     */\n    resetStreak(): Habit {\n        return this.clone({\n            currentStreak: 0,\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Pause habit tracking (vacation, illness, etc.)\n     */\n    pause(): Habit {\n        return this.clone({\n            isPaused: true,\n            pausedAt: new Date(),\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Resume habit tracking\n     */\n    resume(): Habit {\n        return this.clone({\n            isPaused: false,\n            pausedAt: undefined,\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Archive habit (soft delete)\n     */\n    archive(): Habit {\n        return this.clone({\n            isActive: false,\n            archivedAt: new Date(),\n            updatedAt: new Date(),\n        });\n    }\n\n    /**\n     * Update habit properties\n     */\n    update(\n        props: Partial<\n            Omit<HabitProps, \"id\" | \"userId\" | \"createdAt\" | \"currentStreak\" | \"longestStreak\" | \"totalCompletions\">\n        >\n    ): Habit {\n        return this.clone({\n            ...props,\n            updatedAt: new Date(),\n        });\n    }\n}\n"],"mappings":"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","names":["index_exports","__export","AIProfile","AcceptInvitationUseCase","AddMemberToWorkspaceUseCase","ArchiveProjectUseCase","ArchiveWorkspaceUseCase","AssignTagToTaskUseCase","COMMENT_LIMITS","CalculateFocusScoreUseCase","ChangeUserName","CompleteTaskUseCase","CreateAuditLogUseCase","CreateProjectUseCase","CreateTagUseCase","CreateTaskUseCase","CreateWorkflowUseCase","CreateWorkspaceUseCase","DEFAULT_POMODORO_SETTINGS","DailyMetrics","DeleteProjectUseCase","DeleteWorkflowUseCase","Email","Entity","FILE_LIMITS","GenerateWeeklyReportUseCase","GetDailyMetricsUseCase","GetDeletedProjectsUseCase","GetDeletedTasksUseCase","GetDeletedWorkspacesUseCase","GetOptimalScheduleUseCase","GetWorkspaceAuditLogsUseCase","GetWorkspaceSettingsUseCase","Habit","HashPassword","Id","InviteMemberUseCase","LearnFromSessionUseCase","ListWorkflowsUseCase","MEMBER_ROLES","MockAIService","PAGINATION_LIMITS","PRIORITY_VALUES","PROJECT_COLORS","PROJECT_LIMITS","PROJECT_STATUS","PROJECT_STATUS_VALUES","PauseTimerUseCase","PermanentDeleteProjectUseCase","PermanentDeleteTaskUseCase","PermanentDeleteWorkspaceUseCase","PersonName","PredictTaskDurationUseCase","ProductivityReport","Project","RegisterUser","RemoveMemberFromWorkspaceUseCase","RemoveTagFromTaskUseCase","RequiredString","RestoreProjectUseCase","RestoreTaskUseCase","RestoreWorkspaceUseCase","ResumeTimerUseCase","SoftDeleteProjectUseCase","SoftDeleteTaskUseCase","SoftDeleteWorkspaceUseCase","StartTimerUseCase","StopTimerUseCase","SwitchTaskUseCase","TAG_COLORS","TAG_LIMITS","TASK_LIMITS","TASK_PRIORITIES","TASK_STATUS","TASK_STATUS_VALUES","TIMER_LIMITS","TIMER_MODES","TIMER_MODE_VALUES","Tag","Task","TimeSession","USER_LIMITS","UpdateDailyMetricsUseCase","UpdateProjectUseCase","UpdateTagUseCase","UpdateWorkflowUseCase","UpdateWorkspaceSettingsUseCase","User","UserByEmail","UserLogin","WORKSPACE_COLORS","WORKSPACE_LIMITS","WORKSPACE_TYPES","Workflow","Workspace","WorkspaceAuditLog","WorkspaceInvitation","WorkspaceMember","WorkspaceSettings","acceptInvitationSchema","addAlpha","addDays","addHours","addMinutes","aiService","archiveProjectSchema","assignTagsSchema","bulkUpdateTasksSchema","calculateAverageCompletionTime","calculateAverageTime","calculateBurndownRate","calculateCompletionRate","calculateEfficiency","calculateEstimatedCompletion","calculateFocusScore","calculatePercentile","calculateProductivityScore","calculateProgress","calculateProjectHealth","calculateStreak","calculateTimeUtilization","calculateTotalTimeWorked","calculateVelocity","calculateWeightedAverage","camelToTitle","capitalize","capitalizeWords","categorizeTasksByAvailability","changePasswordSchema","commentBaseSchema","commentFilterSchema","countWords","createCommentSchema","createProjectSchema","createTagSchema","createTaskSchema","createWorkspaceSchema","darkenColor","duplicateProjectSchema","endOfDay","endOfWeek","formatDate","formatDateShort","formatDuration","formatDurationFromSeconds","formatFileSize","formatNumber","formatRelativeTime","formatScheduledDateTime","formatTimeOfDay","formatTimerDisplay","formatTimerDisplayExtended","generateId","generatePalette","generateRandomString","generateSlug","getColorWithOpacity","getContrastColor","getCurrentTime","getDaysDiff","getInitials","getPriorityColor","getPriorityConfig","getPriorityLabel","getTaskStatusColor","getTaskStatusConfig","getTaskStatusLabel","getTimerModeColor","getTimerModeConfig","getTimerModeDefaultDuration","getTimerModeLabel","getWorkableTasks","hexToRgb","hexToRgba","highlightSearchTerms","hoursToMinutes","inviteMemberSchema","isAfter","isAllowedFileType","isAlphanumeric","isBefore","isDarkColor","isDueToday","isFuture","isImageFile","isLightColor","isOverdue","isPast","isScheduledForToday","isTaskAvailable","isTaskCompleted","isTaskInProgress","isToday","isValidEmail","isValidUrl","isWorkingHours","lightenColor","loginUserSchema","minutesToHours","minutesToSeconds","mixColors","normalizeWhitespace","parseDuration","pluralize","projectBaseSchema","projectFilterSchema","randomColor","registerUserSchema","reorderTasksSchema","resetPasswordRequestSchema","resetPasswordSchema","rgbToHex","sanitizeHtml","secondsToMinutes","shouldTakeLongBreak","snakeToTitle","startOfDay","startOfToday","startOfWeek","stripHtmlTags","tagBaseSchema","tagFilterSchema","taskBaseSchema","taskDatesSchema","taskFilterSchema","transferOwnershipSchema","truncate","updateCommentSchema","updateMemberRoleSchema","updateProjectSchema","updateTagSchema","updateTaskSchema","updateUserProfileSchema","updateWorkspaceSchema","userPreferencesSchema","usernameValidationSchema","workspaceBaseSchema","workspaceFilterSchema","workspaceSettingsSchema","__toCommonJS","Email","_Email","value","email","finalEmail","localPart","domainPart","other","HashPassword","_HashPassword","value","hashPassword","trimmedHash","other","PersonName","_PersonName","value","name","trimmedName","part","parts","nameParts","other","import_uuid","Id","_Id","value","id","uuidv4","isUuid","other","Entity","_Entity","props","mode","Id","entity","other","newProps","newMode","Self","RequiredString","_RequiredString","value","options","errorMessage","trimmedValue","other","PROJECT_COLORS","TAG_COLORS","WORKSPACE_COLORS","TASK_PRIORITIES","PRIORITY_VALUES","getPriorityConfig","priority","getPriorityColor","getPriorityLabel","TASK_STATUS","TASK_STATUS_VALUES","PROJECT_STATUS","PROJECT_STATUS_VALUES","getTaskStatusConfig","status","getTaskStatusColor","getTaskStatusLabel","isTaskCompleted","isTaskInProgress","TIMER_MODES","TIMER_MODE_VALUES","DEFAULT_POMODORO_SETTINGS","TIMER_LIMITS","getTimerModeConfig","mode","getTimerModeColor","getTimerModeLabel","getTimerModeDefaultDuration","shouldTakeLongBreak","completedPomodoros","pomodorosUntilLongBreak","TASK_LIMITS","PROJECT_LIMITS","WORKSPACE_LIMITS","TAG_LIMITS","COMMENT_LIMITS","FILE_LIMITS","USER_LIMITS","PAGINATION_LIMITS","formatFileSize","bytes","k","sizes","i","isAllowedFileType","mimeType","isImageFile","formatDate","date","locale","formatDateShort","formatRelativeTime","d","now","diffMs","diffSec","diffMin","diffHour","diffDay","isToday","today","isPast","isFuture","isOverdue","dueDate","getDaysDiff","date1","date2","d1","startOfDay","endOfDay","startOfWeek","day","diff","startDate","endOfWeek","endDate","addDays","days","addHours","hours","addMinutes","minutes","startOfToday","isBefore","d2","isAfter","isTaskAvailable","task","isScheduledForToday","isDueToday","categorizeTasksByAvailability","tasks","getWorkableTasks","t","formatScheduledDateTime","scheduledDate","scheduledTime","dateStr","formatDuration","minutes","hours","mins","formatDurationFromSeconds","seconds","secs","parts","formatTimerDisplay","formatTimerDisplayExtended","minutesToHours","hoursToMinutes","secondsToMinutes","minutesToSeconds","parseDuration","duration","hourMatch","minMatch","calculateTotalTimeWorked","timeEntries","total","entry","calculateAverageTime","totalMinutes","taskCount","formatTimeOfDay","time","use24Hour","period","getCurrentTime","now","isWorkingHours","date","startHour","endHour","hour","generateSlug","text","truncate","maxLength","ellipsis","capitalize","capitalizeWords","word","camelToTitle","result","snakeToTitle","getInitials","name","generateRandomString","length","chars","i","isValidEmail","email","isValidUrl","url","sanitizeHtml","map","char","normalizeWhitespace","countWords","pluralize","count","plural","formatNumber","num","generateId","isAlphanumeric","stripHtmlTags","html","highlightSearchTerms","searchTerm","regex","calculateProgress","completed","total","calculateCompletionRate","calculateProductivityScore","completedTasks","totalTasks","focusMinutes","targetFocusMinutes","taskScore","focusScore","calculateFocusScore","completedPomodoros","targetPomodoros","calculateAverageCompletionTime","tasks","t","totalTime","sum","task","created","calculateVelocity","days","calculateEstimatedCompletion","remainingTasks","velocity","daysNeeded","completionDate","calculateBurndownRate","initialTasks","elapsedDays","calculateProjectHealth","overdueTasks","targetVelocity","progressScore","overdueScore","velocityScore","calculateTimeUtilization","actualMinutes","estimatedMinutes","calculateEfficiency","totalMinutesWorked","tasksPerHour","calculateStreak","activityDates","sortedDates","d","a","b","streak","today","mostRecent","current","previous","calculatePercentile","value","values","sorted","index","v","calculateWeightedAverage","totalWeight","item","weightedSum","hexToRgb","hex","result","rgbToHex","g","b","toHex","x","getContrastColor","hexColor","rgb","lightenColor","percent","amount","r","darkenColor","addAlpha","alpha","a","hexToRgba","randomColor","isLightColor","isDarkColor","mixColors","color1","color2","weight","rgb1","rgb2","w","generatePalette","baseColor","getColorWithOpacity","opacity","import_zod","taskBaseSchema","TASK_LIMITS","PRIORITY_VALUES","TASK_STATUS_VALUES","val","taskDatesSchema","data","createTaskSchema","updateTaskSchema","taskFilterSchema","bulkUpdateTasksSchema","reorderTasksSchema","import_zod","projectBaseSchema","PROJECT_LIMITS","createProjectSchema","updateProjectSchema","projectFilterSchema","archiveProjectSchema","duplicateProjectSchema","import_zod","WORKSPACE_TYPES","MEMBER_ROLES","workspaceBaseSchema","WORKSPACE_LIMITS","createWorkspaceSchema","updateWorkspaceSchema","workspaceSettingsSchema","inviteMemberSchema","updateMemberRoleSchema","acceptInvitationSchema","transferOwnershipSchema","workspaceFilterSchema","import_zod","tagBaseSchema","TAG_LIMITS","createTagSchema","updateTagSchema","tagFilterSchema","assignTagsSchema","import_zod","registerUserSchema","USER_LIMITS","loginUserSchema","updateUserProfileSchema","changePasswordSchema","resetPasswordRequestSchema","resetPasswordSchema","userPreferencesSchema","usernameValidationSchema","import_zod","commentBaseSchema","COMMENT_LIMITS","createCommentSchema","updateCommentSchema","commentFilterSchema","User","_User","Entity","props","mode","PersonName","Email","HashPassword","ChangeUserName","repo","newName","loggedUser","validName","PersonName","existingUser","RegisterUser","repo","crypto","user","hashedPassword","newUser","User","UserByEmail","repo","email","user","UserLogin","repo","crypto","input","email","password","user","Task","_Task","Entity","props","status","CreateTaskUseCase","repository","input","task","Task","CompleteTaskUseCase","repository","input","task","completedTask","SoftDeleteTaskUseCase","taskRepository","id","RestoreTaskUseCase","taskRepository","id","task","PermanentDeleteTaskUseCase","taskRepository","id","task","GetDeletedTasksUseCase","taskRepository","projectId","Workspace","_Workspace","Entity","props","stats","WorkspaceMember","_WorkspaceMember","Entity","props","WorkspaceSettings","_WorkspaceSettings","Entity","props","WorkspaceAuditLog","_WorkspaceAuditLog","Entity","props","CreateWorkspaceUseCase","workspaceRepository","ownerUsername","props","username","workspaceNameSlug","finalSlug","counter","workspace","Workspace","name","AddMemberToWorkspaceUseCase","workspaceRepository","workspaceId","userId","role","existingMember","member","WorkspaceMember","RemoveMemberFromWorkspaceUseCase","workspaceRepository","workspaceId","userId","workspace","SoftDeleteWorkspaceUseCase","workspaceRepository","id","userId","workspace","RestoreWorkspaceUseCase","workspaceRepository","id","userId","workspace","PermanentDeleteWorkspaceUseCase","workspaceRepository","id","userId","workspace","GetDeletedWorkspacesUseCase","workspaceRepository","userId","ArchiveWorkspaceUseCase","workspaceRepository","id","userId","workspace","archivedWorkspace","WorkspaceInvitation","_WorkspaceInvitation","Entity","props","import_uuid","InviteMemberUseCase","workspaceRepository","invitationRepository","hashService","workspaceId","email","role","invitedById","token","uuidv4","tokenHash","expiresAt","invitation","WorkspaceInvitation","AcceptInvitationUseCase","workspaceRepository","invitationRepository","hashService","token","userId","pendingInvitations","matchedInvitation","invitation","workspaceId","acceptedInvitation","member","WorkspaceMember","UpdateWorkspaceSettingsUseCase","settingsRepository","input","existing","settings","WorkspaceSettings","GetWorkspaceSettingsUseCase","settingsRepository","input","CreateAuditLogUseCase","auditLogRepository","input","log","WorkspaceAuditLog","GetWorkspaceAuditLogsUseCase","auditLogRepository","input","limit","offset","logs","total","Project","_Project","Entity","props","CreateProjectUseCase","projectRepository","props","project","Project","UpdateProjectUseCase","projectRepository","id","props","project","updatedProject","ArchiveProjectUseCase","projectRepository","id","project","updatedProject","DeleteProjectUseCase","projectRepository","id","SoftDeleteProjectUseCase","projectRepository","id","RestoreProjectUseCase","projectRepository","id","project","PermanentDeleteProjectUseCase","projectRepository","id","project","GetDeletedProjectsUseCase","projectRepository","workspaceId","Workflow","_Workflow","Entity","props","CreateWorkflowUseCase","workflowRepository","input","workflow","Workflow","ListWorkflowsUseCase","workflowRepository","workspaceId","UpdateWorkflowUseCase","workflowRepository","input","workflow","updatedWorkflow","DeleteWorkflowUseCase","workflowRepository","id","Tag","_Tag","Entity","props","CreateTagUseCase","tagRepository","props","tag","Tag","AssignTagToTaskUseCase","tagRepository","tagId","taskId","RemoveTagFromTaskUseCase","tagRepository","tagId","taskId","UpdateTagUseCase","tagRepository","id","props","tag","updatedTag","TimeSession","_TimeSession","Entity","props","pauseStartedAt","pauseEndedAt","actualPauseStart","pauseDuration","pauseRecord","endedAt","wasCompleted","wasInterrupted","extraPauseTime","totalMs","activeSeconds","durationMinutes","splitReason","StartTimerUseCase","timerRepository","taskRepository","userId","taskId","type","activeSession","stoppedSession","session","TimeSession","createdSession","task","updatedTask","StopTimerUseCase","timerRepository","userId","wasCompleted","activeSession","stoppedSession","PauseTimerUseCase","timerRepository","userId","pauseStartedAt","activeSession","pausedSession","ResumeTimerUseCase","timerRepository","userId","pauseStartedAt","pauseEndedAt","activeSession","resumedSession","SwitchTaskUseCase","timerRepository","userId","newTaskId","type","splitReason","activeSession","stoppedSession","newSession","TimeSession","createdSession","DailyMetrics","_DailyMetrics","Entity","props","minutes","score","GetDailyMetricsUseCase","analyticsRepository","userId","date","metrics","DailyMetrics","UpdateDailyMetricsUseCase","analyticsRepository","input","normalizedDate","metrics","DailyMetrics","i","CalculateFocusScoreUseCase","input","totalWorkSeconds","totalPauseSeconds","pauseCount","totalTime","workRatio","pausePenalty","focusScore","AIProfile","_AIProfile","Entity","props","userId","hour","score","newScore","dayOfWeek","recentDurations","avgRecent","sum","d","newAvg","completed","total","newRate","updatedRate","category","limit","a","b","day","ProductivityReport","_ProductivityReport","Entity","props","m","parts","hours","mins","limit","LearnFromSessionUseCase","aiProfileRepository","input","session","profile","startedAt","hour","dayOfWeek","productivityScore","updatedProfile","duration","pauseCount","totalPauseTime","wasCompleted","score","pausePenalty","totalSessionTime","workTimeRatio","DAY_NAMES","GetOptimalScheduleUseCase","aiProfileRepository","input","userId","topN","profile","topPeakHours","topPeakDays","recommendation","limit","peakHours","hour","score","a","b","peakDays","day","dayNum","period","topHours","topDays","parts","bestHour","hourList","h","bestDay","dayList","d","avgDuration","completionRate","PredictTaskDurationUseCase","aiProfileRepository","input","userId","taskTitle","taskDescription","category","priority","profile","estimatedMinutes","confidence","reasoningParts","categoryScore","text","reasoning","keywords","keyword","GenerateWeeklyReportUseCase","reportRepository","analyticsRepository","timerRepository","aiProfileRepository","generateReportData","input","userId","weekStart","startDate","endDate","existing","dailyMetrics","sessions","profile","metricsSnapshot","sum","m","reportData","s","report","ProductivityReport","date","d","day","diff","date1","date2","start1","start2","MockAIService","input","resolve","lowerInput","priority","dueDate","tomorrow","message","context","aiService","Habit","_Habit","Entity","props","dayOfWeek","isConsecutive","newTotal","newStreak","newLongest"]}