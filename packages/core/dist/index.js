"use strict";var ce=Object.defineProperty;var gt=Object.getOwnPropertyDescriptor;var yt=Object.getOwnPropertyNames;var ht=Object.prototype.hasOwnProperty;var wt=(t,e)=>{for(var r in e)ce(t,r,{get:e[r],enumerable:!0})},bt=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of yt(e))!ht.call(t,s)&&s!==r&&ce(t,s,{get:()=>e[s],enumerable:!(o=gt(e,s))||o.enumerable});return t};var kt=t=>bt(ce({},"__esModule",{value:!0}),t);var $o={};wt($o,{AIProfile:()=>et,AcceptInvitationUseCase:()=>Ie,AddMemberToWorkspaceUseCase:()=>De,ArchiveProjectUseCase:()=>Le,ArchiveWorkspaceUseCase:()=>Pe,AssignTagToTaskUseCase:()=>$e,COMMENT_LIMITS:()=>B,CalculateFocusScoreUseCase:()=>Qe,ChangeUserName:()=>j,CompleteTaskUseCase:()=>Se,CreateAuditLogUseCase:()=>Oe,CreateProjectUseCase:()=>_e,CreateTagUseCase:()=>Ge,CreateTaskUseCase:()=>xe,CreateWorkflowUseCase:()=>He,CreateWorkspaceUseCase:()=>Te,DEFAULT_POMODORO_SETTINGS:()=>at,DailyMetrics:()=>I,DeleteProjectUseCase:()=>We,DeleteWorkflowUseCase:()=>je,Email:()=>M,Entity:()=>m,FILE_LIMITS:()=>oe,GenerateWeeklyReportUseCase:()=>st,GetDailyMetricsUseCase:()=>Je,GetOptimalScheduleUseCase:()=>rt,GetWorkspaceAuditLogsUseCase:()=>Ce,GetWorkspaceSettingsUseCase:()=>ve,Habit:()=>nt,HashPassword:()=>v,Id:()=>L,InviteMemberUseCase:()=>Re,LearnFromSessionUseCase:()=>tt,ListWorkflowsUseCase:()=>Ue,MEMBER_ROLES:()=>he,MockAIService:()=>ie,PAGINATION_LIMITS:()=>jt,PRIORITY_VALUES:()=>W,PROJECT_COLORS:()=>xt,PROJECT_LIMITS:()=>E,PROJECT_STATUS:()=>Pt,PROJECT_STATUS_VALUES:()=>Rt,PauseTimerUseCase:()=>Xe,PersonName:()=>D,PredictTaskDurationUseCase:()=>ot,ProductivityReport:()=>Q,Project:()=>q,RegisterUser:()=>G,RemoveMemberFromWorkspaceUseCase:()=>Ee,RemoveTagFromTaskUseCase:()=>Fe,RequiredString:()=>ue,ResumeTimerUseCase:()=>Ye,SoftDeleteWorkspaceUseCase:()=>Ae,StartTimerUseCase:()=>Ve,StopTimerUseCase:()=>Ke,SwitchTaskUseCase:()=>qe,TAG_COLORS:()=>St,TAG_LIMITS:()=>O,TASK_LIMITS:()=>w,TASK_PRIORITIES:()=>te,TASK_STATUS:()=>re,TASK_STATUS_VALUES:()=>H,TIMER_LIMITS:()=>Nt,TIMER_MODES:()=>U,TIMER_MODE_VALUES:()=>_t,Tag:()=>Z,Task:()=>z,TimeSession:()=>R,USER_LIMITS:()=>g,UpdateDailyMetricsUseCase:()=>Ze,UpdateProjectUseCase:()=>Ne,UpdateTagUseCase:()=>ze,UpdateWorkflowUseCase:()=>Be,UpdateWorkspaceSettingsUseCase:()=>Me,User:()=>_,UserByEmail:()=>$,UserLogin:()=>F,WORKSPACE_COLORS:()=>Tt,WORKSPACE_LIMITS:()=>A,WORKSPACE_TYPES:()=>ye,Workflow:()=>J,Workspace:()=>V,WorkspaceAuditLog:()=>X,WorkspaceInvitation:()=>Y,WorkspaceMember:()=>P,WorkspaceSettings:()=>K,acceptInvitationSchema:()=>To,addAlpha:()=>eo,addDays:()=>Qt,addHours:()=>er,addMinutes:()=>tr,aiService:()=>Go,archiveProjectSchema:()=>yo,assignTagsSchema:()=>Io,bulkUpdateTasksSchema:()=>uo,calculateAverageCompletionTime:()=>$r,calculateAverageTime:()=>hr,calculateBurndownRate:()=>Vr,calculateCompletionRate:()=>Br,calculateEfficiency:()=>Yr,calculateEstimatedCompletion:()=>zr,calculateFocusScore:()=>Gr,calculatePercentile:()=>Jr,calculateProductivityScore:()=>jr,calculateProgress:()=>Ur,calculateProjectHealth:()=>Kr,calculateStreak:()=>qr,calculateTimeUtilization:()=>Xr,calculateTotalTimeWorked:()=>yr,calculateVelocity:()=>Fr,calculateWeightedAverage:()=>Zr,camelToTitle:()=>Dr,capitalize:()=>le,capitalizeWords:()=>Tr,categorizeTasksByAvailability:()=>sr,changePasswordSchema:()=>Co,commentBaseSchema:()=>ke,commentFilterSchema:()=>Bo,countWords:()=>Or,createCommentSchema:()=>Ho,createProjectSchema:()=>lo,createTagSchema:()=>Ao,createTaskSchema:()=>io,createWorkspaceSchema:()=>wo,darkenColor:()=>fe,duplicateProjectSchema:()=>ho,endOfDay:()=>qt,endOfWeek:()=>Zt,formatDate:()=>zt,formatDateShort:()=>me,formatDuration:()=>ir,formatDurationFromSeconds:()=>pr,formatFileSize:()=>Gt,formatNumber:()=>_r,formatRelativeTime:()=>Vt,formatScheduledDateTime:()=>ar,formatTimeOfDay:()=>wr,formatTimerDisplay:()=>cr,formatTimerDisplayExtended:()=>ur,generateId:()=>Nr,generatePalette:()=>so,generateRandomString:()=>Pr,generateSlug:()=>xr,getColorWithOpacity:()=>no,getContrastColor:()=>Qr,getCurrentTime:()=>br,getDaysDiff:()=>Yt,getInitials:()=>Ar,getPriorityColor:()=>Et,getPriorityConfig:()=>Dt,getPriorityLabel:()=>At,getTaskStatusColor:()=>Mt,getTaskStatusConfig:()=>It,getTaskStatusLabel:()=>vt,getTimerModeColor:()=>Wt,getTimerModeConfig:()=>Lt,getTimerModeDefaultDuration:()=>Ut,getTimerModeLabel:()=>Ht,getWorkableTasks:()=>nr,hexToRgb:()=>T,hexToRgba:()=>lt,highlightSearchTerms:()=>Hr,hoursToMinutes:()=>lr,inviteMemberSchema:()=>xo,isAfter:()=>rr,isAllowedFileType:()=>$t,isAlphanumeric:()=>Lr,isBefore:()=>ut,isDarkColor:()=>ro,isDueToday:()=>or,isFuture:()=>Kt,isImageFile:()=>Ft,isLightColor:()=>dt,isOverdue:()=>Xt,isPast:()=>it,isScheduledForToday:()=>mt,isTaskAvailable:()=>se,isTaskCompleted:()=>Ot,isTaskInProgress:()=>Ct,isToday:()=>C,isValidEmail:()=>Rr,isValidUrl:()=>Ir,isWorkingHours:()=>kr,lightenColor:()=>de,loginUserSchema:()=>vo,minutesToHours:()=>mr,minutesToSeconds:()=>fr,mixColors:()=>oo,normalizeWhitespace:()=>vr,parseDuration:()=>gr,pluralize:()=>Cr,projectBaseSchema:()=>ge,projectFilterSchema:()=>go,randomColor:()=>to,registerUserSchema:()=>Mo,reorderTasksSchema:()=>mo,resetPasswordRequestSchema:()=>_o,resetPasswordSchema:()=>No,rgbToHex:()=>ne,sanitizeHtml:()=>Mr,secondsToMinutes:()=>dr,shouldTakeLongBreak:()=>Bt,snakeToTitle:()=>Er,startOfDay:()=>pt,startOfToday:()=>ct,startOfWeek:()=>Jt,stripHtmlTags:()=>Wr,tagBaseSchema:()=>be,tagFilterSchema:()=>Ro,taskBaseSchema:()=>ae,taskDatesSchema:()=>ao,taskFilterSchema:()=>co,transferOwnershipSchema:()=>Do,truncate:()=>Sr,updateCommentSchema:()=>Uo,updateMemberRoleSchema:()=>So,updateProjectSchema:()=>fo,updateTagSchema:()=>Po,updateTaskSchema:()=>po,updateUserProfileSchema:()=>Oo,updateWorkspaceSchema:()=>bo,userPreferencesSchema:()=>Lo,usernameValidationSchema:()=>Wo,workspaceBaseSchema:()=>we,workspaceFilterSchema:()=>Eo,workspaceSettingsSchema:()=>ko});module.exports=kt($o);var M=class t{_value;constructor(e){this._value=e}static create(e){let r=e?.trim?.().toLowerCase();return this.validate(r),new t(r)}static validate(e){if(!e||typeof e!="string")throw new Error("O email n\xE3o pode estar vazio");if(e.length>254)throw new Error("O email deve ter no m\xE1ximo 254 caracteres");if(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-\u00A0-\uFFFF]+@[a-zA-Z0-9\u00A0-\uFFFF](?:[a-zA-Z0-9\u00A0-\uFFFF-]{0,61}[a-zA-Z0-9\u00A0-\uFFFF])?(?:\.[a-zA-Z0-9\u00A0-\uFFFF](?:[a-zA-Z0-9\u00A0-\uFFFF-]{0,61}[a-zA-Z0-9\u00A0-\uFFFF])?)*$/.test(e))throw new Error("O formato do email \xE9 inv\xE1lido");let[o,s]=e.split("@");if(o&&o.includes(".."))throw new Error("O email n\xE3o pode conter pontos consecutivos na parte local");if(o&&(o.startsWith(".")||o.endsWith(".")))throw new Error("O email n\xE3o pode come\xE7ar ou terminar com ponto na parte local")}get value(){return this._value}get localPart(){return this._value.split("@")[0]}get domain(){return this._value.split("@")[1]}equals(e){return e instanceof t?this._value===e._value:!1}toString(){return this._value}toJSON(){return this._value}};var v=class t{_value;constructor(e){this._value=e}static create(e){return this.validate(e),new t(e.trim())}static validate(e){if(!e||typeof e!="string")throw new Error("O hash da senha n\xE3o pode estar vazio");let r=e.trim();if(r.length===0)throw new Error("O hash da senha n\xE3o pode estar vazio");if(!/^\$2[abxy]\$\d{2}\$[A-Za-z0-9.\/]{53}$/.test(r))throw new Error("A senha deve estar criptografada")}get value(){return this._value}get algorithm(){return this._value.split("$")[1]}get cost(){return parseInt(this._value.split("$")[2],10)}equals(e){return e instanceof t?this._value===e._value:!1}toString(){return this._value}toJSON(){return this._value}};var D=class t{_value;constructor(e){this._value=e}static create(e){return this.validate(e),new t(e.trim())}static validate(e){if(!e||typeof e!="string")throw new Error("O nome \xE9 obrigat\xF3rio e deve ser uma string");let r=e.trim();if(r.length<3)throw new Error("O nome deve ter pelo menos 3 caracteres");if(r.length>120)throw new Error("O nome deve ter no m\xE1ximo 120 caracteres");if(!/^[a-zA-ZÀ-ÿ\u0100-\u017F\u0180-\u024F\u1E00-\u1EFF\s'-]+$/.test(r))throw new Error("O nome cont\xE9m caracteres inv\xE1lidos. Apenas letras, espa\xE7os, ap\xF3strofes e h\xEDfens s\xE3o permitidos");if(r.split(/\s+/).filter(n=>n.length>0).length<2)throw new Error("O nome deve conter pelo menos um nome e um sobrenome");if(/\s{2,}/.test(r))throw new Error("O nome n\xE3o pode conter espa\xE7os m\xFAltiplos consecutivos");if(/^[-'\s]|[-'\s]$/.test(r))throw new Error("O nome n\xE3o pode come\xE7ar ou terminar com espa\xE7os, h\xEDfens ou ap\xF3strofes")}get value(){return this._value}get firstName(){return this._value.split(" ")[0]}get lastName(){let e=this._value.split(" ");return e[e.length-1]}get fullName(){return this._value}get initials(){let e=this.value.trim().split(/\s+/).filter(r=>r.length>0);return(this.firstName.charAt(0)+this.lastName.charAt(0)).toUpperCase()}equals(e){return e instanceof t?this._value.toLowerCase()===e._value.toLowerCase():!1}toString(){return this._value}toJSON(){return this._value}toFormattedString(){return this._value.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}};var ee=require("uuid"),L=class t{_value;constructor(e){this._value=e}static create(e){let r=e?.trim().toLowerCase()??(0,ee.v4)();return this.validate(r),new t(r)}static validate(e){if(!(0,ee.validate)(e))throw new Error("O id fornecido n\xE3o \xE9 um UUID v\xE1lido.")}get value(){return this._value}equals(e){return e instanceof t&&this._value===e._value}toString(){return this._value}toJSON(){return this._value}};var m=class t{props;mode="valid";id;constructor(e,r="valid"){if(this.props=Object.freeze({...e,id:e.id?e.id:L.create().value}),this.mode=r,this.id=this.props.id,e.props)throw new Error("Props should not contain 'props' property")}get data(){return this.props}isDraft(){return this.mode==="draft"}isValid(){return this.mode==="valid"}equals(e){return e==null||!(e instanceof t)?!1:this===e?!0:this.constructor!==e.constructor?!1:this.sameId(e)}notEquals(e){return!this.equals(e)}sameId(e){let r=this.id;return this.id===e.id}asDraft(){return this.clone(this.props,"draft")}asValid(){return this.clone(this.props,"valid")}clone(e,r=this.mode){return new this.constructor({...this.props,...e},r)}};var ue=class t{_value;constructor(e){this._value=e}static create(e,r){return this.validate(e,r),new t(e.trim())}static validate(e,r){let o=r?.errorMessage||`${r?.attributeName??"Valor"} \xE9 obrigat\xF3rio`;if(!e||typeof e!="string")throw new Error(o);let s=e.trim();if(s.length===0)throw new Error(o);if(r?.minLength&&s.length<r.minLength)throw new Error(`${r.attributeName??`"${e}"`} deve ter pelo menos ${r.minLength} caracteres`);if(r?.maxLength&&s.length>r.maxLength)throw new Error(`${r.attributeName??`"${e}"`} deve ter no m\xE1ximo ${r.maxLength} caracteres`)}get value(){return this._value}equals(e){return e instanceof t&&this._value===e._value}toString(){return this._value}toJSON(){return this._value}};var xt=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#6B7280"],St=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#06B6D4","#F43F5E","#84CC16","#6366F1"],Tt={PERSONAL:"#06B6D4",WORK:"#8B5CF6",TEAM:"#EC4899"};var te={LOW:{value:"LOW",label:"Low",color:"#10B981",order:1},MEDIUM:{value:"MEDIUM",label:"Medium",color:"#F59E0B",order:2},HIGH:{value:"HIGH",label:"High",color:"#EF4444",order:3}},W=["LOW","MEDIUM","HIGH"];function Dt(t){return te[t]}function Et(t){return te[t].color}function At(t){return te[t].label}var re={TODO:{value:"TODO",label:"To Do",color:"#6B7280",order:1},IN_PROGRESS:{value:"IN_PROGRESS",label:"In Progress",color:"#3B82F6",order:2},IN_REVIEW:{value:"IN_REVIEW",label:"In Review",color:"#F59E0B",order:3},DONE:{value:"DONE",label:"Done",color:"#10B981",order:4},CANCELLED:{value:"CANCELLED",label:"Cancelled",color:"#EF4444",order:5}},H=["TODO","IN_PROGRESS","IN_REVIEW","DONE","CANCELLED"],Pt={ACTIVE:{value:"ACTIVE",label:"Active",color:"#10B981"},ARCHIVED:{value:"ARCHIVED",label:"Archived",color:"#6B7280"},ON_HOLD:{value:"ON_HOLD",label:"On Hold",color:"#F59E0B"}},Rt=["ACTIVE","ARCHIVED","ON_HOLD"];function It(t){return re[t]}function Mt(t){return re[t].color}function vt(t){return re[t].label}function Ot(t){return t==="DONE"}function Ct(t){return t==="IN_PROGRESS"||t==="IN_REVIEW"}var U={WORK:{value:"WORK",label:"Work",color:"#EF4444",defaultDuration:25},SHORT_BREAK:{value:"SHORT_BREAK",label:"Short Break",color:"#10B981",defaultDuration:5},LONG_BREAK:{value:"LONG_BREAK",label:"Long Break",color:"#059669",defaultDuration:15},CONTINUOUS:{value:"CONTINUOUS",label:"Continuous",color:"#3B82F6",defaultDuration:0}},_t=["WORK","SHORT_BREAK","LONG_BREAK","CONTINUOUS"],at={workDuration:25,shortBreakDuration:5,longBreakDuration:15,pomodorosUntilLongBreak:4,autoStartBreaks:!1,autoStartPomodoros:!1,soundEnabled:!0,notificationsEnabled:!0},Nt={MIN_DURATION:1,MAX_DURATION:120,MIN_POMODOROS_UNTIL_LONG_BREAK:2,MAX_POMODOROS_UNTIL_LONG_BREAK:10};function Lt(t){return U[t]}function Wt(t){return U[t].color}function Ht(t){return U[t].label}function Ut(t){return U[t].defaultDuration}function Bt(t,e=at.pomodorosUntilLongBreak){return t>0&&t%e===0}var w={TITLE_MIN_LENGTH:1,TITLE_MAX_LENGTH:200,DESCRIPTION_MAX_LENGTH:5e3,MIN_ESTIMATED_MINUTES:1,MAX_ESTIMATED_MINUTES:480,MAX_SUBTASKS:50,MAX_TAGS_PER_TASK:10,MAX_ATTACHMENTS_PER_TASK:20},E={NAME_MIN_LENGTH:1,NAME_MAX_LENGTH:100,DESCRIPTION_MAX_LENGTH:2e3,MAX_PROJECTS_PER_WORKSPACE:100,MAX_TASKS_PER_PROJECT:1e3},A={NAME_MIN_LENGTH:1,NAME_MAX_LENGTH:100,DESCRIPTION_MAX_LENGTH:500,MAX_MEMBERS:50,MAX_WORKSPACES_PER_USER:20,SLUG_MIN_LENGTH:3,SLUG_MAX_LENGTH:50},O={NAME_MIN_LENGTH:1,NAME_MAX_LENGTH:30,MAX_TAGS_PER_WORKSPACE:100},B={CONTENT_MIN_LENGTH:1,CONTENT_MAX_LENGTH:2e3,MAX_COMMENTS_PER_TASK:500},oe={MAX_FILE_SIZE:10*1024*1024,MAX_IMAGE_SIZE:5*1024*1024,MAX_TOTAL_STORAGE_PER_WORKSPACE:1024*1024*1024,ALLOWED_IMAGE_TYPES:["image/jpeg","image/png","image/gif","image/webp"],ALLOWED_DOCUMENT_TYPES:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]},g={NAME_MIN_LENGTH:2,NAME_MAX_LENGTH:100,PASSWORD_MIN_LENGTH:6,PASSWORD_MAX_LENGTH:128,BIO_MAX_LENGTH:500},jt={DEFAULT_PAGE_SIZE:20,MAX_PAGE_SIZE:100,MIN_PAGE_SIZE:5};function Gt(t){if(t===0)return"0 Bytes";let e=1024,r=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(t)/Math.log(e));return Math.round(t/Math.pow(e,o)*100)/100+" "+r[o]}function $t(t){return[...oe.ALLOWED_IMAGE_TYPES,...oe.ALLOWED_DOCUMENT_TYPES].includes(t)}function Ft(t){return oe.ALLOWED_IMAGE_TYPES.includes(t)}function zt(t,e="en-US"){return(typeof t=="string"?new Date(t):t).toLocaleDateString(e,{year:"numeric",month:"long",day:"numeric"})}function me(t,e="en-US"){return(typeof t=="string"?new Date(t):t).toLocaleDateString(e,{year:"numeric",month:"short",day:"numeric"})}function Vt(t,e="en-US"){let r=typeof t=="string"?new Date(t):t,o=new Date,s=r.getTime()-o.getTime(),n=Math.round(s/1e3),a=Math.round(n/60),i=Math.round(a/60),p=Math.round(i/24);return Math.abs(n)<60?n>=0?"in a few seconds":"a few seconds ago":Math.abs(a)<60?a>=0?`in ${a} minute${a!==1?"s":""}`:`${Math.abs(a)} minute${Math.abs(a)!==1?"s":""} ago`:Math.abs(i)<24?i>=0?`in ${i} hour${i!==1?"s":""}`:`${Math.abs(i)} hour${Math.abs(i)!==1?"s":""} ago`:Math.abs(p)<30?p>=0?`in ${p} day${p!==1?"s":""}`:`${Math.abs(p)} day${Math.abs(p)!==1?"s":""} ago`:me(r,e)}function C(t){let e=typeof t=="string"?new Date(t):t,r=new Date;return e.getDate()===r.getDate()&&e.getMonth()===r.getMonth()&&e.getFullYear()===r.getFullYear()}function it(t){return(typeof t=="string"?new Date(t):t).getTime()<new Date().getTime()}function Kt(t){return(typeof t=="string"?new Date(t):t).getTime()>new Date().getTime()}function Xt(t){if(!t)return!1;let e=typeof t=="string"?new Date(t):t;return it(e)&&!C(e)}function Yt(t,e){let r=typeof t=="string"?new Date(t):t,s=(typeof e=="string"?new Date(e):e).getTime()-r.getTime();return Math.floor(s/(1e3*60*60*24))}function pt(t){let e=typeof t=="string"?new Date(t):new Date(t);return e.setHours(0,0,0,0),e}function qt(t){let e=typeof t=="string"?new Date(t):new Date(t);return e.setHours(23,59,59,999),e}function Jt(t){let e=typeof t=="string"?new Date(t):new Date(t),r=e.getDay(),o=e.getDate()-r+(r===0?-6:1),s=new Date(e.setDate(o));return s.setHours(0,0,0,0),s}function Zt(t){let e=typeof t=="string"?new Date(t):new Date(t),r=e.getDay(),o=e.getDate()+(r===0?0:7-r),s=new Date(e.setDate(o));return s.setHours(23,59,59,999),s}function Qt(t,e){let r=typeof t=="string"?new Date(t):new Date(t);return r.setDate(r.getDate()+e),r}function er(t,e){let r=typeof t=="string"?new Date(t):new Date(t);return r.setHours(r.getHours()+e),r}function tr(t,e){let r=typeof t=="string"?new Date(t):new Date(t);return r.setMinutes(r.getMinutes()+e),r}function ct(){return pt(new Date)}function ut(t,e){let r=typeof t=="string"?new Date(t):t,o=typeof e=="string"?new Date(e):e;return r.getTime()<o.getTime()}function rr(t,e){let r=typeof t=="string"?new Date(t):t,o=typeof e=="string"?new Date(e):e;return r.getTime()>o.getTime()}function se(t){return t.startDate?(typeof t.startDate=="string"?new Date(t.startDate):t.startDate)<=new Date:!0}function mt(t){return t.scheduledDate?C(t.scheduledDate):!1}function or(t){return t.dueDate?C(t.dueDate):!1}function sr(t){let e=ct();return{overdue:t.filter(r=>r.dueDate&&ut(r.dueDate,e)&&r.status!=="COMPLETED"),dueToday:t.filter(r=>r.dueDate&&C(r.dueDate)),scheduledToday:t.filter(r=>r.scheduledDate&&C(r.scheduledDate)),available:t.filter(r=>se(r)&&!mt(r)&&r.status!=="COMPLETED"),notYetAvailable:t.filter(r=>!se(r))}}function nr(t){return t.filter(e=>se(e)&&e.status!=="COMPLETED"&&e.status!=="CANCELLED")}function ar(t,e,r="en-US"){if(!t)return null;let o=me(t,r);return e?`${o} at ${e}`:o}function ir(t){if(t<60)return`${t}m`;let e=Math.floor(t/60),r=t%60;return r>0?`${e}h ${r}m`:`${e}h`}function pr(t){let e=Math.floor(t/3600),r=Math.floor(t%3600/60),o=t%60,s=[];return e>0&&s.push(`${e}h`),r>0&&s.push(`${r}m`),(o>0||s.length===0)&&s.push(`${o}s`),s.join(" ")}function cr(t){let e=Math.floor(t/60),r=t%60;return`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function ur(t){let e=Math.floor(t/3600),r=Math.floor(t%3600/60),o=t%60;return`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}function mr(t){return Math.round(t/60*100)/100}function lr(t){return Math.round(t*60)}function dr(t){return Math.round(t/60)}function fr(t){return t*60}function gr(t){let e=t.match(/(\d+)h/),r=t.match(/(\d+)m/),o=e?parseInt(e[1],10):0,s=r?parseInt(r[1],10):0;return o*60+s}function yr(t){return t.reduce((e,r)=>e+r.duration,0)}function hr(t,e){return e===0?0:Math.round(t/e)}function wr(t,e=!1){let[r,o]=t.split(":").map(Number);if(e)return`${(r||0).toString().padStart(2,"0")}:${(o||0).toString().padStart(2,"0")}`;let s=(r||0)>=12?"PM":"AM";return`${(r||0)%12||12}:${(o||0).toString().padStart(2,"0")} ${s}`}function br(){let t=new Date;return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`}function kr(t=new Date,e=9,r=18){let o=t.getHours();return o>=e&&o<r}function xr(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}function Sr(t,e,r="..."){return t.length<=e?t:t.slice(0,e-r.length)+r}function le(t){return t&&t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}function Tr(t){return t.split(" ").map(e=>le(e)).join(" ")}function Dr(t){let e=t.replace(/([A-Z])/g," $1");return e.charAt(0).toUpperCase()+e.slice(1)}function Er(t){return t.split("_").map(e=>le(e)).join(" ")}function Ar(t,e=2){return t.trim().split(/\s+/).map(s=>s.charAt(0).toUpperCase()).join("").slice(0,e)}function Pr(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="";for(let o=0;o<t;o++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}function Rr(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}function Ir(t){try{return new URL(t),!0}catch{return!1}}function Mr(t){let e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return t.replace(/[&<>"'/]/g,r=>e[r]||r)}function vr(t){return t.replace(/\s+/g," ").trim()}function Or(t){return t.trim().split(/\s+/).filter(Boolean).length}function Cr(t,e,r){return e===1?t:r||`${t}s`}function _r(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Nr(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function Lr(t){return/^[a-zA-Z0-9]+$/.test(t)}function Wr(t){return t.replace(/<[^>]*>/g,"")}function Hr(t,e){if(!e)return t;let r=new RegExp(`(${e})`,"gi");return t.replace(r,"<mark>$1</mark>")}function Ur(t,e){return e===0?0:Math.round(t/e*100)}function Br(t,e){return e===0?0:Math.round(t/e*100*10)/10}function jr(t,e,r,o=240){if(e===0&&r===0)return 0;let s=e>0?t/e*50:0,n=Math.min(r/o*50,50);return Math.round(s+n)}function Gr(t,e=8){return e===0?0:Math.min(Math.round(t/e*100),100)}function $r(t){let e=t.filter(o=>o.completedAt!=null);if(e.length===0)return 0;let r=e.reduce((o,s)=>{if(!s.completedAt)return o;let n=typeof s.createdAt=="string"?new Date(s.createdAt):s.createdAt,a=typeof s.completedAt=="string"?new Date(s.completedAt):s.completedAt;return o+(a.getTime()-n.getTime())},0);return Math.round(r/e.length/(1e3*60))}function Fr(t,e){return e===0?0:Math.round(t/e*10)/10}function zr(t,e){if(e===0)return null;let r=Math.ceil(t/e),o=new Date;return o.setDate(o.getDate()+r),o}function Vr(t,e,r){if(r===0)return 0;let o=t-e;return Math.round(o/r*10)/10}function Kr(t,e,r,o,s=2){if(e===0)return 100;let n=t/e*40,a=Math.max(0,30-r/e*30),i=Math.min(o/s*30,30);return Math.round(n+a+i)}function Xr(t,e){return e===0?0:Math.round(t/e*100)}function Yr(t,e){if(e===0)return 0;let r=t/e*60;return Math.round(r*100)/100}function qr(t){if(t.length===0)return 0;let e=t.map(a=>typeof a=="string"?new Date(a):a).sort((a,i)=>i.getTime()-a.getTime()),r=1,o=new Date;o.setHours(0,0,0,0);let s=new Date(e[0]);if(s.setHours(0,0,0,0),Math.floor((o.getTime()-s.getTime())/(1e3*60*60*24))>1)return 0;for(let a=1;a<e.length;a++){let i=new Date(e[a]);i.setHours(0,0,0,0);let p=new Date(e[a-1]);if(p.setHours(0,0,0,0),Math.floor((p.getTime()-i.getTime())/(1e3*60*60*24))===1)r++;else break}return r}function Jr(t,e){if(e.length===0)return 0;let r=[...e].sort((s,n)=>s-n),o=r.findIndex(s=>s>=t);return o===-1?100:Math.round(o/r.length*100)}function Zr(t){if(t.length===0)return 0;let e=t.reduce((o,s)=>o+s.weight,0);if(e===0)return 0;let r=t.reduce((o,s)=>o+s.value*s.weight,0);return Math.round(r/e*100)/100}function T(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function ne(t,e,r){let o=s=>{let n=s.toString(16);return n.length===1?"0"+n:n};return"#"+o(t)+o(e)+o(r)}function Qr(t){let e=T(t);return e?(.299*e.r+.587*e.g+.114*e.b)/255>.5?"#000000":"#FFFFFF":"#000000"}function de(t,e){let r=T(t);if(!r)return t;let o=Math.round(2.55*e),s=Math.min(255,r.r+o),n=Math.min(255,r.g+o),a=Math.min(255,r.b+o);return ne(s,n,a)}function fe(t,e){let r=T(t);if(!r)return t;let o=Math.round(2.55*e),s=Math.max(0,r.r-o),n=Math.max(0,r.g-o),a=Math.max(0,r.b-o);return ne(s,n,a)}function eo(t,e){if(!T(t))return t;let o=Math.round(Math.min(Math.max(e,0),1)*255);return`${t}${o.toString(16).padStart(2,"0")}`}function lt(t,e=1){let r=T(t);return r?`rgba(${r.r}, ${r.g}, ${r.b}, ${e})`:`rgba(0, 0, 0, ${e})`}function to(){return"#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}function dt(t){let e=T(t);return e?(.299*e.r+.587*e.g+.114*e.b)/255>.5:!1}function ro(t){return!dt(t)}function oo(t,e,r=.5){let o=T(t),s=T(e);if(!o||!s)return t;let n=Math.max(0,Math.min(1,r)),a=Math.round(o.r*(1-n)+s.r*n),i=Math.round(o.g*(1-n)+s.g*n),p=Math.round(o.b*(1-n)+s.b*n);return ne(a,i,p)}function so(t){return{lighter:de(t,40),light:de(t,20),base:t,dark:fe(t,20),darker:fe(t,40)}}function no(t,e=.1){return lt(t,e)}var c=require("zod");var ae=c.z.object({title:c.z.string().min(w.TITLE_MIN_LENGTH,"Title is required").max(w.TITLE_MAX_LENGTH,`Title must be less than ${w.TITLE_MAX_LENGTH} characters`),description:c.z.string().max(w.DESCRIPTION_MAX_LENGTH,`Description must be less than ${w.DESCRIPTION_MAX_LENGTH} characters`).optional(),priority:c.z.enum(W),status:c.z.enum(H).optional(),dueDate:c.z.string().optional().nullable(),startDate:c.z.string().optional().nullable(),scheduledDate:c.z.string().optional().nullable(),scheduledTime:c.z.string().regex(/^\d{2}:\d{2}$/,"Time must be in HH:mm format").optional().nullable(),isTimeBlocked:c.z.boolean().optional(),estimatedMinutes:c.z.union([c.z.number().int().min(w.MIN_ESTIMATED_MINUTES).max(w.MAX_ESTIMATED_MINUTES),c.z.nan()]).optional().nullable().transform(t=>Number.isNaN(t)?void 0:t)}),ao=ae.refine(t=>t.startDate&&t.dueDate?new Date(t.startDate)<=new Date(t.dueDate):!0,{message:"Start date must be before or equal to due date",path:["startDate"]}).refine(t=>t.scheduledDate&&t.dueDate?new Date(t.scheduledDate)<=new Date(t.dueDate):!0,{message:"Scheduled date must be before or equal to due date",path:["scheduledDate"]}),io=ae.extend({projectId:c.z.string().min(1,"Project is required"),parentTaskId:c.z.string().optional().nullable(),assigneeId:c.z.string().optional().nullable(),tagIds:c.z.array(c.z.string()).max(w.MAX_TAGS_PER_TASK).optional()}),po=ae.partial().extend({assigneeId:c.z.string().optional().nullable(),tagIds:c.z.array(c.z.string()).max(w.MAX_TAGS_PER_TASK).optional(),completedAt:c.z.string().datetime().optional().nullable()}),co=c.z.object({projectId:c.z.string().optional(),status:c.z.enum(H).optional(),priority:c.z.enum(W).optional(),assigneeId:c.z.string().optional(),tagIds:c.z.array(c.z.string()).optional(),search:c.z.string().optional(),dueDate:c.z.object({from:c.z.string().datetime().optional(),to:c.z.string().datetime().optional()}).optional(),isOverdue:c.z.boolean().optional()}),uo=c.z.object({taskIds:c.z.array(c.z.string()).min(1,"At least one task is required"),updates:c.z.object({status:c.z.enum(H).optional(),priority:c.z.enum(W).optional(),assigneeId:c.z.string().optional().nullable(),projectId:c.z.string().optional()})}),mo=c.z.object({taskId:c.z.string(),newOrder:c.z.number().int().min(0),projectId:c.z.string()});var d=require("zod");var ge=d.z.object({name:d.z.string().min(E.NAME_MIN_LENGTH,"Project name is required").max(E.NAME_MAX_LENGTH,`Project name must be less than ${E.NAME_MAX_LENGTH} characters`),description:d.z.string().max(E.DESCRIPTION_MAX_LENGTH,`Description must be less than ${E.DESCRIPTION_MAX_LENGTH} characters`).optional(),color:d.z.string().optional(),icon:d.z.string().optional()}),lo=ge.extend({workspaceId:d.z.string().min(1,"Workspace is required"),workflowId:d.z.string().optional(),startDate:d.z.string().datetime().optional().nullable(),endDate:d.z.string().datetime().optional().nullable()}),fo=ge.partial().extend({startDate:d.z.string().datetime().optional().nullable(),endDate:d.z.string().datetime().optional().nullable(),isArchived:d.z.boolean().optional()}),go=d.z.object({workspaceId:d.z.string().optional(),search:d.z.string().optional(),isArchived:d.z.boolean().optional(),color:d.z.string().optional()}),yo=d.z.object({isArchived:d.z.boolean()}),ho=d.z.object({name:d.z.string().min(E.NAME_MIN_LENGTH),includeTasks:d.z.boolean().default(!1),includeMembers:d.z.boolean().default(!1)});var l=require("zod");var ye=["PERSONAL","WORK","TEAM"],he=["OWNER","ADMIN","MEMBER","VIEWER"],we=l.z.object({name:l.z.string().min(A.NAME_MIN_LENGTH,"Workspace name is required").max(A.NAME_MAX_LENGTH,`Workspace name must be less than ${A.NAME_MAX_LENGTH} characters`),description:l.z.string().max(A.DESCRIPTION_MAX_LENGTH,`Description must be less than ${A.DESCRIPTION_MAX_LENGTH} characters`).optional(),type:l.z.enum(ye),color:l.z.string().optional(),icon:l.z.string().optional()}),wo=we,bo=we.partial(),ko=l.z.object({defaultTaskPriority:l.z.enum(["LOW","MEDIUM","HIGH"]).optional(),defaultTaskStatus:l.z.enum(["TODO","IN_PROGRESS","IN_REVIEW","DONE","CANCELLED"]).optional(),enableNotifications:l.z.boolean().optional(),enableEmailDigest:l.z.boolean().optional(),timezone:l.z.string().optional()}),xo=l.z.object({email:l.z.string().email("Invalid email address"),role:l.z.enum(he),message:l.z.string().max(500).optional()}),So=l.z.object({role:l.z.enum(he)}),To=l.z.object({token:l.z.string().min(1,"Invitation token is required")}),Do=l.z.object({newOwnerId:l.z.string().min(1,"New owner is required")}),Eo=l.z.object({type:l.z.enum(ye).optional(),search:l.z.string().optional()});var b=require("zod");var be=b.z.object({name:b.z.string().min(O.NAME_MIN_LENGTH,"Tag name is required").max(O.NAME_MAX_LENGTH,`Tag name must be less than ${O.NAME_MAX_LENGTH} characters`),color:b.z.string().optional()}),Ao=be.extend({workspaceId:b.z.string().min(1,"Workspace is required")}),Po=be.partial(),Ro=b.z.object({workspaceId:b.z.string().optional(),search:b.z.string().optional()}),Io=b.z.object({tagIds:b.z.array(b.z.string()).max(O.NAME_MAX_LENGTH)});var u=require("zod");var Mo=u.z.object({name:u.z.string().min(g.NAME_MIN_LENGTH,`Name must be at least ${g.NAME_MIN_LENGTH} characters`).max(g.NAME_MAX_LENGTH,`Name must be less than ${g.NAME_MAX_LENGTH} characters`),username:u.z.string().min(3,"Username must be at least 3 characters").max(20,"Username must be less than 20 characters").regex(/^[a-z0-9_-]+$/,"Username can only contain lowercase letters, numbers, hyphens, and underscores"),email:u.z.string().email("Invalid email address"),password:u.z.string().min(g.PASSWORD_MIN_LENGTH,`Password must be at least ${g.PASSWORD_MIN_LENGTH} characters`).max(g.PASSWORD_MAX_LENGTH,`Password must be less than ${g.PASSWORD_MAX_LENGTH} characters`)}),vo=u.z.object({email:u.z.string().email("Invalid email address"),password:u.z.string().min(1,"Password is required")}),Oo=u.z.object({name:u.z.string().min(g.NAME_MIN_LENGTH).max(g.NAME_MAX_LENGTH).optional(),bio:u.z.string().max(g.BIO_MAX_LENGTH).optional(),avatar:u.z.string().url().optional().nullable(),timezone:u.z.string().optional(),language:u.z.enum(["en","es","pt-BR"]).optional()}),Co=u.z.object({currentPassword:u.z.string().min(1,"Current password is required"),newPassword:u.z.string().min(g.PASSWORD_MIN_LENGTH,`Password must be at least ${g.PASSWORD_MIN_LENGTH} characters`).max(g.PASSWORD_MAX_LENGTH)}),_o=u.z.object({email:u.z.string().email("Invalid email address")}),No=u.z.object({token:u.z.string().min(1,"Reset token is required"),newPassword:u.z.string().min(g.PASSWORD_MIN_LENGTH,`Password must be at least ${g.PASSWORD_MIN_LENGTH} characters`).max(g.PASSWORD_MAX_LENGTH)}),Lo=u.z.object({theme:u.z.enum(["light","dark","system"]).optional(),language:u.z.enum(["en","es","pt-BR"]).optional(),timezone:u.z.string().optional(),notifications:u.z.object({email:u.z.boolean().optional(),push:u.z.boolean().optional(),desktop:u.z.boolean().optional()}).optional(),pomodoro:u.z.object({workDuration:u.z.number().int().min(1).max(120).optional(),shortBreakDuration:u.z.number().int().min(1).max(30).optional(),longBreakDuration:u.z.number().int().min(1).max(60).optional(),pomodorosUntilLongBreak:u.z.number().int().min(2).max(10).optional(),autoStartBreaks:u.z.boolean().optional(),autoStartPomodoros:u.z.boolean().optional(),soundEnabled:u.z.boolean().optional()}).optional()}),Wo=u.z.object({username:u.z.string().min(3,"Username must be at least 3 characters").max(20,"Username must be less than 20 characters").regex(/^[a-z0-9_-]+$/,"Username can only contain lowercase letters, numbers, hyphens, and underscores")});var k=require("zod");var ke=k.z.object({content:k.z.string().min(B.CONTENT_MIN_LENGTH,"Comment cannot be empty").max(B.CONTENT_MAX_LENGTH,`Comment must be less than ${B.CONTENT_MAX_LENGTH} characters`)}),Ho=ke.extend({taskId:k.z.string().min(1,"Task is required"),parentCommentId:k.z.string().optional().nullable(),mentions:k.z.array(k.z.string()).optional()}),Uo=ke,Bo=k.z.object({taskId:k.z.string().optional(),userId:k.z.string().optional(),parentCommentId:k.z.string().optional().nullable()});var _=class t extends m{name;username;email;password;constructor(e,r="valid"){super(e),this.name=r==="draft"?e?.name??"":D.create(e?.name??"").value,this.username=e.username,this.email=r==="draft"?e?.email??"":M.create(e?.email??"").value,this.password=e?.password?v.create(e.password).value:void 0}withoutPassword(){return this.clone({password:void 0})}static draft(e={username:""}){return new t(e,"draft")}get $name(){return D.create(this.name)}get $email(){return M.create(this.email)}get $password(){return this.password?v.create(this.password):void 0}};var j=class{constructor(e){this.repo=e}async execute(e,r){let o=D.create(e).value,s=await this.repo.findByEmail(r.email);if(!s)throw new Error("Usu\xE1rio n\xE3o encontrado");await this.repo.updateProps(s,{name:o})}};var G=class{constructor(e,r){this.repo=e;this.crypto=r}async execute(e){if(await this.repo.findByEmail(e.email))throw new Error("Usu\xE1rio j\xE1 existe");if(await this.repo.findByUsername(e.username))throw new Error("Nome de usu\xE1rio j\xE1 est\xE1 em uso");if(!e.password)throw new Error("Senha \xE9 obrigat\xF3ria");if(!e.username||e.username.length<3)throw new Error("Nome de usu\xE1rio deve ter pelo menos 3 caracteres");if(e.name?.length<3)throw new Error("Nome deve ter pelo menos 3 caracteres");let s=await this.crypto.encrypt(e.password),n=new _({name:e.name,username:e.username,email:e.email,password:s});await this.repo.save(n)}};var $=class{constructor(e){this.repo=e}async execute(e){let r=await this.repo.findByEmail(e?.toLowerCase?.());if(!r)throw new Error("Usu\xE1rio n\xE3o encontrado");return r.withoutPassword()}};var F=class{constructor(e,r){this.repo=e;this.crypto=r}async execute(e){let{email:r,password:o}=e,n=await this.repo.findByEmail(r,!0);if(!n)throw new Error("Usu\xE1rio n\xE3o encontrado");if(!await this.crypto.compare(o,n.password))throw new Error("Senha incorreta");return n.withoutPassword()}};var z=class t extends m{constructor(e){super({...e,status:e.status??"TODO",priority:e.priority??"MEDIUM",subTasks:e.subTasks??[],createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,status:"TODO",priority:e.priority??"MEDIUM"})}complete(){return this.clone({status:"COMPLETED",updatedAt:new Date})}updateStatus(e){return this.clone({status:e,updatedAt:new Date})}update(e){return this.clone({...e,updatedAt:new Date})}};var xe=class{constructor(e){this.repository=e}async execute(e){if(!e.title)throw new Error("Title is required");let r=z.create({title:e.title,description:e.description,priority:e.priority??"MEDIUM",dueDate:e.dueDate,projectId:e.projectId,ownerId:e.ownerId,assigneeId:e.assigneeId,parentTaskId:e.parentTaskId,recurrence:e.recurrence});return await this.repository.save(r),r}};var Se=class{constructor(e){this.repository=e}async execute(e){let r=await this.repository.findById(e.taskId);if(!r)throw new Error("Task not found");if(r.props.ownerId!==e.ownerId)throw new Error("Unauthorized");let o=r.complete();return await this.repository.update(o),o}};var V=class t extends m{constructor(e){super({...e,tier:e.tier??"FREE",isArchived:e.isArchived??!1,isDeleted:e.isDeleted??!1,color:e.color??"#2563EB",createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,tier:e.tier??"FREE",isArchived:!1,isDeleted:!1,color:e.color??"#2563EB"})}update(e){return this.clone({...e,updatedAt:new Date})}softDelete(){return this.clone({isDeleted:!0,deletedAt:new Date,updatedAt:new Date})}archive(){return this.clone({isArchived:!0,updatedAt:new Date})}unarchive(){return this.clone({isArchived:!1,updatedAt:new Date})}setStats(e){return this.clone({stats:e})}};var P=class t extends m{constructor(e){super({...e,joinedAt:e.joinedAt??new Date})}static create(e){return new t({...e,joinedAt:new Date})}};var K=class t extends m{constructor(e){super({...e,defaultView:e.defaultView??"LIST",createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,defaultView:e.defaultView??"LIST"})}update(e){return this.clone({...e,updatedAt:new Date})}};var X=class t extends m{constructor(e){super({...e,createdAt:e.createdAt??new Date})}static create(e){return new t(e)}};var Te=class{constructor(e){this.workspaceRepository=e}async execute(e){let r=this.generateSlug(e.name),o=r,s=1;for(;await this.workspaceRepository.findBySlug(o);)o=`${r}-${s}`,s++;let n=V.create({...e,slug:o});return this.workspaceRepository.create(n)}generateSlug(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}};var De=class{constructor(e){this.workspaceRepository=e}async execute(e,r,o="MEMBER"){if(!await this.workspaceRepository.findById(e))throw new Error("Workspace not found");let n=await this.workspaceRepository.findMember(e,r);if(n)return n;let a=P.create({workspaceId:e,userId:r,role:o});return this.workspaceRepository.addMember(a)}};var Ee=class{constructor(e){this.workspaceRepository=e}async execute(e,r){let o=await this.workspaceRepository.findById(e);if(!o)throw new Error("Workspace not found");if(!await this.workspaceRepository.findMember(e,r))throw new Error("User is not a member of this workspace");if(o.props.ownerId===r)throw new Error("Cannot remove the owner from the workspace");await this.workspaceRepository.removeMember(e,r)}};var Ae=class{constructor(e){this.workspaceRepository=e}async execute(e,r){let o=await this.workspaceRepository.findById(e);if(!o)throw new Error("Workspace not found");if(o.props.ownerId!==r)throw new Error("Unauthorized");let s=o.softDelete();await this.workspaceRepository.update(s)}};var Pe=class{constructor(e){this.workspaceRepository=e}async execute(e,r){let o=await this.workspaceRepository.findById(e);if(!o)throw new Error("Workspace not found");if(o.props.ownerId!==r)throw new Error("Unauthorized");let s=o.archive();return this.workspaceRepository.update(s)}};var Y=class t extends m{constructor(e){super({...e,status:e.status??"PENDING",role:e.role??"MEMBER",createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,status:"PENDING"})}accept(){return this.clone({status:"ACCEPTED",acceptedAt:new Date,updatedAt:new Date})}cancel(){return this.clone({status:"CANCELLED",updatedAt:new Date})}isExpired(){return this.props.expiresAt<new Date}};var ft=require("uuid"),Re=class{constructor(e,r,o){this.workspaceRepository=e;this.invitationRepository=r;this.hashService=o}async execute(e,r,o,s){if(!await this.workspaceRepository.findById(e))throw new Error("Workspace not found");let a=(0,ft.v4)(),i=await this.hashService.hash(a),p=new Date;p.setDate(p.getDate()+7);let f=Y.create({workspaceId:e,email:r,tokenHash:i,role:o,invitedById:s,expiresAt:p});return{invitation:await this.invitationRepository.create(f),token:a}}};var Ie=class{constructor(e,r,o){this.workspaceRepository=e;this.invitationRepository=r;this.hashService=o}async execute(e,r){let o=await this.invitationRepository.findPendingInvitations();if(o.length===0)throw new Error("Invalid invitation token");let s=null;for(let f of o)if(await this.hashService.compare(e,f.props.tokenHash)){s=f;break}if(!s)throw new Error("Invalid invitation token");if(s.isExpired())throw new Error("Invitation expired");let n=s.props.workspaceId;if(await this.workspaceRepository.findMember(n,r)){let f=s.accept();await this.invitationRepository.update(f);return}let i=P.create({workspaceId:n,userId:r,role:s.props.role});await this.workspaceRepository.addMember(i);let p=s.accept();await this.invitationRepository.update(p)}};var Me=class{constructor(e){this.settingsRepository=e}async execute(e){let r=await this.settingsRepository.findByWorkspaceId(e.workspaceId),o;return r?o=r.update({defaultView:e.defaultView,defaultDueTime:e.defaultDueTime,timezone:e.timezone,locale:e.locale}):o=K.create({workspaceId:e.workspaceId,defaultView:e.defaultView,defaultDueTime:e.defaultDueTime,timezone:e.timezone,locale:e.locale}),this.settingsRepository.upsert(o)}};var ve=class{constructor(e){this.settingsRepository=e}async execute(e){return this.settingsRepository.findByWorkspaceId(e.workspaceId)}};var Oe=class{constructor(e){this.auditLogRepository=e}async execute(e){let r=X.create({workspaceId:e.workspaceId,actorId:e.actorId,action:e.action,payload:e.payload});return this.auditLogRepository.create(r)}};var Ce=class{constructor(e){this.auditLogRepository=e}async execute(e){let r=e.limit??50,o=e.offset??0,[s,n]=await Promise.all([this.auditLogRepository.findByWorkspaceId(e.workspaceId,r,o),this.auditLogRepository.countByWorkspaceId(e.workspaceId)]);return{logs:s,total:n}}};var q=class t extends m{constructor(e){super({...e,color:e.color??"#6B7280",position:e.position??0,archived:e.archived??!1,completed:e.completed??!1,createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,position:0,archived:!1,completed:!1})}update(e){return this.clone({...e,updatedAt:new Date})}archive(){return this.clone({archived:!0,updatedAt:new Date})}unarchive(){return this.clone({archived:!1,updatedAt:new Date})}complete(){return this.clone({completed:!0,completedAt:new Date,updatedAt:new Date})}uncomplete(){return this.clone({completed:!1,completedAt:void 0,updatedAt:new Date})}};var _e=class{constructor(e){this.projectRepository=e}async execute(e){let r=q.create(e);return this.projectRepository.create(r)}};var Ne=class{constructor(e){this.projectRepository=e}async execute(e,r){let o=await this.projectRepository.findById(e);if(!o)throw new Error("Project not found");let s=o.update(r);return this.projectRepository.update(s)}};var Le=class{constructor(e){this.projectRepository=e}async execute(e){let r=await this.projectRepository.findById(e);if(!r)throw new Error("Project not found");console.log("\u{1F50D} Current archived status:",r.props.archived);let o=r.props.archived?r.unarchive():r.archive();return console.log("\u{1F504} New archived status:",o.props.archived),this.projectRepository.update(o)}};var We=class{constructor(e){this.projectRepository=e}async execute(e){if(!await this.projectRepository.findById(e))throw new Error("Project not found");await this.projectRepository.delete(e)}};var J=class t extends m{constructor(e){super({...e,color:e.color??"#6B7280",position:e.position??0,createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,position:0})}update(e){return this.clone({...e,updatedAt:new Date})}};var He=class{constructor(e){this.workflowRepository=e}async execute(e){let r=J.create({name:e.name,description:e.description,color:e.color??"#6B7280",icon:e.icon,workspaceId:e.workspaceId});return await this.workflowRepository.save(r),r}};var Ue=class{constructor(e){this.workflowRepository=e}async execute(e){return this.workflowRepository.findByWorkspaceId(e)}};var Be=class{constructor(e){this.workflowRepository=e}async execute(e){let r=await this.workflowRepository.findById(e.id);if(!r)throw new Error("Workflow not found");let o=r.update({name:e.name,description:e.description,color:e.color,icon:e.icon,position:e.position});return await this.workflowRepository.update(o),o}};var je=class{constructor(e){this.workflowRepository=e}async execute(e){await this.workflowRepository.delete(e)}};var Z=class t extends m{constructor(e){super({...e,color:e.color??"#6B7280",createdAt:e.createdAt??new Date})}static create(e){return new t({...e})}update(e){return this.clone({...e})}};var Ge=class{constructor(e){this.tagRepository=e}async execute(e){let r=Z.create(e);return this.tagRepository.create(r)}};var $e=class{constructor(e){this.tagRepository=e}async execute(e,r){if(!await this.tagRepository.findById(e))throw new Error("Tag not found");await this.tagRepository.assignToTask(e,r)}};var Fe=class{constructor(e){this.tagRepository=e}async execute(e,r){await this.tagRepository.removeFromTask(e,r)}};var ze=class{constructor(e){this.tagRepository=e}async execute(e,r){let o=await this.tagRepository.findById(e);if(!o)throw new Error("Tag not found");let s=o.update(r);return this.tagRepository.update(s)}};var R=class t extends m{constructor(e){super({...e,type:e.type??"WORK",wasCompleted:e.wasCompleted??!1,wasInterrupted:e.wasInterrupted??!1,pauseCount:e.pauseCount??0,totalPauseTime:e.totalPauseTime??0,pauseData:e.pauseData??[],createdAt:e.createdAt??new Date})}static create(e){return new t({...e,wasCompleted:!1,wasInterrupted:!1,pauseCount:0,totalPauseTime:0,pauseData:[],currentPauseStart:void 0})}pause(e=new Date){return this.clone({pauseCount:(this.props.pauseCount??0)+1,currentPauseStart:e})}resume(e,r=new Date){let o=this.props.currentPauseStart??e,s=Math.floor((r.getTime()-o.getTime())/1e3),n={startedAt:o,endedAt:r,duration:s};return this.clone({totalPauseTime:(this.props.totalPauseTime??0)+s,pauseData:[...this.props.pauseData??[],n],currentPauseStart:void 0})}stop(e=new Date,r=!1,o=!1){let s=0;this.props.currentPauseStart&&(s=Math.floor((e.getTime()-this.props.currentPauseStart.getTime())/1e3));let n=e.getTime()-this.props.startedAt.getTime(),i=Math.floor(n/1e3)-(this.props.totalPauseTime??0)-s,p=Math.round(i/60);return this.clone({endedAt:e,duration:p,wasCompleted:r,wasInterrupted:o,currentPauseStart:void 0,totalPauseTime:(this.props.totalPauseTime??0)+s})}split(e=new Date,r=!0,o="TASK_SWITCH"){let s=0;this.props.currentPauseStart&&(s=Math.floor((e.getTime()-this.props.currentPauseStart.getTime())/1e3));let n=e.getTime()-this.props.startedAt.getTime(),i=Math.floor(n/1e3)-(this.props.totalPauseTime??0)-s,p=Math.round(i/60);return this.clone({endedAt:e,duration:p,wasCompleted:r,wasInterrupted:!1,splitReason:o,currentPauseStart:void 0,totalPauseTime:(this.props.totalPauseTime??0)+s})}};var Ve=class{constructor(e,r){this.timerRepository=e;this.taskRepository=r}async execute(e,r,o="WORK"){let s=await this.timerRepository.findActiveSession(e);if(s){let i=s.stop(new Date,!1,!0);await this.timerRepository.update(i)}let n=R.create({userId:e,taskId:r,startedAt:new Date,type:o}),a=await this.timerRepository.create(n);if(o==="WORK"&&r){let i=await this.taskRepository.findById(r);if(i&&i.props.status==="TODO"){let p=i.updateStatus("IN_PROGRESS");await this.taskRepository.update(p)}}return a}};var Ke=class{constructor(e){this.timerRepository=e}async execute(e,r=!1){let o=await this.timerRepository.findActiveSession(e);if(!o)throw new Error("No active timer session found");let s=o.stop(new Date,r,!r);return this.timerRepository.update(s)}};var Xe=class{constructor(e){this.timerRepository=e}async execute(e,r=new Date){let o=await this.timerRepository.findActiveSession(e);if(!o)throw new Error("No active timer session found");let s=o.pause(r);return this.timerRepository.update(s)}};var Ye=class{constructor(e){this.timerRepository=e}async execute(e,r,o=new Date){let s=await this.timerRepository.findActiveSession(e);if(!s)throw new Error("No active timer session found");let n=s.resume(r,o);return this.timerRepository.update(n)}};var qe=class{constructor(e){this.timerRepository=e}async execute(e,r,o="WORK",s="TASK_SWITCH"){let n=await this.timerRepository.findActiveSession(e);if(!n)throw new Error("No active timer session found");let a=n.split(new Date,!0,s);await this.timerRepository.update(a);let i=R.create({userId:e,taskId:r,startedAt:new Date,type:o,parentSessionId:a.id}),p=await this.timerRepository.create(i);return{oldSession:a,newSession:p}}};var I=class t extends m{constructor(e){super({...e,tasksCreated:e.tasksCreated??0,tasksCompleted:e.tasksCompleted??0,subtasksCompleted:e.subtasksCompleted??0,minutesWorked:e.minutesWorked??0,pomodorosCompleted:e.pomodorosCompleted??0,shortBreaksCompleted:e.shortBreaksCompleted??0,longBreaksCompleted:e.longBreaksCompleted??0,breakMinutes:e.breakMinutes??0,createdAt:e.createdAt??new Date})}static create(e){return new t({...e,tasksCreated:0,tasksCompleted:0,subtasksCompleted:0,minutesWorked:0,pomodorosCompleted:0,shortBreaksCompleted:0,longBreaksCompleted:0,breakMinutes:0})}incrementTasksCreated(){return this.clone({tasksCreated:this.props.tasksCreated+1})}incrementTasksCompleted(){return this.clone({tasksCompleted:this.props.tasksCompleted+1})}decrementTasksCompleted(){return this.clone({tasksCompleted:Math.max(0,this.props.tasksCompleted-1)})}incrementSubtasksCompleted(){return this.clone({subtasksCompleted:this.props.subtasksCompleted+1})}decrementSubtasksCompleted(){return this.clone({subtasksCompleted:Math.max(0,this.props.subtasksCompleted-1)})}addMinutesWorked(e){return this.clone({minutesWorked:this.props.minutesWorked+e})}incrementPomodoros(){return this.clone({pomodorosCompleted:this.props.pomodorosCompleted+1})}updateFocusScore(e){return this.clone({focusScore:Math.max(0,Math.min(1,e))})}incrementShortBreaks(){return this.clone({shortBreaksCompleted:this.props.shortBreaksCompleted+1})}incrementLongBreaks(){return this.clone({longBreaksCompleted:this.props.longBreaksCompleted+1})}addBreakMinutes(e){return this.clone({breakMinutes:this.props.breakMinutes+e})}};var Je=class{constructor(e){this.analyticsRepository=e}async execute(e,r=new Date){let o=await this.analyticsRepository.findByDate(e,r);return o||(o=I.create({userId:e,date:r})),o}};var Ze=class{constructor(e){this.analyticsRepository=e}async execute(e){let r=new Date(e.date);r.setHours(0,0,0,0);let o=await this.analyticsRepository.findByDate(e.userId,r);if(o||(o=I.create({userId:e.userId,date:r})),e.tasksCreated)for(let s=0;s<e.tasksCreated;s++)o=o.incrementTasksCreated();if(e.tasksCompleted)for(let s=0;s<Math.abs(e.tasksCompleted);s++)e.tasksCompleted>0?o=o.incrementTasksCompleted():o=o.decrementTasksCompleted();if(e.subtasksCompleted)for(let s=0;s<Math.abs(e.subtasksCompleted);s++)e.subtasksCompleted>0?o=o.incrementSubtasksCompleted():o=o.decrementSubtasksCompleted();if(e.minutesWorked&&(o=o.addMinutesWorked(e.minutesWorked)),e.pomodorosCompleted)for(let s=0;s<e.pomodorosCompleted;s++)o=o.incrementPomodoros();if(e.shortBreaksCompleted)for(let s=0;s<e.shortBreaksCompleted;s++)o=o.incrementShortBreaks();if(e.longBreaksCompleted)for(let s=0;s<e.longBreaksCompleted;s++)o=o.incrementLongBreaks();return e.breakMinutes&&(o=o.addBreakMinutes(e.breakMinutes)),e.focusScore!==void 0&&(o=o.updateFocusScore(e.focusScore)),await this.analyticsRepository.save(o),o}};var Qe=class{execute(e){let{totalWorkSeconds:r,totalPauseSeconds:o,pauseCount:s}=e;if(r<=0)return 0;let n=r+o,a=r/n,i=Math.min(s*.02,.2),p=a-i;return p=Math.max(0,Math.min(1,p)),p}};var et=class t extends m{constructor(e){super({...e,peakHours:e.peakHours??{},peakDays:e.peakDays??{},avgTaskDuration:e.avgTaskDuration??30,completionRate:e.completionRate??.7,categoryPreferences:e.categoryPreferences??{},updatedAt:e.updatedAt??new Date})}static create(e){return new t({userId:e,peakHours:{},peakDays:{},avgTaskDuration:30,completionRate:.7,categoryPreferences:{}})}updatePeakHour(e,r){if(e<0||e>23)throw new Error("Hour must be between 0 and 23");if(r<0||r>1)throw new Error("Score must be between 0 and 1");let s=(this.props.peakHours[e]??.5)*.7+r*.3;return this.clone({peakHours:{...this.props.peakHours,[e]:s},updatedAt:new Date})}updatePeakDay(e,r){if(e<0||e>6)throw new Error("Day of week must be between 0 and 6");if(r<0||r>1)throw new Error("Score must be between 0 and 1");let s=(this.props.peakDays[e]??.5)*.7+r*.3;return this.clone({peakDays:{...this.props.peakDays,[e]:s},updatedAt:new Date})}recalculateAvgDuration(e){if(e.length===0)return this;let r=e.reduce((s,n)=>s+n,0)/e.length,o=this.props.avgTaskDuration*.6+r*.4;return this.clone({avgTaskDuration:Math.round(o),updatedAt:new Date})}updateCompletionRate(e,r){if(r===0)return this;if(e>r)throw new Error("Completed tasks cannot exceed total tasks");let o=e/r,s=this.props.completionRate*.8+o*.2;return this.clone({completionRate:Math.max(0,Math.min(1,s)),updatedAt:new Date})}updateCategoryPreference(e,r){if(r<0||r>1)throw new Error("Score must be between 0 and 1");let s=(this.props.categoryPreferences[e]??.5)*.7+r*.3;return this.clone({categoryPreferences:{...this.props.categoryPreferences,[e]:s},updatedAt:new Date})}getTopPeakHours(e=3){return Object.entries(this.props.peakHours).sort(([,r],[,o])=>o-r).slice(0,e).map(([r])=>parseInt(r))}getTopPeakDays(e=3){return Object.entries(this.props.peakDays).sort(([,r],[,o])=>o-r).slice(0,e).map(([r])=>parseInt(r))}getTopCategories(e=5){return Object.entries(this.props.categoryPreferences).sort(([,r],[,o])=>o-r).slice(0,e).map(([r])=>r)}isPeakHour(e){return(this.props.peakHours[e]??0)>.7}isPeakDay(e){return(this.props.peakDays[e]??0)>.7}};var Q=class t extends m{constructor(e){if(super({...e,strengths:e.strengths??[],weaknesses:e.weaknesses??[],recommendations:e.recommendations??[],patterns:e.patterns??[],productivityScore:Math.min(100,Math.max(0,e.productivityScore??0)),metricsSnapshot:e.metricsSnapshot??{},generatedAt:e.generatedAt??new Date,aiModel:e.aiModel??"gemini-2.0-flash-exp"}),e.productivityScore<0||e.productivityScore>100)throw new Error("Productivity score must be between 0 and 100");if(!e.summary||e.summary.trim().length===0)throw new Error("Summary cannot be empty")}static create(e){return new t({...e,generatedAt:new Date,aiModel:"gemini-2.0-flash-exp"})}getScopeLabel(){switch(this.props.scope){case"TASK_COMPLETION":return"Task Completion Report";case"PROJECT_SUMMARY":return"Project Summary";case"PERSONAL_ANALYSIS":return"Personal Analysis";case"WEEKLY_SCHEDULED":return"Weekly Report";case"MONTHLY_SCHEDULED":return"Monthly Report";default:return"Report"}}getScoreColor(){return this.props.productivityScore>=80?"green":this.props.productivityScore>=60?"yellow":"red"}isGoodScore(){return this.props.productivityScore>=70}getMetricsSummary(){let e=this.props.metricsSnapshot,r=[];if(e.tasksCompleted!==void 0&&r.push(`${e.tasksCompleted} tasks completed`),e.minutesWorked!==void 0){let o=Math.floor(e.minutesWorked/60),s=e.minutesWorked%60;o>0?r.push(`${o}h ${s}m worked`):r.push(`${s}m worked`)}return e.pomodorosCompleted!==void 0&&e.pomodorosCompleted>0&&r.push(`${e.pomodorosCompleted} pomodoros`),r.join(", ")||"No metrics available"}hasRecommendations(){return this.props.recommendations.length>0}getTopRecommendations(e=3){return this.props.recommendations.slice(0,e)}};var tt=class{constructor(e){this.aiProfileRepository=e}async execute(e){let{session:r}=e;if(!r.props.wasCompleted)throw new Error("Can only learn from completed sessions");if(r.props.type!=="WORK"&&r.props.type!=="CONTINUOUS")throw new Error("Can only learn from WORK or CONTINUOUS sessions");let o=await this.aiProfileRepository.findOrCreate(r.props.userId),s=r.props.startedAt,n=s.getHours(),a=s.getDay(),i=this.calculateProductivityScore(r),p=o.updatePeakHour(n,i).updatePeakDay(a,i);return r.props.taskId&&r.props.duration&&(p=p.recalculateAvgDuration([r.props.duration])),await this.aiProfileRepository.update(p)}calculateProductivityScore(e){let r=e.props.duration??0,o=e.props.pauseCount??0,s=e.props.totalPauseTime??0,n=e.props.wasCompleted,a=.5;n&&(a+=.2),r>=25&&r<=50?a+=.2:(r>=10&&r<25||r>50)&&(a+=.1);let i=Math.min(o*.05,.3);if(a-=i,r>0){let p=r*60+s,f=r*60/p;f>=.9?a+=.2:f>=.8?a+=.15:f>=.7?a+=.1:f<.5&&(a-=.2)}return Math.max(0,Math.min(1,a))}};var jo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],rt=class{constructor(e){this.aiProfileRepository=e}async execute(e){let{userId:r,topN:o=5}=e,s=await this.aiProfileRepository.findByUserId(r);if(!s)return{peakHours:[],peakDays:[],recommendation:"Start tracking your work sessions to get personalized productivity insights!"};let n=this.getTopPeakHours(s,o),a=this.getTopPeakDays(s,3),i=this.generateRecommendation(s,n,a);return{peakHours:n,peakDays:a,recommendation:i}}getTopPeakHours(e,r){let o=e.props.peakHours;return Object.entries(o).map(([s,n])=>({hour:parseInt(s),score:n,label:this.formatHour(parseInt(s))})).sort((s,n)=>n.score-s.score).slice(0,r)}getTopPeakDays(e,r){let o=e.props.peakDays;return Object.entries(o).map(([s,n])=>{let a=parseInt(s);return{day:a,score:n,label:jo[a]||"Unknown"}}).sort((s,n)=>n.score-s.score).slice(0,r)}formatHour(e){let r=e>=12?"PM":"AM";return`${e===0?12:e>12?e-12:e}:00 ${r}`}generateRecommendation(e,r,o){if(r.length===0&&o.length===0)return"Keep tracking your work sessions to discover your peak productivity times!";let s=[];if(r.length>0){let i=r[0];if(i&&i.score>.7){let p=r.slice(0,3).map(f=>f.label).join(", ");s.push(`Your peak productivity hours are ${p}.`)}else i&&i.score>.5&&s.push(`You work well during ${i.label}.`)}if(o.length>0){let i=o[0];if(i&&i.score>.7){let p=o.slice(0,2).map(f=>f.label).join(" and ");s.push(`You're most productive on ${p}.`)}}let n=e.props.avgTaskDuration;n>0&&s.push(`Your average focused work session is ${n} minutes.`);let a=e.props.completionRate;return a>=.8?s.push(`You have an excellent task completion rate of ${Math.round(a*100)}%!`):a<.5&&s.push(`Try breaking tasks into smaller chunks to improve your ${Math.round(a*100)}% completion rate.`),s.join(" ")||"Keep working to build your productivity profile!"}};var ot=class{constructor(e){this.aiProfileRepository=e}async execute(e){let{userId:r,taskTitle:o,taskDescription:s,category:n,priority:a}=e,i=await this.aiProfileRepository.findByUserId(r);if(!i)return{estimatedMinutes:30,confidence:"LOW",reasoning:"Using default estimate of 30 minutes. Complete more tasks to get personalized predictions!"};let p=i.props.avgTaskDuration,f="MEDIUM",y=[];if(n&&i.props.categoryPreferences[n]){let pe=i.props.categoryPreferences[n];pe>.7?(p*=.85,y.push(`You're efficient with ${n} tasks (-15%)`),f="HIGH"):pe<.4&&(p*=1.2,y.push(`${n} tasks typically take you longer (+20%)`),f="MEDIUM")}if(a)switch(a){case"URGENT":p*=.9,y.push("Urgent priority tends to increase focus (-10%)");break;case"HIGH":p*=1.1,y.push("High priority suggests complexity (+10%)");break;case"LOW":p*=.85,y.push("Low priority typically means simpler tasks (-15%)");break}let x=`${o||""} ${s||""}`.toLowerCase();this.containsComplexityKeywords(x,["refactor","redesign","architecture","migration"])?(p*=1.5,y.push("Complex task keywords detected (+50%)")):this.containsComplexityKeywords(x,["fix","bug","issue","debug"])?(p*=1.2,y.push("Debugging tasks can be unpredictable (+20%)")):this.containsComplexityKeywords(x,["simple","quick","minor","small"])&&(p*=.75,y.push("Simple task indicators found (-25%)")),p=Math.round(p/5)*5,p=Math.max(10,p);let N=`Based on your average of ${i.props.avgTaskDuration} minutes`;return y.length>0?N+=`. ${y.join(". ")}.`:N+=".",!n&&!a&&!o&&!s&&(f="LOW"),{estimatedMinutes:p,confidence:f,reasoning:N}}containsComplexityKeywords(e,r){return r.some(o=>e.includes(o))}};var st=class{constructor(e,r,o,s,n){this.reportRepository=e;this.analyticsRepository=r;this.timerRepository=o;this.aiProfileRepository=s;this.generateReportData=n}async execute(e){let{userId:r,weekStart:o}=e,s=o||this.getWeekStart(new Date),n=new Date(s);n.setDate(n.getDate()+6);let a=await this.reportRepository.findLatestByScope(r,"WEEKLY_SCHEDULED");if(a&&this.isSameWeek(a.props.generatedAt,s))return{report:a,isNew:!1};let[i,p,f]=await Promise.all([this.analyticsRepository.getRange(r,s,n),this.timerRepository.findByUserIdAndDateRange(r,s,n),this.aiProfileRepository.findByUserId(r)]),y={tasksCreated:i.reduce((h,S)=>h+S.props.tasksCreated,0),tasksCompleted:i.reduce((h,S)=>h+S.props.tasksCompleted,0),minutesWorked:i.reduce((h,S)=>h+S.props.minutesWorked,0),pomodorosCompleted:i.reduce((h,S)=>h+S.props.pomodorosCompleted,0),focusScore:i.length>0?i.reduce((h,S)=>h+(S.props.focusScore??0),0)/i.length:0,sessionsCount:p.length},x=await this.generateReportData({userId:r,scope:"WEEKLY_SCHEDULED",metricsSnapshot:y,sessions:p.map(h=>h.props),profile:f?.props}),N=Q.create({userId:r,scope:"WEEKLY_SCHEDULED",summary:x.summary,strengths:x.strengths,weaknesses:x.weaknesses,recommendations:x.recommendations,patterns:x.patterns,productivityScore:x.productivityScore,metricsSnapshot:y});return{report:await this.reportRepository.save(N),isNew:!0}}getWeekStart(e){let r=new Date(e),o=r.getDay(),s=r.getDate()-o+(o===0?-6:1);return new Date(r.setDate(s))}isSameWeek(e,r){let o=this.getWeekStart(e),s=this.getWeekStart(r);return o.getTime()===s.getTime()}};var ie=class{async suggestTaskDetails(e){await new Promise(n=>setTimeout(n,1e3));let r=e.toLowerCase(),o="MEDIUM";r.includes("urgente")||r.includes("asap")?o="URGENT":r.includes("importante")&&(o="HIGH");let s;if(r.includes("ma\xF1ana")){let n=new Date;n.setDate(n.getDate()+1),s=n}else r.includes("hoy")&&(s=new Date);return{title:e,description:"Generated by Ordo AI based on your input.",priority:o,dueDate:s}}async chat(e,r){return await new Promise(o=>setTimeout(o,1e3)),`I am Ordo AI. You said: "${e}". I am currently in development mode.`}},Go=new ie;var nt=class t extends m{constructor(e){super({...e,frequency:e.frequency??"DAILY",targetDaysOfWeek:e.targetDaysOfWeek??[0,1,2,3,4,5,6],targetCount:e.targetCount??1,color:e.color??"#10B981",currentStreak:e.currentStreak??0,longestStreak:e.longestStreak??0,totalCompletions:e.totalCompletions??0,isActive:e.isActive??!0,isPaused:e.isPaused??!1,completions:e.completions??[],createdAt:e.createdAt??new Date,updatedAt:e.updatedAt??new Date})}static create(e){return new t({...e,currentStreak:0,longestStreak:0,totalCompletions:0,isActive:!0,isPaused:!1})}isScheduledForDay(e){return this.props.frequency==="DAILY"?!0:this.props.frequency==="SPECIFIC_DAYS"?this.props.targetDaysOfWeek.includes(e):!0}complete(e=!0){let r=this.props.totalCompletions+1,o=e?this.props.currentStreak+1:1,s=Math.max(this.props.longestStreak,o);return this.clone({totalCompletions:r,currentStreak:o,longestStreak:s,updatedAt:new Date})}resetStreak(){return this.clone({currentStreak:0,updatedAt:new Date})}pause(){return this.clone({isPaused:!0,pausedAt:new Date,updatedAt:new Date})}resume(){return this.clone({isPaused:!1,pausedAt:void 0,updatedAt:new Date})}archive(){return this.clone({isActive:!1,archivedAt:new Date,updatedAt:new Date})}update(e){return this.clone({...e,updatedAt:new Date})}};0&&(module.exports={AIProfile,AcceptInvitationUseCase,AddMemberToWorkspaceUseCase,ArchiveProjectUseCase,ArchiveWorkspaceUseCase,AssignTagToTaskUseCase,COMMENT_LIMITS,CalculateFocusScoreUseCase,ChangeUserName,CompleteTaskUseCase,CreateAuditLogUseCase,CreateProjectUseCase,CreateTagUseCase,CreateTaskUseCase,CreateWorkflowUseCase,CreateWorkspaceUseCase,DEFAULT_POMODORO_SETTINGS,DailyMetrics,DeleteProjectUseCase,DeleteWorkflowUseCase,Email,Entity,FILE_LIMITS,GenerateWeeklyReportUseCase,GetDailyMetricsUseCase,GetOptimalScheduleUseCase,GetWorkspaceAuditLogsUseCase,GetWorkspaceSettingsUseCase,Habit,HashPassword,Id,InviteMemberUseCase,LearnFromSessionUseCase,ListWorkflowsUseCase,MEMBER_ROLES,MockAIService,PAGINATION_LIMITS,PRIORITY_VALUES,PROJECT_COLORS,PROJECT_LIMITS,PROJECT_STATUS,PROJECT_STATUS_VALUES,PauseTimerUseCase,PersonName,PredictTaskDurationUseCase,ProductivityReport,Project,RegisterUser,RemoveMemberFromWorkspaceUseCase,RemoveTagFromTaskUseCase,RequiredString,ResumeTimerUseCase,SoftDeleteWorkspaceUseCase,StartTimerUseCase,StopTimerUseCase,SwitchTaskUseCase,TAG_COLORS,TAG_LIMITS,TASK_LIMITS,TASK_PRIORITIES,TASK_STATUS,TASK_STATUS_VALUES,TIMER_LIMITS,TIMER_MODES,TIMER_MODE_VALUES,Tag,Task,TimeSession,USER_LIMITS,UpdateDailyMetricsUseCase,UpdateProjectUseCase,UpdateTagUseCase,UpdateWorkflowUseCase,UpdateWorkspaceSettingsUseCase,User,UserByEmail,UserLogin,WORKSPACE_COLORS,WORKSPACE_LIMITS,WORKSPACE_TYPES,Workflow,Workspace,WorkspaceAuditLog,WorkspaceInvitation,WorkspaceMember,WorkspaceSettings,acceptInvitationSchema,addAlpha,addDays,addHours,addMinutes,aiService,archiveProjectSchema,assignTagsSchema,bulkUpdateTasksSchema,calculateAverageCompletionTime,calculateAverageTime,calculateBurndownRate,calculateCompletionRate,calculateEfficiency,calculateEstimatedCompletion,calculateFocusScore,calculatePercentile,calculateProductivityScore,calculateProgress,calculateProjectHealth,calculateStreak,calculateTimeUtilization,calculateTotalTimeWorked,calculateVelocity,calculateWeightedAverage,camelToTitle,capitalize,capitalizeWords,categorizeTasksByAvailability,changePasswordSchema,commentBaseSchema,commentFilterSchema,countWords,createCommentSchema,createProjectSchema,createTagSchema,createTaskSchema,createWorkspaceSchema,darkenColor,duplicateProjectSchema,endOfDay,endOfWeek,formatDate,formatDateShort,formatDuration,formatDurationFromSeconds,formatFileSize,formatNumber,formatRelativeTime,formatScheduledDateTime,formatTimeOfDay,formatTimerDisplay,formatTimerDisplayExtended,generateId,generatePalette,generateRandomString,generateSlug,getColorWithOpacity,getContrastColor,getCurrentTime,getDaysDiff,getInitials,getPriorityColor,getPriorityConfig,getPriorityLabel,getTaskStatusColor,getTaskStatusConfig,getTaskStatusLabel,getTimerModeColor,getTimerModeConfig,getTimerModeDefaultDuration,getTimerModeLabel,getWorkableTasks,hexToRgb,hexToRgba,highlightSearchTerms,hoursToMinutes,inviteMemberSchema,isAfter,isAllowedFileType,isAlphanumeric,isBefore,isDarkColor,isDueToday,isFuture,isImageFile,isLightColor,isOverdue,isPast,isScheduledForToday,isTaskAvailable,isTaskCompleted,isTaskInProgress,isToday,isValidEmail,isValidUrl,isWorkingHours,lightenColor,loginUserSchema,minutesToHours,minutesToSeconds,mixColors,normalizeWhitespace,parseDuration,pluralize,projectBaseSchema,projectFilterSchema,randomColor,registerUserSchema,reorderTasksSchema,resetPasswordRequestSchema,resetPasswordSchema,rgbToHex,sanitizeHtml,secondsToMinutes,shouldTakeLongBreak,snakeToTitle,startOfDay,startOfToday,startOfWeek,stripHtmlTags,tagBaseSchema,tagFilterSchema,taskBaseSchema,taskDatesSchema,taskFilterSchema,transferOwnershipSchema,truncate,updateCommentSchema,updateMemberRoleSchema,updateProjectSchema,updateTagSchema,updateTaskSchema,updateUserProfileSchema,updateWorkspaceSchema,userPreferencesSchema,usernameValidationSchema,workspaceBaseSchema,workspaceFilterSchema,workspaceSettingsSchema});
